<!doctype html><html lang="en">
<!-- Mirrored from dart.dev/libraries/async/async-await by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Dec 2024 22:14:24 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><script>!function(e,t,a,n){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var g=t.getElementsByTagName(a)[0],m=t.createElement(a);m.async=!0,m.src="../../../www.googletagmanager.com/gtm4a44.js?id=GTM-5VSZM5J",g.parentNode.insertBefore(m,g)}(window,document,"script","dataLayer")</script><meta name="description" content="Learn about and practice writing asynchronous code in DartPad!"><title>Asynchronous programming: futures, async, await | Dart</title><link rel="icon" sizes="64x64" href="../../assets/img/logo/dart-64.png" eleventy:ignore><link href="../../assets/img/touch-icon-iphone.png" rel="apple-touch-icon" eleventy:ignore><link href="../../assets/img/touch-icon-ipad.png" rel="apple-touch-icon" sizes="152x152" eleventy:ignore><link href="../../assets/img/touch-icon-iphone-retina.png" rel="apple-touch-icon" sizes="180x180" eleventy:ignore><link href="../../assets/img/touch-icon-ipad-retina.png" rel="apple-touch-icon" sizes="167x167" eleventy:ignore><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@dart_lang"><meta name="twitter:title" content="Asynchronous programming: futures, async, await"><meta name="twitter:description" content="Learn about and practice writing asynchronous code in DartPad!"><meta property="og:title" content="Asynchronous programming: futures, async, await"><meta property="og:description" content="Learn about and practice writing asynchronous code in DartPad!"><meta property="og:url" content="/libraries/async/async-await/"><meta property="og:image" content="/assets/img/logo/dart-logo-for-shares.png?2" eleventy:ignore><link rel="preconnect" href="https://fonts.googleapis.com/"><link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin><link href="https://fonts.googleapis.com/css2?family=Google+Sans:wght@400;500;700&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Google+Sans+Display:wght@400&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Google+Sans+Mono:wght@400;500;700&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Google+Sans+Text:wght@400;500;700&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" rel="stylesheet"><link rel="stylesheet" href="../../assets/css/main.css"><script src="../../../cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js" integrity="sha512-3gJwYpMe3QewGELv8k/BX9vcqhryRdzRMxVfq6ngyWXwo03GFEzjsUm8Q7RZcHPHksttq7/GFoxjCVUjkjvPdw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="../../../cdnjs.cloudflare.com/ajax/libs/bootstrap/4.6.2/js/bootstrap.min.js" integrity="sha384-+sLIOodYLS7CIrQpBjl+C7nPvqq+FbNUBDunl/OZv93DB7Ln/533i8e/mZXLi/P+" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="../../../cdnjs.cloudflare.com/ajax/libs/js-cookie/3.0.5/js.cookie.min.js" integrity="sha512-nlp9/l96/EpjYBx7EP7pGASVXNe80hGhYAUrjeXnu/fyF5Py0/RXav4BBNs7n5Hx1WFhOEOWSAVjGeC3oKxDVQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="../../assets/js/os-tabs.js"></script><script src="../../assets/js/utilities.js"></script><script src="../../assets/js/main.js"></script><script defer="defer" src="../../assets/js/inject_dartpad.js"></script><script>!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src="../../../www.google-analytics.com/analytics.js",s.parentNode.insertBefore(o,s)}(window,document,"script",0,"ga"),ga("create","UA-26406144-4","auto"),ga("send","pageview")</script></head><body class="default.html show_banner"><a id="skip" href="#site-content-title">Skip to main content</a><section id="cookie-notice"><div class="container"><p>dart.dev uses cookies from Google to deliver and enhance the quality of its services and to analyze traffic. <a href="https://policies.google.com/technologies/cookies" target="_blank" rel="noopener">Learn more</a>.</p><button id="cookie-consent" class="btn btn-primary">OK, got it</button></div></section><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5VSZM5J" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><header id="page-header" class="site-header"><nav id="mainnav" class="site-header"><div id="menu-toggle"><i class="material-symbols">menu</i></div><a href="../../index.html" class="brand" title="Dart"><img src="../../assets/img/logo/logo-white-text.svg" alt="Dart"></a><ul class="navbar"><li><a href="../../overview.html" class="nav-link">Overview</a></li><li class="mainnav__get-started"><a href="../../guides.html" class="nav-link active"><span>Docs</span></a></li><li><a href="../../community.html" class="nav-link">Community</a></li><li><a href="../../index.html#try-dart" class="nav-link">Try Dart</a></li><li><a href="../../get-dart.html" class="nav-link">Get Dart</a></li><li class="searchfield"><form action="https://dart.dev/search" class="site-header__search form-inline" id="cse-search-box"><input type="hidden" name="cx" value="011220921317074318178:_yy-tmb5t_i"> <input type="hidden" name="ie" value="UTF-8"> <input type="hidden" name="hl" value="en"> <input class="site-header__searchfield form-control search-field" type="search" name="q" id="search-main" autocomplete="off" placeholder="Search" aria-label="Search"></form></li></ul></nav></header><div class="banner"><p class="banner__text">Dart 3.6 is here! Read the <a href="https://medium.com/dartlang/announcing-dart-3-6-778dd7a80983" target="_blank">blog post</a> to learn about new features in pub and the language.</p></div><div id="sidenav"><form action="https://dart.dev/search/" class="site-header__search form-inline"><input class="site-header__searchfield form-control search-field" type="search" name="q" id="search-side" autocomplete="off" placeholder="Search" aria-label="Search"></form><div class="site-sidebar"><ul class="navbar-nav"><li class="nav-item"><a href="../../overview.html" class="nav-link">Overview</a></li><li class="nav-item"><a href="../../community.html" class="nav-link">Community</a></li><li class="nav-item"><a href="https://dartpad.dev/" class="nav-link">Try Dart</a></li><li class="nav-item"><a href="../../get-dart.html" class="nav-link">Get Dart</a></li><li class="nav-item"><a href="../../guides.html" class="nav-link">Docs</a></li><li aria-hidden="true"><div class="sidebar-primary-divider"></div></li></ul><ul class="nav flex-column"><li class="nav-item"><a class="nav-link collapsed collapsible" data-toggle="collapse" href="#sidenav-1" role="button" aria-expanded="false" aria-controls="sidenav-1">Language</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-1"><li class="nav-item"><a class="nav-link" href="../../language.html">Introduction</a></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-1-2" href="#sidenav-1-2" role="button" aria-expanded="false" aria-controls="sidenav-1-2">Syntax basics</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-1-2"><li class="nav-item"><a class="nav-link" href="../../language/variables.html">Variables</a></li><li class="nav-item"><a class="nav-link" href="../../language/operators.html">Operators</a></li><li class="nav-item"><a class="nav-link" href="../../language/comments.html">Comments</a></li><li class="nav-item"><a class="nav-link" href="../../language/metadata.html">Metadata</a></li><li class="nav-item"><a class="nav-link" href="../../language/libraries.html">Libraries & imports</a></li><li class="nav-item"><a class="nav-link" href="../../language/keywords.html">Keywords</a></li></ul></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-1-3" href="#sidenav-1-3" role="button" aria-expanded="false" aria-controls="sidenav-1-3">Types</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-1-3"><li class="nav-item"><a class="nav-link" href="../../language/built-in-types.html">Built-in types</a></li><li class="nav-item"><a class="nav-link" href="../../language/records.html">Records</a></li><li class="nav-item"><a class="nav-link" href="../../language/collections.html">Collections</a></li><li class="nav-item"><a class="nav-link" href="../../language/generics.html">Generics</a></li><li class="nav-item"><a class="nav-link" href="../../language/typedefs.html">Typedefs</a></li><li class="nav-item"><a class="nav-link" href="../../language/type-system.html">Type system</a></li></ul></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-1-4" href="#sidenav-1-4" role="button" aria-expanded="false" aria-controls="sidenav-1-4">Patterns</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-1-4"><li class="nav-item"><a class="nav-link" href="../../language/patterns.html">Overview & usage</a></li><li class="nav-item"><a class="nav-link" href="../../language/pattern-types.html">Pattern types</a></li><li class="nav-item"><a class="nav-link" href="https://codelabs.developers.google.com/codelabs/dart-patterns-records" target="_blank" rel="noopener">Applied tutorial</a></li></ul></li><li class="nav-item"><a class="nav-link" href="../../language/functions.html">Functions</a></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-1-6" href="#sidenav-1-6" role="button" aria-expanded="false" aria-controls="sidenav-1-6">Control flow</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-1-6"><li class="nav-item"><a class="nav-link" href="../../language/loops.html">Loops</a></li><li class="nav-item"><a class="nav-link" href="../../language/branches.html">Branches</a></li><li class="nav-item"><a class="nav-link" href="../../language/error-handling.html">Error handling</a></li></ul></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-1-7" href="#sidenav-1-7" role="button" aria-expanded="false" aria-controls="sidenav-1-7">Classes & objects</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-1-7"><li class="nav-item"><a class="nav-link" href="../../language/classes.html">Classes</a></li><li class="nav-item"><a class="nav-link" href="../../language/constructors.html">Constructors</a></li><li class="nav-item"><a class="nav-link" href="../../language/methods.html">Methods</a></li><li class="nav-item"><a class="nav-link" href="../../language/extend.html">Extend a class</a></li><li class="nav-item"><a class="nav-link" href="../../language/mixins.html">Mixins</a></li><li class="nav-item"><a class="nav-link" href="../../language/enums.html">Enums</a></li><li class="nav-item"><a class="nav-link" href="../../language/extension-methods.html">Extension methods</a></li><li class="nav-item"><a class="nav-link" href="../../language/extension-types.html">Extension types</a></li><li class="nav-item"><a class="nav-link" href="../../language/callable-objects.html">Callable objects</a></li></ul></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-1-8" href="#sidenav-1-8" role="button" aria-expanded="false" aria-controls="sidenav-1-8">Class modifiers</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-1-8"><li class="nav-item"><a class="nav-link" href="../../language/class-modifiers.html">Overview & usage</a></li><li class="nav-item"><a class="nav-link" href="../../language/class-modifiers-for-apis.html">Class modifiers for API maintainers</a></li><li class="nav-item"><a class="nav-link" href="../../language/modifier-reference.html">Reference</a></li></ul></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-1-9" href="#sidenav-1-9" role="button" aria-expanded="false" aria-controls="sidenav-1-9">Concurrency</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-1-9"><li class="nav-item"><a class="nav-link" href="../../language/concurrency.html">Overview</a></li><li class="nav-item"><a class="nav-link" href="../../language/async.html">Asynchronous support</a></li><li class="nav-item"><a class="nav-link" href="../../language/isolates.html">Isolates</a></li></ul></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-1-10" href="#sidenav-1-10" role="button" aria-expanded="false" aria-controls="sidenav-1-10">Null safety</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-1-10"><li class="nav-item"><a class="nav-link" href="../../null-safety.html">Sound null safety</a></li><li class="nav-item"><a class="nav-link" href="../../null-safety/migration-guide.html">Migrating to null safety</a></li><li class="nav-item"><a class="nav-link" href="../../null-safety/understanding-null-safety.html">Understanding null safety</a></li><li class="nav-item"><a class="nav-link" href="../../null-safety/unsound-null-safety.html">Unsound null safety</a></li><li class="nav-item"><a class="nav-link" href="../../null-safety/faq.html">FAQ</a></li></ul></li></ul></li><li class="nav-item"><a class="nav-link active collapsible" data-toggle="collapse" href="#sidenav-2" role="button" aria-expanded="true" aria-controls="sidenav-2">Core libraries</a><ul class="nav flex-column flex-nowrap collapse show" id="sidenav-2"><li class="nav-item"><a class="nav-link" href="../../libraries.html">Overview</a></li><li class="nav-item"><a class="nav-link" href="../dart-core.html">dart:core</a></li><li class="nav-item"><a class="nav-link" href="../dart-async.html">dart:async</a></li><li class="nav-item"><a class="nav-link" href="../dart-math.html">dart:math</a></li><li class="nav-item"><a class="nav-link" href="../dart-convert.html">dart:convert</a></li><li class="nav-item"><a class="nav-link" href="../dart-io.html">dart:io</a></li><li class="nav-item"><a class="nav-link" href="../dart-html.html">dart:html</a></li><div class="dropdown-divider"></div><li class="nav-item"><a class="nav-link" href="../collections/iterables.html">Iterable collections</a></li><li class="nav-item"><a class="nav-link active collapsible" data-toggle="collapse" data-target="#sidenav-2-10" href="#sidenav-2-10" role="button" aria-expanded="true" aria-controls="sidenav-2-10">Asynchronous programming</a><ul class="nav flex-column flex-nowrap collapse show" id="sidenav-2-10"><li class="nav-item"><a class="nav-link active" href="async-await.html">Tutorial</a></li><li class="nav-item"><a class="nav-link" href="futures-error-handling.html">Futures and error handling</a></li><li class="nav-item"><a class="nav-link" href="using-streams.html">Using streams</a></li><li class="nav-item"><a class="nav-link" href="creating-streams.html">Creating streams</a></li></ul></li></ul></li><li class="nav-item"><a class="nav-link collapsed collapsible" data-toggle="collapse" href="#sidenav-3" role="button" aria-expanded="false" aria-controls="sidenav-3">Effective Dart</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-3"><li class="nav-item"><a class="nav-link" href="../../effective-dart.html">Overview</a></li><li class="nav-item"><a class="nav-link" href="../../effective-dart/style.html">Style</a></li><li class="nav-item"><a class="nav-link" href="../../effective-dart/documentation.html">Documentation</a></li><li class="nav-item"><a class="nav-link" href="../../effective-dart/usage.html">Usage</a></li><li class="nav-item"><a class="nav-link" href="../../effective-dart/design.html">Design</a></li></ul></li><li class="nav-item"><a class="nav-link collapsed collapsible" data-toggle="collapse" href="#sidenav-4" role="button" aria-expanded="false" aria-controls="sidenav-4">Packages</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-4"><li class="nav-item"><a class="nav-link" href="../../tools/pub/packages.html">How to use packages</a></li><li class="nav-item"><a class="nav-link" href="../../resources/useful-packages.html">Commonly used packages</a></li><li class="nav-item"><a class="nav-link" href="../../tools/pub/create-packages.html">Creating packages</a></li><li class="nav-item"><a class="nav-link" href="../../tools/pub/publishing.html">Publishing packages</a></li><li class="nav-item"><a class="nav-link" href="../../tools/pub/writing-package-pages.html">Writing package pages</a></li><li class="nav-item"><a class="nav-link" href="../../tools/pub/workspaces.html">Workspaces (monorepo support)</a></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-4-7" href="#sidenav-4-7" role="button" aria-expanded="false" aria-controls="sidenav-4-7">Package reference</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-4-7"><li class="nav-item"><a class="nav-link" href="../../tools/pub/dependencies.html">Dependencies</a></li><li class="nav-item"><a class="nav-link" href="../../tools/pub/glossary.html">Glossary</a></li><li class="nav-item"><a class="nav-link" href="../../tools/pub/package-layout.html">Package layout conventions</a></li><li class="nav-item"><a class="nav-link" href="../../tools/pub/environment-variables.html">Pub environment variables</a></li><li class="nav-item"><a class="nav-link" href="../../tools/pub/pubspec.html">Pubspec file</a></li><li class="nav-item"><a class="nav-link" href="../../tools/pub/troubleshoot.html">Troubleshooting pub</a></li><li class="nav-item"><a class="nav-link" href="../../tools/pub/verified-publishers.html">Verified publishers</a></li><li class="nav-item"><a class="nav-link" href="../../tools/pub/security-advisories.html">Security advisories</a></li><li class="nav-item"><a class="nav-link" href="../../tools/pub/versioning.html">Versioning</a></li><li class="nav-item"><a class="nav-link" href="../../tools/pub/custom-package-repositories.html">Custom package repositories</a></li></ul></li><li class="nav-item"><a class="nav-link" href="../../tools/pub/private-files.html">What not to commit</a></li></ul></li><li class="nav-item"><a class="nav-link collapsed collapsible" data-toggle="collapse" href="#sidenav-5" role="button" aria-expanded="false" aria-controls="sidenav-5">Development</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-5"><li class="nav-item"><a class="nav-link" href="../../guides/json.html">JSON</a></li><li class="nav-item"><a class="nav-link" href="../../resources/language/number-representation.html">Number representation</a></li><li class="nav-item"><a class="nav-link" href="../../resources/google-apis.html">Google APIs</a></li><li class="nav-item"><a class="nav-link" href="../../multiplatform-apps.html">Multi-platform apps</a></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-5-5" href="#sidenav-5-5" role="button" aria-expanded="false" aria-controls="sidenav-5-5">Command-line & server apps</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-5-5"><li class="nav-item"><a class="nav-link" href="../../server.html">Overview</a></li><li class="nav-item"><a class="nav-link" href="../../tutorials/server/get-started.html">Get started</a></li><li class="nav-item"><a class="nav-link" href="../../tutorials/server/cmdline.html">Write command-line apps</a></li><li class="nav-item"><a class="nav-link" href="../../tutorials/server/fetch-data.html">Fetch data from the internet</a></li><li class="nav-item"><a class="nav-link" href="../../tutorials/server/httpserver.html">Write HTTP servers</a></li><li class="nav-item"><a class="nav-link" href="../../server/libraries.html">Libraries & packages</a></li><li class="nav-item"><a class="nav-link" href="../../server/google-cloud.html">Google Cloud</a></li></ul></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-5-6" href="#sidenav-5-6" role="button" aria-expanded="false" aria-controls="sidenav-5-6">Web apps</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-5-6"><li class="nav-item"><a class="nav-link" href="../../web.html">Overview</a></li><li class="nav-item"><a class="nav-link" href="../../web/get-started.html">Get started</a></li><li class="nav-item"><a class="nav-link" href="../../web/deployment.html">Deployment</a></li><li class="nav-item"><a class="nav-link" href="../../web/libraries.html">Libraries & packages</a></li><li class="nav-item"><a class="nav-link" href="../../web/wasm.html">Wasm compilation</a></li></ul></li><li class="nav-item"><a class="nav-link" href="../../guides/environment-declarations.html">Environment declarations</a></li></ul></li><li class="nav-item"><a class="nav-link collapsed collapsible" data-toggle="collapse" href="#sidenav-6" role="button" aria-expanded="false" aria-controls="sidenav-6">Interoperability</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-6"><li class="nav-item"><a class="nav-link" href="../../interop/c-interop.html">C interop</a></li><li class="nav-item"><a class="nav-link" href="../../interop/objective-c-interop.html">Objective-C & Swift interop</a></li><li class="nav-item"><a class="nav-link" href="../../interop/java-interop.html">Java & Kotlin interop</a></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-6-4" href="#sidenav-6-4" role="button" aria-expanded="false" aria-controls="sidenav-6-4">JavaScript interop</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-6-4"><li class="nav-item"><a class="nav-link" href="../../interop/js-interop.html">Overview</a></li><li class="nav-item"><a class="nav-link" href="../../interop/js-interop/usage.html">Usage</a></li><li class="nav-item"><a class="nav-link" href="../../interop/js-interop/js-types.html">JS types</a></li><li class="nav-item"><a class="nav-link" href="../../interop/js-interop/tutorials.html">Tutorials</a></li><li class="nav-item"><a class="nav-link" href="../../interop/js-interop/past-js-interop.html">Past JS interop</a></li><div class="dropdown-divider"></div><li class="nav-item"><a class="nav-link" href="../../interop/js-interop/package-web.html">Web interop</a></li></ul></li></ul></li><li class="nav-item"><a class="nav-link collapsed collapsible" data-toggle="collapse" href="#sidenav-7" role="button" aria-expanded="false" aria-controls="sidenav-7">Tools & techniques</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-7"><li class="nav-item"><a class="nav-link" href="../../tools.html">Overview</a></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-7-2" href="#sidenav-7-2" role="button" aria-expanded="false" aria-controls="sidenav-7-2">Editors & debuggers</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-7-2"><li class="nav-item"><a class="nav-link" href="../../tools/jetbrains-plugin.html">IntelliJ & Android Studio</a></li><li class="nav-item"><a class="nav-link" href="../../tools/vs-code.html">VS Code</a></li><li class="nav-item"><a class="nav-link" href="../../tools/dart-devtools.html">Dart DevTools</a></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-7-2-4" href="#sidenav-7-2-4" role="button" aria-expanded="false" aria-controls="sidenav-7-2-4">DartPad</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-7-2-4"><li class="nav-item"><a class="nav-link" href="../../tools/dartpad.html">Overview</a></li><li class="nav-item"><a class="nav-link" href="../../tools/dartpad/troubleshoot.html">Troubleshooting DartPad</a></li></ul></li></ul></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-7-3" href="#sidenav-7-3" role="button" aria-expanded="false" aria-controls="sidenav-7-3">Command-line tools</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-7-3"><li class="nav-item"><a class="nav-link collapsible" data-toggle="collapse" data-target="#sidenav-7-3-1" href="#sidenav-7-3-1" role="button" aria-expanded="true" aria-controls="sidenav-7-3-1">Dart SDK</a><ul class="nav flex-column flex-nowrap collapse show" id="sidenav-7-3-1"><li class="nav-item"><a class="nav-link" href="../../tools/sdk.html">Overview</a></li><li class="nav-item"><a class="nav-link" href="../../tools/dart-tool.html">dart</a></li><li class="nav-item"><a class="nav-link" href="../../tools/dart-analyze.html">dart analyze</a></li><li class="nav-item"><a class="nav-link" href="../../tools/dart-compile.html">dart compile</a></li><li class="nav-item"><a class="nav-link" href="../../tools/dart-create.html">dart create</a></li><li class="nav-item"><a class="nav-link" href="../../tools/dart-doc.html">dart doc</a></li><li class="nav-item"><a class="nav-link" href="../../tools/dart-fix.html">dart fix</a></li><li class="nav-item"><a class="nav-link" href="../../tools/dart-format.html">dart format</a></li><li class="nav-item"><a class="nav-link" href="../../tools/dart-info.html">dart info</a></li><li class="nav-item"><a class="nav-link" href="../../tools/pub/cmd.html">dart pub</a></li><li class="nav-item"><a class="nav-link" href="../../tools/dart-run.html">dart run</a></li><li class="nav-item"><a class="nav-link" href="../../tools/dart-test.html">dart test</a></li><li class="nav-item"><a class="nav-link" href="../../tools/dartaotruntime.html">dartaotruntime</a></li><li class="nav-item"><a class="nav-link" href="../../tools/experiment-flags.html">Experiment flags</a></li></ul></li><li class="nav-item"><a class="nav-link collapsible" data-toggle="collapse" data-target="#sidenav-7-3-2" href="#sidenav-7-3-2" role="button" aria-expanded="true" aria-controls="sidenav-7-3-2">Other command-line tools</a><ul class="nav flex-column flex-nowrap collapse show" id="sidenav-7-3-2"><li class="nav-item"><a class="nav-link" href="../../tools/build_runner.html">build_runner</a></li><li class="nav-item"><a class="nav-link" href="../../tools/webdev.html">webdev</a></li></ul></li></ul></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-7-4" href="#sidenav-7-4" role="button" aria-expanded="false" aria-controls="sidenav-7-4">Static analysis</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-7-4"><li class="nav-item"><a class="nav-link" href="../../tools/analysis.html">Customizing static analysis</a></li><li class="nav-item"><a class="nav-link" href="../../deprecated/sound-problems.html">Fixing common type problems</a></li><li class="nav-item"><a class="nav-link" href="../../tools/non-promotion-reasons.html">Fixing type promotion failures</a></li><li class="nav-item"><a class="nav-link" href="../../tools/linter-rules.html">Linter rules</a></li><li class="nav-item"><a class="nav-link" href="../../tools/diagnostic-messages.html">Diagnostic messages</a></li></ul></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-7-5" href="#sidenav-7-5" role="button" aria-expanded="false" aria-controls="sidenav-7-5">Testing & optimization</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-7-5"><li class="nav-item"><a class="nav-link" href="../../guides/testing.html">Testing</a></li><li class="nav-item"><a class="nav-link" href="../../web/debugging.html">Debugging web apps</a></li></ul></li></ul></li><li aria-hidden="true"><div class="sidebar-primary-divider"></div></li><li class="nav-item"><a class="nav-link collapsed collapsible" data-toggle="collapse" href="#sidenav-9" role="button" aria-expanded="false" aria-controls="sidenav-9">Resources</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-9"><li class="nav-item"><a class="nav-link" href="../../resources/dart-cheatsheet.html">Language cheatsheet</a></li><li class="nav-item"><a class="nav-link" href="../../resources/breaking-changes.html">Breaking changes</a></li><li class="nav-item"><a class="nav-link" href="../../resources/language/evolution.html">Language evolution</a></li><li class="nav-item"><a class="nav-link" href="../../resources/language/spec.html">Language specification</a></li><li class="nav-item"><a class="nav-link" href="../../resources/dart-3-migration.html">Dart 3 migration guide</a></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-9-6" href="#sidenav-9-6" role="button" aria-expanded="false" aria-controls="sidenav-9-6">Coming from ...</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-9-6"><li class="nav-item"><a class="nav-link" href="../../resources/coming-from/js-to-dart.html">JavaScript to Dart</a></li><li class="nav-item"><a class="nav-link" href="../../resources/coming-from/swift-to-dart.html">Swift to Dart</a></li></ul></li><div class="dropdown-divider"></div><li class="nav-item"><a class="nav-link" href="../../resources/faq.html">FAQ</a></li><li class="nav-item"><a class="nav-link" href="../../resources/glossary.html">Glossary</a></li><li class="nav-item"><a class="nav-link" href="../../resources/books.html">Books</a></li><li class="nav-item"><a class="nav-link" href="../../resources/videos.html">Videos</a></li><li class="nav-item"><a class="nav-link" href="../../tutorials.html">Tutorials</a></li></ul></li><li class="nav-item"><a class="nav-link collapsible" data-toggle="collapse" href="#sidenav-10" role="button" aria-expanded="true" aria-controls="sidenav-10">Related sites</a><ul class="nav flex-column flex-nowrap collapse show" id="sidenav-10"><li class="nav-item"><a class="nav-link" href="https://api.dart.dev/" target="_blank" rel="noopener">API reference</a></li><li class="nav-item"><a class="nav-link" href="https://medium.com/dartlang" target="_blank" rel="noopener">Blog</a></li><li class="nav-item"><a class="nav-link" href="https://dartpad.dev/" target="_blank" rel="noopener">DartPad (online editor)</a></li><li class="nav-item"><a class="nav-link" href="https://flutter.dev/" target="_blank" rel="noopener">Flutter</a></li><li class="nav-item"><a class="nav-link" href="https://pub.dev/" target="_blank" rel="noopener">Package site</a></li></ul></li></ul></div></div><main id="page-content"><div id="site-toc--side" class="site-toc"><header class="site-toc__title">Contents</header><ul class="section-nav"><li class="toc-entry nav-item"><a class="nav-link" href="#why-asynchronous-code-matters">Why asynchronous code matters</a><ul class="nav"><li class="toc-entry nav-item"><a class="nav-link" href="#example-incorrectly-using-an-asynchronous-function">Example: Incorrectly using an asynchronous function</a></li></ul></li><li class="toc-entry nav-item"><a class="nav-link" href="#what-is-a-future">What is a future?</a><ul class="nav"><li class="toc-entry nav-item"><a class="nav-link" href="#uncompleted">Uncompleted</a></li><li class="toc-entry nav-item"><a class="nav-link" href="#completed">Completed</a></li><li class="toc-entry nav-item"><a class="nav-link" href="#example-introducing-futures">Example: Introducing futures</a></li><li class="toc-entry nav-item"><a class="nav-link" href="#example-completing-with-an-error">Example: Completing with an error</a></li></ul></li><li class="toc-entry nav-item"><a class="nav-link" href="#working-with-futures-async-and-await">Working with futures: async and await</a><ul class="nav"><li class="toc-entry nav-item"><a class="nav-link" href="#execution-flow-with-async-and-await">Execution flow with async and await</a></li><li class="toc-entry nav-item"><a class="nav-link" href="#example-execution-within-async-functions">Example: Execution within async functions</a></li><li class="toc-entry nav-item"><a class="nav-link" href="#exercise-practice-using-async-and-await">Exercise: Practice using async and await</a></li></ul></li><li class="toc-entry nav-item"><a class="nav-link" href="#handling-errors">Handling errors</a><ul class="nav"><li class="toc-entry nav-item"><a class="nav-link" href="#example-async-and-await-with-try-catch">Example: async and await with try-catch</a></li><li class="toc-entry nav-item"><a class="nav-link" href="#exercise-practice-handling-errors">Exercise: Practice handling errors</a></li></ul></li><li class="toc-entry nav-item"><a class="nav-link" href="#exercise-putting-it-all-together">Exercise: Putting it all together</a></li><li class="toc-entry nav-item"><a class="nav-link" href="#which-lints-work-for-futures">Which lints work for futures?</a></li><li class="toc-entry nav-item"><a class="nav-link" href="#whats-next">What's next?</a></li></ul></div><article><div class="content"><div id="site-content-title"><h1>Asynchronous programming: futures, async, await</h1></div><div id="site-toc--inline" class="site-toc toc-collapsible toc-collapsed"><header class="site-toc__title">Contents <span class="site-toc--inline__toggle toc-toggle-down"><i class="material-symbols">keyboard_arrow_down</i></span> <span class="site-toc--inline__toggle toc-toggle-up"><i class="material-symbols">keyboard_arrow_up</i></span></header><ul class="section-nav"><li class="toc-entry"><a href="#why-asynchronous-code-matters">Why asynchronous code matters</a><ul><li class="toc-entry"><a href="#example-incorrectly-using-an-asynchronous-function">Example: Incorrectly using an asynchronous function</a></li></ul></li><li class="toc-entry"><a href="#what-is-a-future">What is a future?</a><ul><li class="toc-entry"><a href="#uncompleted">Uncompleted</a></li><li class="toc-entry"><a href="#completed">Completed</a></li><li class="toc-entry"><a href="#example-introducing-futures">Example: Introducing futures</a></li><li class="toc-entry"><a href="#example-completing-with-an-error">Example: Completing with an error</a></li></ul></li><li class="toc-entry"><a href="#working-with-futures-async-and-await">Working with futures: async and await</a><ul><li class="toc-entry"><a href="#execution-flow-with-async-and-await">Execution flow with async and await</a></li><li class="toc-entry"><a href="#example-execution-within-async-functions">Example: Execution within async functions</a></li><li class="toc-entry"><a href="#exercise-practice-using-async-and-await">Exercise: Practice using async and await</a></li></ul></li><li class="toc-entry"><a href="#handling-errors">Handling errors</a><ul><li class="toc-entry"><a href="#example-async-and-await-with-try-catch">Example: async and await with try-catch</a></li><li class="toc-entry"><a href="#exercise-practice-handling-errors">Exercise: Practice handling errors</a></li></ul></li><li class="toc-entry"><a href="#exercise-putting-it-all-together">Exercise: Putting it all together</a></li><li class="toc-entry"><a href="#which-lints-work-for-futures">Which lints work for futures?</a></li><li class="toc-entry"><a href="#whats-next">What's next?</a></li></ul><span class="site-toc--inline__toggle toc-toggle-more-items"><i class="material-symbols">more_horiz</i></span></div> <?code-excerpt replace="/ *\/\/\s+ignore_for_file:[^\n]+\n//g; /(^|\n) *\/\/\s+ignore:[^\n]+\n/$1/g; /(\n[^\n]+) *\/\/\s+ignore:[^\n]+\n/$1\n/g"?> <?code-excerpt plaster="none"?> <p>This tutorial teaches you how to write asynchronous code using futures and the <code>async</code> and <code>await</code> keywords. Using embedded DartPad editors, you can test your knowledge by running example code and completing exercises.</p><p>To get the most out of this tutorial, you should have the following:</p><ul><li>Knowledge of <a href="../../language.html">basic Dart syntax</a>.</li><li>Some experience writing asynchronous code in another language.</li><li>The <a href="../../tools/linter-rules/discarded_futures.html"><code>discarded_futures</code></a> and <a href="../../tools/linter-rules/unawaited_futures.html"><code>unawaited_futures</code></a> lints enabled.</li></ul><p>This tutorial covers the following material:</p><ul><li>How and when to use the <code>async</code> and <code>await</code> keywords.</li><li>How using <code>async</code> and <code>await</code> affects execution order.</li><li>How to handle errors from an asynchronous call using <code>try-catch</code> expressions in <code>async</code> functions.</li></ul><p>Estimated time to complete this tutorial: 40-60 minutes.</p><aside class="alert alert-info"><div class="alert-header"><i class="material-symbols" aria-hidden="true">info</i> <span>Note</span></div><div class="alert-content"><p>This page uses embedded DartPads to display examples and exercises. If you see empty boxes instead of DartPads, go to the <a href="../../tools/dartpad/troubleshoot.html">DartPad troubleshooting page</a>.</p></div></aside><p>The exercises in this tutorial have partially completed code snippets. You can use DartPad to test your knowledge by completing the code and clicking the <strong>Run</strong> button. <strong>Don't edit the test code in the <code>main</code> function or below</strong>.</p><p>If you need help, expand the <strong>Hint</strong> or <strong>Solution</strong> dropdown after each exercise.</p><div class="header-wrapper"><h2 id="why-asynchronous-code-matters">Why asynchronous code matters</h2><a class="heading-link" href="#why-asynchronous-code-matters" aria-label="Link to 'Why asynchronous code matters' section">#</a></div><p>Asynchronous operations let your program complete work while waiting for another operation to finish. Here are some common asynchronous operations:</p><ul><li>Fetching data over a network.</li><li>Writing to a database.</li><li>Reading data from a file.</li></ul><p>Such asynchronous computations usually provide their result as a <code>Future</code> or, if the result has multiple parts, as a <code>Stream</code>. These computations introduce asynchrony into a program. To accommodate that initial asynchrony, other plain Dart functions also need to become asynchronous.</p><p>To interact with these asynchronous results, you can use the <code>async</code> and <code>await</code> keywords. Most asynchronous functions are just async Dart functions that depend, possibly deep down, on an inherently asynchronous computation.</p><div class="header-wrapper"><h3 id="example-incorrectly-using-an-asynchronous-function">Example: Incorrectly using an asynchronous function</h3><a class="heading-link" href="#example-incorrectly-using-an-asynchronous-function" aria-label="Link to 'Example: Incorrectly using an asynchronous function' section">#</a></div><p>The following example shows the wrong way to use an asynchronous function (<code>fetchUserOrder()</code>). Later you'll fix the example using <code>async</code> and <code>await</code>. Before running this example, try to spot the issue -- what do you think the output will be?</p> <?code-excerpt "async_await/bin/get_order_sync_bad.dart" remove="Fetching"?> <pre><code data-dartpad="true" data-embed="true" data-theme="light" title="Runnable Dart sample" data-run="false">// This example shows how *not* to write asynchronous Dart code.

String createOrderMessage() {
  var order = fetchUserOrder();
  return 'Your order is: $order';
}

Future&lt;String&gt; fetchUserOrder() =&gt;
    // Imagine that this function is more complex and slow.
    Future.delayed(
      const Duration(seconds: 2),
      () =&gt; 'Large Latte',
    );

void main() {
  print(createOrderMessage());
}
</code></pre><p>Here's why the example fails to print the value that <code>fetchUserOrder()</code> eventually produces:</p><ul><li><code>fetchUserOrder()</code> is an asynchronous function that, after a delay, provides a string that describes the user's order: a &quot;Large Latte&quot;.</li><li>To get the user's order, <code>createOrderMessage()</code> should call <code>fetchUserOrder()</code> and wait for it to finish. Because <code>createOrderMessage()</code> does <em>not</em> wait for <code>fetchUserOrder()</code> to finish, <code>createOrderMessage()</code> fails to get the string value that <code>fetchUserOrder()</code> eventually provides.</li><li>Instead, <code>createOrderMessage()</code> gets a representation of pending work to be done: an uncompleted future. You'll learn more about futures in the next section.</li><li>Because <code>createOrderMessage()</code> fails to get the value describing the user's order, the example fails to print &quot;Large Latte&quot; to the console, and instead prints &quot;Your order is: Instance of '_Future&lt;String&gt;'&quot;.</li></ul><p>In the next sections you'll learn about futures and about working with futures (using <code>async</code> and <code>await</code>) so that you'll be able to write the code necessary to make <code>fetchUserOrder()</code> print the desired value (&quot;Large Latte&quot;) to the console.</p><aside class="alert alert-secondary"><div class="alert-header"><span>Key terms</span></div><div class="alert-content"><ul><li><strong>synchronous operation</strong>: A synchronous operation blocks other operations from executing until it completes.</li><li><strong>synchronous function</strong>: A synchronous function only performs synchronous operations.</li><li><strong>asynchronous operation</strong>: Once initiated, an asynchronous operation allows other operations to execute before it completes.</li><li><strong>asynchronous function</strong>: An asynchronous function performs at least one asynchronous operation and can also perform <em>synchronous</em> operations.</li></ul></div></aside><div class="header-wrapper"><h2 id="what-is-a-future">What is a future?</h2><a class="heading-link" href="#what-is-a-future" aria-label="Link to 'What is a future?' section">#</a></div><p>A future (lower case &quot;f&quot;) is an instance of the <a href="https://api.dart.dev/dart-async/Future-class.html">Future</a> (capitalized &quot;F&quot;) class. A future represents the result of an asynchronous operation, and can have two states: uncompleted or completed.</p><aside class="alert alert-info"><div class="alert-header"><i class="material-symbols" aria-hidden="true">info</i> <span>Note</span></div><div class="alert-content"><p><em>Uncompleted</em> is a Dart term referring to the state of a future before it has produced a value.</p></div></aside><div class="header-wrapper"><h3 id="uncompleted">Uncompleted</h3><a class="heading-link" href="#uncompleted" aria-label="Link to 'Uncompleted' section">#</a></div><p>When you call an asynchronous function, it returns an uncompleted future. That future is waiting for the function's asynchronous operation to finish or to throw an error.</p><div class="header-wrapper"><h3 id="completed">Completed</h3><a class="heading-link" href="#completed" aria-label="Link to 'Completed' section">#</a></div><p>If the asynchronous operation succeeds, the future completes with a value. Otherwise, it completes with an error.</p><div class="header-wrapper"><h4 id="completing-with-a-value">Completing with a value</h4><a class="heading-link" href="#completing-with-a-value" aria-label="Link to 'Completing with a value' section">#</a></div><p>A future of type <code>Future&lt;T&gt;</code> completes with a value of type <code>T</code>. For example, a future with type <code>Future&lt;String&gt;</code> produces a string value. If a future doesn't produce a usable value, then the future's type is <code>Future&lt;void&gt;</code>.</p><div class="header-wrapper"><h4 id="completing-with-an-error">Completing with an error</h4><a class="heading-link" href="#completing-with-an-error" aria-label="Link to 'Completing with an error' section">#</a></div><p>If the asynchronous operation performed by the function fails for any reason, the future completes with an error.</p><div class="header-wrapper"><h3 id="example-introducing-futures">Example: Introducing futures</h3><a class="heading-link" href="#example-introducing-futures" aria-label="Link to 'Example: Introducing futures' section">#</a></div><p>In the following example, <code>fetchUserOrder()</code> returns a future that completes after printing to the console. Because it doesn't return a usable value, <code>fetchUserOrder()</code> has the type <code>Future&lt;void&gt;</code>. Before you run the example, try to predict which will print first: &quot;Large Latte&quot; or &quot;Fetching user order...&quot;.</p> <?code-excerpt "async_await/bin/futures_intro.dart (no-error)"?> <pre><code data-dartpad="true" data-embed="true" data-theme="light" title="Runnable Dart sample" data-run="false">Future&lt;void&gt; fetchUserOrder() {
  // Imagine that this function is fetching user info from another service or database.
  return Future.delayed(const Duration(seconds: 2), () =&gt; print('Large Latte'));
}

void main() {
  fetchUserOrder();
  print('Fetching user order...');
}
</code></pre><p>In the preceding example, even though <code>fetchUserOrder()</code> executes before the <code>print()</code> call on line 8, the console shows the output from line 8(&quot;Fetching user order...&quot;) before the output from <code>fetchUserOrder()</code> (&quot;Large Latte&quot;). This is because <code>fetchUserOrder()</code> delays before it prints &quot;Large Latte&quot;.</p><div class="header-wrapper"><h3 id="example-completing-with-an-error">Example: Completing with an error</h3><a class="heading-link" href="#example-completing-with-an-error" aria-label="Link to 'Example: Completing with an error' section">#</a></div><p>Run the following example to see how a future completes with an error. A bit later you'll learn how to handle the error.</p> <?code-excerpt "async_await/bin/futures_intro.dart (error)" replace="/Error//g"?> <pre><code data-dartpad="true" data-embed="true" data-theme="light" title="Runnable Dart sample" data-run="false">Future&lt;void&gt; fetchUserOrder() {
  // Imagine that this function is fetching user info but encounters a bug.
  return Future.delayed(
    const Duration(seconds: 2),
    () =&gt; throw Exception('Logout failed: user ID is invalid'),
  );
}

void main() {
  fetchUserOrder();
  print('Fetching user order...');
}
</code></pre><p>In this example, <code>fetchUserOrder()</code> completes with an error indicating that the user ID is invalid.</p><p>You've learned about futures and how they complete, but how do you use the results of asynchronous functions? In the next section you'll learn how to get results with the <code>async</code> and <code>await</code> keywords.</p><aside class="alert alert-secondary"><div class="alert-header"><span>Quick review</span></div><div class="alert-content"><ul><li>A <a href="https://api.dart.dev/dart-async/Future-class.html">Future&lt;T&gt;</a> instance produces a value of type <code>T</code>.</li><li>If a future doesn't produce a usable value, then the future's type is <code>Future&lt;void&gt;</code>.</li><li>A future can be in one of two states: uncompleted or completed.</li><li>When you call a function that returns a future, the function queues up work to be done and returns an uncompleted future.</li><li>When a future's operation finishes, the future completes with a value or with an error.</li></ul><p><strong>Key terms:</strong></p><ul><li><strong>Future</strong>: the Dart <a href="https://api.dart.dev/dart-async/Future-class.html">Future</a> class.</li><li><strong>future</strong>: an instance of the Dart <code>Future</code> class.</li></ul></div></aside><div class="header-wrapper"><h2 id="working-with-futures-async-and-await">Working with futures: async and await</h2><a class="heading-link" href="#working-with-futures-async-and-await" aria-label="Link to 'Working with futures: async and await' section">#</a></div><p>The <code>async</code> and <code>await</code> keywords provide a declarative way to define asynchronous functions and use their results. Remember these two basic guidelines when using <code>async</code> and <code>await</code>:</p><ul><li><strong>To define an async function, add <code>async</code> before the function body:</strong></li><li><strong>The <code>await</code> keyword works only in <code>async</code> functions.</strong></li></ul><p>Here's an example that converts <code>main()</code> from a synchronous to asynchronous function.</p><p>First, add the <code>async</code> keyword before the function body:</p> <?code-excerpt "async_await/bin/get_order_sync_bad.dart (main-sig)" replace="/main\(\)/$& async/g; /async/[!$&!]/g; /$/ ··· }/g"?> <div class="code-block-wrapper language-dart"><div class="code-block-body"><span class="code-block-language" title="Language dart">dart</span><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#D43324">void</span><span style="color:#6200EE"> main</span><span style="color:#222222">() </span><mark class="highlight"><span style="color:#D43324">async</span></mark><span style="color:#222222"> { ··· }</span></span></code></pre></div></div><p>If the function has a declared return type, then update the type to be <code>Future&lt;T&gt;</code>, where <code>T</code> is the type of the value that the function returns. If the function doesn't explicitly return a value, then the return type is <code>Future&lt;void&gt;</code>:</p> <?code-excerpt "async_await/bin/get_order.dart (main-sig)" replace="/Future<\w+\W/[!$&!]/g;  /$/ ··· }/g"?> <div class="code-block-wrapper language-dart"><div class="code-block-body"><span class="code-block-language" title="Language dart">dart</span><pre class="shiki dash-light" tabindex="0"><code><span class="line"><mark class="highlight"><span style="color:#0468D7">Future</span><span style="color:#222222">&#x3C;</span><span style="color:#D43324">void</span><span style="color:#222222">></span></mark><span style="color:#222222"> </span><span style="color:#6200EE">main</span><span style="color:#222222">() </span><span style="color:#D43324">async</span><span style="color:#222222"> { ··· }</span></span></code></pre></div></div><p>Now that you have an <code>async</code> function, you can use the <code>await</code> keyword to wait for a future to complete:</p> <?code-excerpt "async_await/bin/get_order.dart (print-order)" replace="/await/[!$&!]/g"?> <div class="code-block-wrapper language-dart"><div class="code-block-body"><span class="code-block-language" title="Language dart">dart</span><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#6200EE">print</span><span style="color:#222222">(</span><mark class="highlight"><span style="color:#D43324">await</span></mark><span style="color:#6200EE"> createOrderMessage</span><span style="color:#222222">());</span></span></code></pre></div></div><p>As the following two examples show, the <code>async</code> and <code>await</code> keywords result in asynchronous code that looks a lot like synchronous code. The only differences are highlighted in the asynchronous example, which—if your window is wide enough—is to the right of the synchronous example.</p><div class="header-wrapper"><h4 id="example-synchronous-functions">Example: synchronous functions</h4><a class="heading-link" href="#example-synchronous-functions" aria-label="Link to 'Example: synchronous functions' section">#</a></div> <?code-excerpt "async_await/bin/get_order_sync_bad.dart (no-warning)" replace="/(\s+\/\/ )(Imagine.*? is )(.*)/$1$2$1$3/g"?> <div class="code-block-wrapper language-dart"><div class="code-block-body"><span class="code-block-language" title="Language dart">dart</span><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#0468D7">String</span><span style="color:#6200EE"> createOrderMessage</span><span style="color:#222222">() {</span></span>
<span class="line"><span style="color:#D43324">  var</span><span style="color:#222222"> order = </span><span style="color:#6200EE">fetchUserOrder</span><span style="color:#222222">();</span></span>
<span class="line"><span style="color:#D43324">  return</span><span style="color:#11796D"> 'Your order is: </span><span style="color:#11796D">$</span><span style="color:#222222">order</span><span style="color:#11796D">'</span><span style="color:#222222">;</span></span>
<span class="line"><span style="color:#222222">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#0468D7">Future</span><span style="color:#222222">&#x3C;</span><span style="color:#0468D7">String</span><span style="color:#222222">> </span><span style="color:#6200EE">fetchUserOrder</span><span style="color:#222222">() =></span></span>
<span class="line"><span style="color:#6E6E70">    // Imagine that this function is</span></span>
<span class="line"><span style="color:#6E6E70">    // more complex and slow.</span></span>
<span class="line"><span style="color:#0468D7">    Future</span><span style="color:#222222">.</span><span style="color:#6200EE">delayed</span><span style="color:#222222">(</span></span>
<span class="line"><span style="color:#D43324">      const</span><span style="color:#0468D7"> Duration</span><span style="color:#222222">(seconds: </span><span style="color:#11796D">2</span><span style="color:#222222">),</span></span>
<span class="line"><span style="color:#222222">      () => </span><span style="color:#11796D">'Large Latte'</span><span style="color:#222222">,</span></span>
<span class="line"><span style="color:#222222">    );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D43324">void</span><span style="color:#6200EE"> main</span><span style="color:#222222">() {</span></span>
<span class="line"><span style="color:#6200EE">  print</span><span style="color:#222222">(</span><span style="color:#11796D">'Fetching user order...'</span><span style="color:#222222">);</span></span>
<span class="line"><span style="color:#6200EE">  print</span><span style="color:#222222">(</span><span style="color:#6200EE">createOrderMessage</span><span style="color:#222222">());</span></span>
<span class="line"><span style="color:#222222">}</span></span></code></pre></div></div><div class="code-block-wrapper language-plaintext"><div class="code-block-body"><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span>Fetching user order...</span></span>
<span class="line"><span>Your order is: Instance of 'Future&#x3C;String>'</span></span></code></pre></div></div><p>As shown in following two examples, it operates like synchronous code.</p><div class="header-wrapper"><h4 id="example-asynchronous-functions">Example: asynchronous functions</h4><a class="heading-link" href="#example-asynchronous-functions" aria-label="Link to 'Example: asynchronous functions' section">#</a></div> <?code-excerpt "async_await/bin/get_order.dart" replace="/(\s+\/\/ )(Imagine.*? is )(.*)/$1$2$1$3/g; /async|await/[!$&!]/g; /(Future<\w+\W)( [^f])/[!$1!]$2/g; /4/2/g"?> <div class="code-block-wrapper language-dart"><div class="code-block-body"><span class="code-block-language" title="Language dart">dart</span><pre class="shiki dash-light" tabindex="0"><code><span class="line"><mark class="highlight"><span style="color:#0468D7">Future</span><span style="color:#222222">&#x3C;</span><span style="color:#0468D7">String</span><span style="color:#222222">></span></mark><span style="color:#222222"> </span><span style="color:#6200EE">createOrderMessage</span><span style="color:#222222">() </span><mark class="highlight"><span style="color:#D43324">async</span></mark><span style="color:#222222"> {</span></span>
<span class="line"><span style="color:#D43324">  var</span><span style="color:#222222"> order = </span><mark class="highlight"><span style="color:#D43324">await</span></mark><span style="color:#6200EE"> fetchUserOrder</span><span style="color:#222222">();</span></span>
<span class="line"><span style="color:#D43324">  return</span><span style="color:#11796D"> 'Your order is: </span><span style="color:#11796D">$</span><span style="color:#222222">order</span><span style="color:#11796D">'</span><span style="color:#222222">;</span></span>
<span class="line"><span style="color:#222222">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#0468D7">Future</span><span style="color:#222222">&#x3C;</span><span style="color:#0468D7">String</span><span style="color:#222222">> </span><span style="color:#6200EE">fetchUserOrder</span><span style="color:#222222">() =></span></span>
<span class="line"><span style="color:#6E6E70">    // Imagine that this function is</span></span>
<span class="line"><span style="color:#6E6E70">    // more complex and slow.</span></span>
<span class="line"><span style="color:#0468D7">    Future</span><span style="color:#222222">.</span><span style="color:#6200EE">delayed</span><span style="color:#222222">(</span></span>
<span class="line"><span style="color:#D43324">      const</span><span style="color:#0468D7"> Duration</span><span style="color:#222222">(seconds: </span><span style="color:#11796D">2</span><span style="color:#222222">),</span></span>
<span class="line"><span style="color:#222222">      () => </span><span style="color:#11796D">'Large Latte'</span><span style="color:#222222">,</span></span>
<span class="line"><span style="color:#222222">    );</span></span>
<span class="line"></span>
<span class="line"><mark class="highlight"><span style="color:#0468D7">Future</span><span style="color:#222222">&#x3C;</span><span style="color:#D43324">void</span><span style="color:#222222">></span></mark><span style="color:#222222"> </span><span style="color:#6200EE">main</span><span style="color:#222222">() </span><mark class="highlight"><span style="color:#D43324">async</span></mark><span style="color:#222222"> {</span></span>
<span class="line"><span style="color:#6200EE">  print</span><span style="color:#222222">(</span><span style="color:#11796D">'Fetching user order...'</span><span style="color:#222222">);</span></span>
<span class="line"><span style="color:#6200EE">  print</span><span style="color:#222222">(</span><mark class="highlight"><span style="color:#D43324">await</span></mark><span style="color:#6200EE"> createOrderMessage</span><span style="color:#222222">());</span></span>
<span class="line"><span style="color:#222222">}</span></span></code></pre></div></div><div class="code-block-wrapper language-plaintext"><div class="code-block-body"><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span>Fetching user order...</span></span>
<span class="line"><span>Your order is: Large Latte</span></span></code></pre></div></div><p>The asynchronous example is different in three ways:</p><ul><li>The return type for <code>createOrderMessage()</code> changes from <code>String</code> to <code>Future&lt;String&gt;</code>.</li><li>The <strong><code>async</code></strong> keyword appears before the function bodies for <code>createOrderMessage()</code> and <code>main()</code>.</li><li>The <strong><code>await</code></strong> keyword appears before calling the asynchronous functions <code>fetchUserOrder()</code> and <code>createOrderMessage()</code>.</li></ul><aside class="alert alert-secondary"><div class="alert-header"><span>Key terms</span></div><div class="alert-content"><ul><li><strong>async</strong>: You can use the <code>async</code> keyword before a function's body to mark it as asynchronous.</li><li><strong>async function</strong>: An <code>async</code> function is a function labeled with the <code>async</code> keyword.</li><li><strong>await</strong>: You can use the <code>await</code> keyword to get the completed result of an asynchronous expression. The <code>await</code> keyword only works within an <code>async</code> function.</li></ul></div></aside><div class="header-wrapper"><h3 id="execution-flow-with-async-and-await">Execution flow with async and await</h3><a class="heading-link" href="#execution-flow-with-async-and-await" aria-label="Link to 'Execution flow with async and await' section">#</a></div><p>An <code>async</code> function runs synchronously until the first <code>await</code> keyword. This means that within an <code>async</code> function body, all synchronous code before the first <code>await</code> keyword executes immediately.</p><div class="header-wrapper"><h3 id="example-execution-within-async-functions">Example: Execution within async functions</h3><a class="heading-link" href="#example-execution-within-async-functions" aria-label="Link to 'Example: Execution within async functions' section">#</a></div><p>Run the following example to see how execution proceeds within an <code>async</code> function body. What do you think the output will be?</p> <?code-excerpt "async_await/bin/async_example.dart" remove="/\/\/ print/"?> <pre><code data-dartpad="true" data-embed="true" data-theme="light" title="Runnable Dart sample" data-run="false">Future&lt;void&gt; printOrderMessage() async {
  print('Awaiting user order...');
  var order = await fetchUserOrder();
  print('Your order is: $order');
}

Future&lt;String&gt; fetchUserOrder() {
  // Imagine that this function is more complex and slow.
  return Future.delayed(const Duration(seconds: 4), () =&gt; 'Large Latte');
}

void main() async {
  countSeconds(4);
  await printOrderMessage();
}

// You can ignore this function - it's here to visualize delay time in this example.
void countSeconds(int s) {
  for (var i = 1; i &lt;= s; i++) {
    Future.delayed(Duration(seconds: i), () =&gt; print(i));
  }
}
</code></pre><p>After running the code in the preceding example, try reversing lines 2 and 3:</p> <?code-excerpt "async_await/bin/async_example.dart (swap-stmts)" replace="/\/\/ (print)/$1/g"?> <div class="code-block-wrapper language-dart"><div class="code-block-body"><span class="code-block-language" title="Language dart">dart</span><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#D43324">var</span><span style="color:#222222"> order = </span><span style="color:#D43324">await</span><span style="color:#6200EE"> fetchUserOrder</span><span style="color:#222222">();</span></span>
<span class="line"><span style="color:#6200EE">print</span><span style="color:#222222">(</span><span style="color:#11796D">'Awaiting user order...'</span><span style="color:#222222">);</span></span></code></pre></div></div><p>Notice that timing of the output shifts, now that <code>print('Awaiting user order')</code> appears after the first <code>await</code> keyword in <code>printOrderMessage()</code>.</p><div class="header-wrapper"><h3 id="exercise-practice-using-async-and-await">Exercise: Practice using async and await</h3><a class="heading-link" href="#exercise-practice-using-async-and-await" aria-label="Link to 'Exercise: Practice using async and await' section">#</a></div><p>The following exercise is a failing unit test that contains partially completed code snippets. Your task is to complete the exercise by writing code to make the tests pass. You don't need to implement <code>main()</code>.</p><p>To simulate asynchronous operations, call the following functions, which are provided for you:</p><div class="table-wrapper"><table class="table table-striped"><thead><tr><th>Function</th><th>Type signature</th><th>Description</th></tr></thead><tbody><tr><td>fetchRole()</td><td><code>Future&lt;String&gt; fetchRole()</code></td><td>Gets a short description of the user's role.</td></tr><tr><td>fetchLoginAmount()</td><td><code>Future&lt;int&gt; fetchLoginAmount()</code></td><td>Gets the number of times a user has logged in.</td></tr></tbody></table></div><div class="header-wrapper"><h4 id="part-1-reportuserrole">Part 1: <code>reportUserRole()</code></h4><a class="heading-link" href="#part-1-reportuserrole" aria-label="Link to 'Part 1: reportUserRole()' section">#</a></div><p>Add code to the <code>reportUserRole()</code> function so that it does the following:</p><ul><li>Returns a future that completes with the following string: <code>&quot;User role: &lt;user role&gt;&quot;</code><ul><li>Note: You must use the actual value returned by <code>fetchRole()</code>; copying and pasting the example return value won't make the test pass.</li><li>Example return value: <code>&quot;User role: tester&quot;</code></li></ul></li><li>Gets the user role by calling the provided function <code>fetchRole()</code>.</li></ul><div class="header-wrapper"><h4 id="part-2-reportlogins">Part 2: <code>reportLogins()</code></h4><a class="heading-link" href="#part-2-reportlogins" aria-label="Link to 'Part 2: reportLogins()' section">#</a></div><p>Implement an <code>async</code> function <code>reportLogins()</code> so that it does the following:</p><ul><li>Returns the string <code>&quot;Total number of logins: &lt;# of logins&gt;&quot;</code>.<ul><li>Note: You must use the actual value returned by <code>fetchLoginAmount()</code>; copying and pasting the example return value won't make the test pass.</li><li>Example return value from <code>reportLogins()</code>: <code>&quot;Total number of logins: 57&quot;</code></li></ul></li><li>Gets the number of logins by calling the provided function <code>fetchLoginAmount()</code>.</li></ul><pre><code data-dartpad="true" data-embed="true" data-theme="dark" title="Runnable Dart sample" data-run="false">// Part 1
// Call the provided async function fetchRole()
// to return the user role.
Future&lt;String&gt; reportUserRole() async {
  // TODO: Implement the reportUserRole function here.
}

// Part 2
// TODO: Implement the reportLogins function here.
// Call the provided async function fetchLoginAmount()
// to return the number of times that the user has logged in.
reportLogins() {}

// The following functions those provided to you to simulate
// asynchronous operations that could take a while.

Future&lt;String&gt; fetchRole() =&gt; Future.delayed(_halfSecond, () =&gt; _role);
Future&lt;int&gt; fetchLoginAmount() =&gt; Future.delayed(_halfSecond, () =&gt; _logins);

// The following code is used to test and provide feedback on your solution.
// There is no need to read or modify it.

void main() async {
  print('Testing...');
  List&lt;String&gt; messages = [];
  const passed = 'PASSED';
  const testFailedMessage = 'Test failed for the function:';
  const typoMessage = 'Test failed! Check for typos in your return value';
  try {
    messages
      ..add(_makeReadable(
          testLabel: 'Part 1',
          testResult: await _asyncEquals(
            expected: 'User role: administrator',
            actual: await reportUserRole(),
            typoKeyword: _role,
          ),
          readableErrors: {
            typoMessage: typoMessage,
            'null':
                'Test failed! Did you forget to implement or return from reportUserRole?',
            'User role: Instance of \'Future&lt;String&gt;\'':
                '$testFailedMessage reportUserRole. Did you use the await keyword?',
            'User role: Instance of \'_Future&lt;String&gt;\'':
                '$testFailedMessage reportUserRole. Did you use the await keyword?',
            'User role:':
                '$testFailedMessage reportUserRole. Did you return a user role?',
            'User role: ':
                '$testFailedMessage reportUserRole. Did you return a user role?',
            'User role: tester':
                '$testFailedMessage reportUserRole. Did you invoke fetchRole to fetch the user\'s role?',
          }))
      ..add(_makeReadable(
          testLabel: 'Part 2',
          testResult: await _asyncEquals(
            expected: 'Total number of logins: 42',
            actual: await reportLogins(),
            typoKeyword: _logins.toString(),
          ),
          readableErrors: {
            typoMessage: typoMessage,
            'null':
                'Test failed! Did you forget to implement or return from reportLogins?',
            'Total number of logins: Instance of \'Future&lt;int&gt;\'':
                '$testFailedMessage reportLogins. Did you use the await keyword?',
            'Total number of logins: Instance of \'_Future&lt;int&gt;\'':
                '$testFailedMessage reportLogins. Did you use the await keyword?',
            'Total number of logins: ':
                '$testFailedMessage reportLogins. Did you return the number of logins?',
            'Total number of logins:':
                '$testFailedMessage reportLogins. Did you return the number of logins?',
            'Total number of logins: 57':
                '$testFailedMessage reportLogins. Did you invoke fetchLoginAmount to fetch the number of user logins?',
          }))
      ..removeWhere((m) =&gt; m.contains(passed))
      ..toList();

    if (messages.isEmpty) {
      print('Success. All tests passed!');
    } else {
      messages.forEach(print);
    }
  } on UnimplementedError {
    print(
        'Test failed! Did you forget to implement or return from reportUserRole?');
  } catch (e) {
    print('Tried to run solution, but received an exception: $e');
  }
}

const _role = 'administrator';
const _logins = 42;
const _halfSecond = Duration(milliseconds: 500);

// Test helpers.
String _makeReadable({
  required String testResult,
  required Map&lt;String, String&gt; readableErrors,
  required String testLabel,
}) {
  if (readableErrors.containsKey(testResult)) {
    var readable = readableErrors[testResult];
    return '$testLabel $readable';
  } else {
    return '$testLabel $testResult';
  }
}

// Assertions used in tests.
Future&lt;String&gt; _asyncEquals({
  required String expected,
  required dynamic actual,
  required String typoKeyword,
}) async {
  var strActual = actual is String ? actual : actual.toString();
  try {
    if (expected == actual) {
      return 'PASSED';
    } else if (strActual.contains(typoKeyword)) {
      return 'Test failed! Check for typos in your return value';
    } else {
      return strActual;
    }
  } catch (e) {
    return e.toString();
  }
}
</code></pre><details><summary title="Expand for a hint on the async-await exercise.">Hint</summary><p>Did you remember to add the <code>async</code> keyword to the <code>reportUserRole</code> function?</p><p>Did you remember to use the <code>await</code> keyword before invoking <code>fetchRole()</code>?</p><p>Remember: <code>reportUserRole</code> needs to return a <code>Future</code>.</p></details><details><summary title="Expand for the solution of the async-await exercise.">Solution</summary><div class="code-block-wrapper language-dart"><div class="code-block-body"><span class="code-block-language" title="Language dart">dart</span><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#0468D7">Future</span><span style="color:#222222">&#x3C;</span><span style="color:#0468D7">String</span><span style="color:#222222">> </span><span style="color:#6200EE">reportUserRole</span><span style="color:#222222">() </span><span style="color:#D43324">async</span><span style="color:#222222"> {</span></span>
<span class="line"><span style="color:#D43324">  final</span><span style="color:#222222"> username = </span><span style="color:#D43324">await</span><span style="color:#6200EE"> fetchRole</span><span style="color:#222222">();</span></span>
<span class="line"><span style="color:#D43324">  return</span><span style="color:#11796D"> 'User role: </span><span style="color:#11796D">$</span><span style="color:#222222">username</span><span style="color:#11796D">'</span><span style="color:#222222">;</span></span>
<span class="line"><span style="color:#222222">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#0468D7">Future</span><span style="color:#222222">&#x3C;</span><span style="color:#0468D7">String</span><span style="color:#222222">> </span><span style="color:#6200EE">reportLogins</span><span style="color:#222222">() </span><span style="color:#D43324">async</span><span style="color:#222222"> {</span></span>
<span class="line"><span style="color:#D43324">  final</span><span style="color:#222222"> logins = </span><span style="color:#D43324">await</span><span style="color:#6200EE"> fetchLoginAmount</span><span style="color:#222222">();</span></span>
<span class="line"><span style="color:#D43324">  return</span><span style="color:#11796D"> 'Total number of logins: </span><span style="color:#11796D">$</span><span style="color:#222222">logins</span><span style="color:#11796D">'</span><span style="color:#222222">;</span></span>
<span class="line"><span style="color:#222222">}</span></span></code></pre></div></div></details><div class="header-wrapper"><h2 id="handling-errors">Handling errors</h2><a class="heading-link" href="#handling-errors" aria-label="Link to 'Handling errors' section">#</a></div><p>To handle errors in an <code>async</code> function, use try-catch:</p> <?code-excerpt "async_await/bin/try_catch.dart (try-catch)" remove="print(order)"?> <div class="code-block-wrapper language-dart"><div class="code-block-body"><span class="code-block-language" title="Language dart">dart</span><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#D43324">try</span><span style="color:#222222"> {</span></span>
<span class="line"><span style="color:#6200EE">  print</span><span style="color:#222222">(</span><span style="color:#11796D">'Awaiting user order...'</span><span style="color:#222222">);</span></span>
<span class="line"><span style="color:#D43324">  var</span><span style="color:#222222"> order = </span><span style="color:#D43324">await</span><span style="color:#6200EE"> fetchUserOrder</span><span style="color:#222222">();</span></span>
<span class="line"><span style="color:#222222">} </span><span style="color:#D43324">catch</span><span style="color:#222222"> (err) {</span></span>
<span class="line"><span style="color:#6200EE">  print</span><span style="color:#222222">(</span><span style="color:#11796D">'Caught error: </span><span style="color:#11796D">$</span><span style="color:#222222">err</span><span style="color:#11796D">'</span><span style="color:#222222">);</span></span>
<span class="line"><span style="color:#222222">}</span></span></code></pre></div></div><p>Within an <code>async</code> function, you can write <a href="../../language/error-handling.html#catch">try-catch clauses</a> the same way you would in synchronous code.</p><div class="header-wrapper"><h3 id="example-async-and-await-with-try-catch">Example: async and await with try-catch</h3><a class="heading-link" href="#example-async-and-await-with-try-catch" aria-label="Link to 'Example: async and await with try-catch' section">#</a></div><p>Run the following example to see how to handle an error from an asynchronous function. What do you think the output will be?</p> <?code-excerpt "async_await/bin/try_catch.dart"?> <pre><code data-dartpad="true" data-embed="true" data-theme="light" title="Runnable Dart sample" data-run="false">Future&lt;void&gt; printOrderMessage() async {
  try {
    print('Awaiting user order...');
    var order = await fetchUserOrder();
    print(order);
  } catch (err) {
    print('Caught error: $err');
  }
}

Future&lt;String&gt; fetchUserOrder() {
  // Imagine that this function is more complex.
  var str = Future.delayed(
      const Duration(seconds: 4),
      () =&gt; throw 'Cannot locate user order');
  return str;
}

void main() async {
  await printOrderMessage();
}
</code></pre><div class="header-wrapper"><h3 id="exercise-practice-handling-errors">Exercise: Practice handling errors</h3><a class="heading-link" href="#exercise-practice-handling-errors" aria-label="Link to 'Exercise: Practice handling errors' section">#</a></div><p>The following exercise provides practice handling errors with asynchronous code, using the approach described in the previous section. To simulate asynchronous operations, your code will call the following function, which is provided for you:</p><div class="table-wrapper"><table class="table table-striped"><thead><tr><th>Function</th><th>Type signature</th><th>Description</th></tr></thead><tbody><tr><td>fetchNewUsername()</td><td><code>Future&lt;String&gt; fetchNewUsername()</code></td><td>Returns the new username that you can use to replace an old one.</td></tr></tbody></table></div><p>Use <code>async</code> and <code>await</code> to implement an asynchronous <code>changeUsername()</code> function that does the following:</p><ul><li>Calls the provided asynchronous function <code>fetchNewUsername()</code> and returns its result.<ul><li>Example return value from <code>changeUsername()</code>: <code>&quot;jane_smith_92&quot;</code></li></ul></li><li>Catches any error that occurs and returns the string value of the error.<ul><li>You can use the <a href="https://api.dart.dev/dart-core/ArgumentError/toString.html">toString()</a> method to stringify both <a href="https://api.dart.dev/dart-core/Exception-class.html">Exceptions</a> and <a href="https://api.dart.dev/dart-core/Error-class.html">Errors.</a></li></ul></li></ul><pre><code data-dartpad="true" data-embed="true" data-theme="dark" title="Runnable Dart sample" data-run="false">// TODO: Implement changeUsername here.
changeUsername() {}

// The following function is provided to you to simulate
// an asynchronous operation that could take a while and
// potentially throw an exception.

Future&lt;String&gt; fetchNewUsername() =&gt;
    Future.delayed(const Duration(milliseconds: 500), () =&gt; throw UserError());

class UserError implements Exception {
  @override
  String toString() =&gt; 'New username is invalid';
}

// The following code is used to test and provide feedback on your solution.
// There is no need to read or modify it.

void main() async {
  final List&lt;String&gt; messages = [];
  const typoMessage = 'Test failed! Check for typos in your return value';

  print('Testing...');
  try {
    messages
      ..add(_makeReadable(
          testLabel: '',
          testResult: await _asyncDidCatchException(changeUsername),
          readableErrors: {
            typoMessage: typoMessage,
            _noCatch:
                'Did you remember to call fetchNewUsername within a try/catch block?',
          }))
      ..add(_makeReadable(
          testLabel: '',
          testResult: await _asyncErrorEquals(changeUsername),
          readableErrors: {
            typoMessage: typoMessage,
            _noCatch:
                'Did you remember to call fetchNewUsername within a try/catch block?',
          }))
      ..removeWhere((m) =&gt; m.contains(_passed))
      ..toList();

    if (messages.isEmpty) {
      print('Success. All tests passed!');
    } else {
      messages.forEach(print);
    }
  } catch (e) {
    print('Tried to run solution, but received an exception: $e');
  }
}

// Test helpers.
String _makeReadable({
  required String testResult,
  required Map&lt;String, String&gt; readableErrors,
  required String testLabel,
}) {
  if (readableErrors.containsKey(testResult)) {
    final readable = readableErrors[testResult];
    return '$testLabel $readable';
  } else {
    return '$testLabel $testResult';
  }
}

Future&lt;String&gt; _asyncErrorEquals(Function fn) async {
  final result = await fn();
  if (result == UserError().toString()) {
    return _passed;
  } else {
    return 'Test failed! Did you stringify and return the caught error?';
  }
}

Future&lt;String&gt; _asyncDidCatchException(Function fn) async {
  var caught = true;
  try {
    await fn();
  } on UserError catch (_) {
    caught = false;
  }

  if (caught == false) {
    return _noCatch;
  } else {
    return _passed;
  }
}

const _passed = 'PASSED';
const _noCatch = 'NO_CATCH';
</code></pre><details><summary title="Expand for a hint on the error-handling exercise.">Hint</summary><p>Implement <code>changeUsername</code> to return the string from <code>fetchNewUsername</code> or, if that fails, the string value of any error that occurs.</p><p>Remember: You can use a <a href="../../language/error-handling.html#catch">try-catch statement</a> to catch and handle errors.</p></details><details><summary title="Expand for the solution of the error-handling exercise.">Solution</summary><div class="code-block-wrapper language-dart"><div class="code-block-body"><span class="code-block-language" title="Language dart">dart</span><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#0468D7">Future</span><span style="color:#222222">&#x3C;</span><span style="color:#0468D7">String</span><span style="color:#222222">> </span><span style="color:#6200EE">changeUsername</span><span style="color:#222222">() </span><span style="color:#D43324">async</span><span style="color:#222222"> {</span></span>
<span class="line"><span style="color:#D43324">  try</span><span style="color:#222222"> {</span></span>
<span class="line"><span style="color:#D43324">    return</span><span style="color:#D43324"> await</span><span style="color:#6200EE"> fetchNewUsername</span><span style="color:#222222">();</span></span>
<span class="line"><span style="color:#222222">  } </span><span style="color:#D43324">catch</span><span style="color:#222222"> (err) {</span></span>
<span class="line"><span style="color:#D43324">    return</span><span style="color:#222222"> err.</span><span style="color:#6200EE">toString</span><span style="color:#222222">();</span></span>
<span class="line"><span style="color:#222222">  }</span></span>
<span class="line"><span style="color:#222222">}</span></span></code></pre></div></div></details><div class="header-wrapper"><h2 id="exercise-putting-it-all-together">Exercise: Putting it all together</h2><a class="heading-link" href="#exercise-putting-it-all-together" aria-label="Link to 'Exercise: Putting it all together' section">#</a></div><p>It's time to practice what you've learned in one final exercise. To simulate asynchronous operations, this exercise provides the asynchronous functions <code>fetchUsername()</code> and <code>logoutUser()</code>:</p><div class="table-wrapper"><table class="table table-striped"><thead><tr><th>Function</th><th>Type signature</th><th>Description</th></tr></thead><tbody><tr><td>fetchUsername()</td><td><code>Future&lt;String&gt; fetchUsername()</code></td><td>Returns the name associated with the current user.</td></tr><tr><td>logoutUser()</td><td><code>Future&lt;String&gt; logoutUser()</code></td><td>Performs logout of current user and returns the username that was logged out.</td></tr></tbody></table></div><p>Write the following:</p><div class="header-wrapper"><h4 id="part-1-addhello">Part 1: <code>addHello()</code></h4><a class="heading-link" href="#part-1-addhello" aria-label="Link to 'Part 1: addHello()' section">#</a></div><ul><li>Write a function <code>addHello()</code> that takes a single <code>String</code> argument.</li><li><code>addHello()</code> returns its <code>String</code> argument preceded by <code>'Hello '</code>.<br>Example: <code>addHello('Jon')</code> returns <code>'Hello Jon'</code>.</li></ul><div class="header-wrapper"><h4 id="part-2-greetuser">Part 2: <code>greetUser()</code></h4><a class="heading-link" href="#part-2-greetuser" aria-label="Link to 'Part 2: greetUser()' section">#</a></div><ul><li>Write a function <code>greetUser()</code> that takes no arguments.</li><li>To get the username, <code>greetUser()</code> calls the provided asynchronous function <code>fetchUsername()</code>.</li><li><code>greetUser()</code> creates a greeting for the user by calling <code>addHello()</code>, passing it the username, and returning the result.<br>Example: If <code>fetchUsername()</code> returns <code>'Jenny'</code>, then <code>greetUser()</code> returns <code>'Hello Jenny'</code>.</li></ul><div class="header-wrapper"><h4 id="part-3-saygoodbye">Part 3: <code>sayGoodbye()</code></h4><a class="heading-link" href="#part-3-saygoodbye" aria-label="Link to 'Part 3: sayGoodbye()' section">#</a></div><ul><li>Write a function <code>sayGoodbye()</code> that does the following:<ul><li>Takes no arguments.</li><li>Catches any errors.</li><li>Calls the provided asynchronous function <code>logoutUser()</code>.</li></ul></li><li>If <code>logoutUser()</code> fails, <code>sayGoodbye()</code> returns any string you like.</li><li>If <code>logoutUser()</code> succeeds, <code>sayGoodbye()</code> returns the string <code>'&lt;result&gt; Thanks, see you next time'</code>, where <code>&lt;result&gt;</code> is the string value returned by calling <code>logoutUser()</code>.</li></ul><pre><code data-dartpad="true" data-embed="true" data-theme="dark" title="Runnable Dart sample" data-run="false">// Part 1
addHello(String user) {}

// Part 2
// Call the provided async function fetchUsername()
// to return the username.
greetUser() {}

// Part 3
// Call the provided async function logoutUser()
// to log out the user.
sayGoodbye() {}

// The following functions are provided to you to use in your solutions.

Future&lt;String&gt; fetchUsername() =&gt; Future.delayed(_halfSecond, () =&gt; 'Jean');

Future&lt;String&gt; logoutUser() =&gt; Future.delayed(_halfSecond, _failOnce);

// The following code is used to test and provide feedback on your solution.
// There is no need to read or modify it.

void main() async {
  const didNotImplement =
      'Test failed! Did you forget to implement or return from';

  final List&lt;String&gt; messages = [];

  print('Testing...');
  try {
    messages
      ..add(_makeReadable(
          testLabel: 'Part 1',
          testResult: await _asyncEquals(
              expected: 'Hello Jerry',
              actual: addHello('Jerry'),
              typoKeyword: 'Jerry'),
          readableErrors: {
            _typoMessage: _typoMessage,
            'null': '$didNotImplement addHello?',
            'Hello Instance of \'Future&lt;String&gt;\'':
                'Looks like you forgot to use the \'await\' keyword!',
            'Hello Instance of \'_Future&lt;String&gt;\'':
                'Looks like you forgot to use the \'await\' keyword!',
          }))
      ..add(_makeReadable(
          testLabel: 'Part 2',
          testResult: await _asyncEquals(
              expected: 'Hello Jean',
              actual: await greetUser(),
              typoKeyword: 'Jean'),
          readableErrors: {
            _typoMessage: _typoMessage,
            'null': '$didNotImplement greetUser?',
            'HelloJean':
                'Looks like you forgot the space between \'Hello\' and \'Jean\'',
            'Hello Instance of \'Future&lt;String&gt;\'':
                'Looks like you forgot to use the \'await\' keyword!',
            'Hello Instance of \'_Future&lt;String&gt;\'':
                'Looks like you forgot to use the \'await\' keyword!',
            '{Closure: (String) =&gt; dynamic from Function \'addHello\': static.(await fetchUsername())}':
                'Did you place the \'\$\' character correctly?',
            '{Closure \'addHello\'(await fetchUsername())}':
                'Did you place the \'\$\' character correctly?',
          }))
      ..add(_makeReadable(
          testLabel: 'Part 3',
          testResult: await _asyncDidCatchException(sayGoodbye),
          readableErrors: {
            _typoMessage:
                '$_typoMessage. Did you add the text \'Thanks, see you next time\'?',
            'null': '$didNotImplement sayGoodbye?',
            _noCatch:
                'Did you remember to call logoutUser within a try/catch block?',
            'Instance of \'Future&lt;String&gt;\' Thanks, see you next time':
                'Did you remember to use the \'await\' keyword in the sayGoodbye function?',
            'Instance of \'_Future&lt;String&gt;\' Thanks, see you next time':
                'Did you remember to use the \'await\' keyword in the sayGoodbye function?',
          }))
      ..add(_makeReadable(
          testLabel: 'Part 3',
          testResult: await _asyncEquals(
              expected: 'Success! Thanks, see you next time',
              actual: await sayGoodbye(),
              typoKeyword: 'Success'),
          readableErrors: {
            _typoMessage:
                '$_typoMessage. Did you add the text \'Thanks, see you next time\'?',
            'null': '$didNotImplement sayGoodbye?',
            _noCatch:
                'Did you remember to call logoutUser within a try/catch block?',
            'Instance of \'Future&lt;String&gt;\' Thanks, see you next time':
                'Did you remember to use the \'await\' keyword in the sayGoodbye function?',
            'Instance of \'_Future&lt;String&gt;\' Thanks, see you next time':
                'Did you remember to use the \'await\' keyword in the sayGoodbye function?',
            'Instance of \'_Exception\'':
                'CAUGHT Did you remember to return a string?',
          }))
      ..removeWhere((m) =&gt; m.contains(_passed))
      ..toList();

    if (messages.isEmpty) {
      print('Success. All tests passed!');
    } else {
      messages.forEach(print);
    }
  } catch (e) {
    print('Tried to run solution, but received an exception: $e');
  }
}

// Test helpers.
String _makeReadable({
  required String testResult,
  required Map&lt;String, String&gt; readableErrors,
  required String testLabel,
}) {
  String? readable;
  if (readableErrors.containsKey(testResult)) {
    readable = readableErrors[testResult];
    return '$testLabel $readable';
  } else if ((testResult != _passed) &amp;&amp; (testResult.length &lt; 18)) {
    readable = _typoMessage;
    return '$testLabel $readable';
  } else {
    return '$testLabel $testResult';
  }
}

Future&lt;String&gt; _asyncEquals({
  required String expected,
  required dynamic actual,
  required String typoKeyword,
}) async {
  final strActual = actual is String ? actual : actual.toString();
  try {
    if (expected == actual) {
      return _passed;
    } else if (strActual.contains(typoKeyword)) {
      return _typoMessage;
    } else {
      return strActual;
    }
  } catch (e) {
    return e.toString();
  }
}

Future&lt;String&gt; _asyncDidCatchException(Function fn) async {
  var caught = true;
  try {
    await fn();
  } on Exception catch (_) {
    caught = false;
  }

  if (caught == true) {
    return _passed;
  } else {
    return _noCatch;
  }
}

const _typoMessage = 'Test failed! Check for typos in your return value';
const _passed = 'PASSED';
const _noCatch = 'NO_CATCH';
const _halfSecond = Duration(milliseconds: 500);

String _failOnce() {
  if (_logoutSucceeds) {
    return 'Success!';
  } else {
    _logoutSucceeds = true;
    throw Exception('Logout failed');
  }
}

bool _logoutSucceeds = false;
</code></pre><details><summary title="Expand for a hint on the 'Putting it all together' exercise.">Hint</summary><p>The <code>greetUser</code> and <code>sayGoodbye</code> functions should be asynchronous, while <code>addHello</code> should be a normal, synchronous function.</p><p>Remember: You can use a <a href="../../language/error-handling.html#catch">try-catch statement</a> to catch and handle errors.</p></details><details><summary title="Expand for the solution of the 'Putting it all together' exercise.">Solution</summary><div class="code-block-wrapper language-dart"><div class="code-block-body"><span class="code-block-language" title="Language dart">dart</span><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#0468D7">String</span><span style="color:#6200EE"> addHello</span><span style="color:#222222">(</span><span style="color:#0468D7">String</span><span style="color:#222222"> user) => </span><span style="color:#11796D">'Hello </span><span style="color:#11796D">$</span><span style="color:#222222">user</span><span style="color:#11796D">'</span><span style="color:#222222">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#0468D7">Future</span><span style="color:#222222">&#x3C;</span><span style="color:#0468D7">String</span><span style="color:#222222">> </span><span style="color:#6200EE">greetUser</span><span style="color:#222222">() </span><span style="color:#D43324">async</span><span style="color:#222222"> {</span></span>
<span class="line"><span style="color:#D43324">  final</span><span style="color:#222222"> username = </span><span style="color:#D43324">await</span><span style="color:#6200EE"> fetchUsername</span><span style="color:#222222">();</span></span>
<span class="line"><span style="color:#D43324">  return</span><span style="color:#6200EE"> addHello</span><span style="color:#222222">(username);</span></span>
<span class="line"><span style="color:#222222">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#0468D7">Future</span><span style="color:#222222">&#x3C;</span><span style="color:#0468D7">String</span><span style="color:#222222">> </span><span style="color:#6200EE">sayGoodbye</span><span style="color:#222222">() </span><span style="color:#D43324">async</span><span style="color:#222222"> {</span></span>
<span class="line"><span style="color:#D43324">  try</span><span style="color:#222222"> {</span></span>
<span class="line"><span style="color:#D43324">    final</span><span style="color:#222222"> result = </span><span style="color:#D43324">await</span><span style="color:#6200EE"> logoutUser</span><span style="color:#222222">();</span></span>
<span class="line"><span style="color:#D43324">    return</span><span style="color:#11796D"> '</span><span style="color:#11796D">$</span><span style="color:#222222">result</span><span style="color:#11796D"> Thanks, see you next time'</span><span style="color:#222222">;</span></span>
<span class="line"><span style="color:#222222">  } </span><span style="color:#D43324">catch</span><span style="color:#222222"> (e) {</span></span>
<span class="line"><span style="color:#D43324">    return</span><span style="color:#11796D"> 'Failed to logout user: </span><span style="color:#11796D">$</span><span style="color:#222222">e</span><span style="color:#11796D">'</span><span style="color:#222222">;</span></span>
<span class="line"><span style="color:#222222">  }</span></span>
<span class="line"><span style="color:#222222">}</span></span></code></pre></div></div></details><div class="header-wrapper"><h2 id="which-lints-work-for-futures">Which lints work for futures?</h2><a class="heading-link" href="#which-lints-work-for-futures" aria-label="Link to 'Which lints work for futures?' section">#</a></div><p>To catch common mistakes that arise while working with async and futures, <a href="../../tools/analysis.html#individual-rules">enable</a> the following lints:</p><ul><li><a href="../../tools/linter-rules/discarded_futures.html"><code>discarded_futures</code></a></li><li><a href="../../tools/linter-rules/unawaited_futures.html"><code>unawaited_futures</code></a></li></ul><div class="header-wrapper"><h2 id="whats-next">What's next?</h2><a class="heading-link" href="#whats-next" aria-label="Link to 'What's next?' section">#</a></div><p>Congratulations, you've finished the tutorial! If you'd like to learn more, here are some suggestions for where to go next:</p><ul><li>Play with <a href="https://dartpad.dev/">DartPad</a>.</li><li>Try another <a href="../../tutorials.html">tutorial</a>.</li><li>Learn more about futures and asynchronous code in Dart:<ul><li><a href="using-streams.html">Streams tutorial</a>: Learn how to work with a sequence of asynchronous events.</li><li><a href="../../language/concurrency.html">Concurrency in Dart</a>: Understand and learn how to implement concurrency in Dart.</li><li><a href="../../language/async.html">Asynchrony support</a>: Dive in to Dart's language and library support for asynchronous coding.</li><li><a href="https://www.youtube.com/playlist?list=PLjxrf2q8roU0Net_g1NT5_vOO3s_FR02J">Dart videos from Google</a>: Watch one or more of the videos about asynchronous coding.</li></ul></li><li>Get the <a href="../../get-dart.html">Dart SDK</a>!</li></ul><p id="page-github-links"><span>Unless stated otherwise, the documentation on this site reflects Dart 3.6.0. Page last updated on 2024-11-17.</span> <a href="https://github.com/dart-lang/site-www/tree/main/src/content/libraries/async/async-await.md" target="_blank" rel="noopener">View source</a> <span>or </span><a href="https://github.com/dart-lang/site-www/issues/new?template=1_page_issue.yml&amp;page-url=https://dart.dev/libraries/async/async-await/&amp;page-source=https://github.com/dart-lang/site-www/tree/main/src/content/libraries/async/async-await.md" title="Report an issue with this page" target="_blank" rel="noopener">report an issue</a>.</p></div></article></main><footer id="page-footer"><div class="footer-section footer-main"><a href="../../index.html" class="brand" title="Dart"><img src="../../assets/img/logo/logo-white-text.svg" alt="Dart" width="164"></a><div class="footer-social-links"><a href="https://medium.com/dartlang" target="_blank" rel="noopener" title="Medium blog"><svg><use href="../../assets/img/social/medium.svg#medium"></use></svg> </a><a href="https://github.com/dart-lang" target="_blank" rel="noopener" title="GitHub"><svg><use href="../../assets/img/social/github.svg#github"></use></svg> </a><a href="https://twitter.com/dart_lang" target="_blank" rel="noopener" title="X (Twitter)"><svg><use href="../../assets/img/social/x.svg#x"></use></svg></a></div></div><div class="footer-section footer-tray"><div class="footer-licenses">Except as otherwise noted, this site is licensed under a <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>, and code samples are licensed under the <a href="https://opensource.org/licenses/BSD-3-Clause">3-Clause BSD License</a>.</div><div class="footer-utility-links"><ul><li><a href="../../terms.html" title="Terms of use">Terms</a></li><li><a href="https://policies.google.com/privacy" target="_blank" rel="noopener" title="Privacy policy">Privacy</a></li><li><a href="../../security.html" title="Security philosophy and practices">Security</a></li></ul></div></div></footer></body>
<!-- Mirrored from dart.dev/libraries/async/async-await by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Dec 2024 22:14:25 GMT -->
</html>