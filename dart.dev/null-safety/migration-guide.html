<!doctype html><html lang="en">
<!-- Mirrored from dart.dev/null-safety/migration-guide by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Dec 2024 22:14:20 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><script>!function(e,t,a,n){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var g=t.getElementsByTagName(a)[0],m=t.createElement(a);m.async=!0,m.src="../../www.googletagmanager.com/gtm4a44.js?id=GTM-5VSZM5J",g.parentNode.insertBefore(m,g)}(window,document,"script","dataLayer")</script><meta name="description" content="How to move your existing Dart code to the world of null safety"><title>Migrating to null safety | Dart</title><link rel="icon" sizes="64x64" href="../assets/img/logo/dart-64.png" eleventy:ignore><link href="../assets/img/touch-icon-iphone.png" rel="apple-touch-icon" eleventy:ignore><link href="../assets/img/touch-icon-ipad.png" rel="apple-touch-icon" sizes="152x152" eleventy:ignore><link href="../assets/img/touch-icon-iphone-retina.png" rel="apple-touch-icon" sizes="180x180" eleventy:ignore><link href="../assets/img/touch-icon-ipad-retina.png" rel="apple-touch-icon" sizes="167x167" eleventy:ignore><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@dart_lang"><meta name="twitter:title" content="Migrating to null safety"><meta name="twitter:description" content="How to move your existing Dart code to the world of null safety"><meta property="og:title" content="Migrating to null safety"><meta property="og:description" content="How to move your existing Dart code to the world of null safety"><meta property="og:url" content="/null-safety/migration-guide/"><meta property="og:image" content="/assets/img/logo/dart-logo-for-shares.png?2" eleventy:ignore><link rel="preconnect" href="https://fonts.googleapis.com/"><link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin><link href="https://fonts.googleapis.com/css2?family=Google+Sans:wght@400;500;700&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Google+Sans+Display:wght@400&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Google+Sans+Mono:wght@400;500;700&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Google+Sans+Text:wght@400;500;700&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" rel="stylesheet"><link rel="stylesheet" href="../assets/css/main.css"><script src="../../cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js" integrity="sha512-3gJwYpMe3QewGELv8k/BX9vcqhryRdzRMxVfq6ngyWXwo03GFEzjsUm8Q7RZcHPHksttq7/GFoxjCVUjkjvPdw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="../../cdnjs.cloudflare.com/ajax/libs/bootstrap/4.6.2/js/bootstrap.min.js" integrity="sha384-+sLIOodYLS7CIrQpBjl+C7nPvqq+FbNUBDunl/OZv93DB7Ln/533i8e/mZXLi/P+" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="../../cdnjs.cloudflare.com/ajax/libs/js-cookie/3.0.5/js.cookie.min.js" integrity="sha512-nlp9/l96/EpjYBx7EP7pGASVXNe80hGhYAUrjeXnu/fyF5Py0/RXav4BBNs7n5Hx1WFhOEOWSAVjGeC3oKxDVQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="../assets/js/os-tabs.js"></script><script src="../assets/js/utilities.js"></script><script src="../assets/js/main.js"></script><script>!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src="../../www.google-analytics.com/analytics.js",s.parentNode.insertBefore(o,s)}(window,document,"script",0,"ga"),ga("create","UA-26406144-4","auto"),ga("send","pageview")</script></head><body class="default.html show_banner"><a id="skip" href="#site-content-title">Skip to main content</a><section id="cookie-notice"><div class="container"><p>dart.dev uses cookies from Google to deliver and enhance the quality of its services and to analyze traffic. <a href="https://policies.google.com/technologies/cookies" target="_blank" rel="noopener">Learn more</a>.</p><button id="cookie-consent" class="btn btn-primary">OK, got it</button></div></section><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5VSZM5J" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><header id="page-header" class="site-header"><nav id="mainnav" class="site-header"><div id="menu-toggle"><i class="material-symbols">menu</i></div><a href="../index.html" class="brand" title="Dart"><img src="../assets/img/logo/logo-white-text.svg" alt="Dart"></a><ul class="navbar"><li><a href="../overview.html" class="nav-link">Overview</a></li><li class="mainnav__get-started"><a href="../guides.html" class="nav-link"><span>Docs</span></a></li><li><a href="../community.html" class="nav-link">Community</a></li><li><a href="../index.html#try-dart" class="nav-link">Try Dart</a></li><li><a href="../get-dart.html" class="nav-link">Get Dart</a></li><li class="searchfield"><form action="https://dart.dev/search" class="site-header__search form-inline" id="cse-search-box"><input type="hidden" name="cx" value="011220921317074318178:_yy-tmb5t_i"> <input type="hidden" name="ie" value="UTF-8"> <input type="hidden" name="hl" value="en"> <input class="site-header__searchfield form-control search-field" type="search" name="q" id="search-main" autocomplete="off" placeholder="Search" aria-label="Search"></form></li></ul></nav></header><div class="banner"><p class="banner__text">Dart 3.6 is here! Read the <a href="https://medium.com/dartlang/announcing-dart-3-6-778dd7a80983" target="_blank">blog post</a> to learn about new features in pub and the language.</p></div><div id="sidenav"><form action="https://dart.dev/search/" class="site-header__search form-inline"><input class="site-header__searchfield form-control search-field" type="search" name="q" id="search-side" autocomplete="off" placeholder="Search" aria-label="Search"></form><div class="site-sidebar"><ul class="navbar-nav"><li class="nav-item"><a href="../overview.html" class="nav-link">Overview</a></li><li class="nav-item"><a href="../community.html" class="nav-link">Community</a></li><li class="nav-item"><a href="https://dartpad.dev/" class="nav-link">Try Dart</a></li><li class="nav-item"><a href="../get-dart.html" class="nav-link">Get Dart</a></li><li class="nav-item"><a href="../guides.html" class="nav-link">Docs</a></li><li aria-hidden="true"><div class="sidebar-primary-divider"></div></li></ul><ul class="nav flex-column"><li class="nav-item"><a class="nav-link active collapsible" data-toggle="collapse" href="#sidenav-1" role="button" aria-expanded="true" aria-controls="sidenav-1">Language</a><ul class="nav flex-column flex-nowrap collapse show" id="sidenav-1"><li class="nav-item"><a class="nav-link" href="../language.html">Introduction</a></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-1-2" href="#sidenav-1-2" role="button" aria-expanded="false" aria-controls="sidenav-1-2">Syntax basics</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-1-2"><li class="nav-item"><a class="nav-link" href="../language/variables.html">Variables</a></li><li class="nav-item"><a class="nav-link" href="../language/operators.html">Operators</a></li><li class="nav-item"><a class="nav-link" href="../language/comments.html">Comments</a></li><li class="nav-item"><a class="nav-link" href="../language/metadata.html">Metadata</a></li><li class="nav-item"><a class="nav-link" href="../language/libraries.html">Libraries & imports</a></li><li class="nav-item"><a class="nav-link" href="../language/keywords.html">Keywords</a></li></ul></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-1-3" href="#sidenav-1-3" role="button" aria-expanded="false" aria-controls="sidenav-1-3">Types</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-1-3"><li class="nav-item"><a class="nav-link" href="../language/built-in-types.html">Built-in types</a></li><li class="nav-item"><a class="nav-link" href="../language/records.html">Records</a></li><li class="nav-item"><a class="nav-link" href="../language/collections.html">Collections</a></li><li class="nav-item"><a class="nav-link" href="../language/generics.html">Generics</a></li><li class="nav-item"><a class="nav-link" href="../language/typedefs.html">Typedefs</a></li><li class="nav-item"><a class="nav-link" href="../language/type-system.html">Type system</a></li></ul></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-1-4" href="#sidenav-1-4" role="button" aria-expanded="false" aria-controls="sidenav-1-4">Patterns</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-1-4"><li class="nav-item"><a class="nav-link" href="../language/patterns.html">Overview & usage</a></li><li class="nav-item"><a class="nav-link" href="../language/pattern-types.html">Pattern types</a></li><li class="nav-item"><a class="nav-link" href="https://codelabs.developers.google.com/codelabs/dart-patterns-records" target="_blank" rel="noopener">Applied tutorial</a></li></ul></li><li class="nav-item"><a class="nav-link" href="../language/functions.html">Functions</a></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-1-6" href="#sidenav-1-6" role="button" aria-expanded="false" aria-controls="sidenav-1-6">Control flow</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-1-6"><li class="nav-item"><a class="nav-link" href="../language/loops.html">Loops</a></li><li class="nav-item"><a class="nav-link" href="../language/branches.html">Branches</a></li><li class="nav-item"><a class="nav-link" href="../language/error-handling.html">Error handling</a></li></ul></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-1-7" href="#sidenav-1-7" role="button" aria-expanded="false" aria-controls="sidenav-1-7">Classes & objects</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-1-7"><li class="nav-item"><a class="nav-link" href="../language/classes.html">Classes</a></li><li class="nav-item"><a class="nav-link" href="../language/constructors.html">Constructors</a></li><li class="nav-item"><a class="nav-link" href="../language/methods.html">Methods</a></li><li class="nav-item"><a class="nav-link" href="../language/extend.html">Extend a class</a></li><li class="nav-item"><a class="nav-link" href="../language/mixins.html">Mixins</a></li><li class="nav-item"><a class="nav-link" href="../language/enums.html">Enums</a></li><li class="nav-item"><a class="nav-link" href="../language/extension-methods.html">Extension methods</a></li><li class="nav-item"><a class="nav-link" href="../language/extension-types.html">Extension types</a></li><li class="nav-item"><a class="nav-link" href="../language/callable-objects.html">Callable objects</a></li></ul></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-1-8" href="#sidenav-1-8" role="button" aria-expanded="false" aria-controls="sidenav-1-8">Class modifiers</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-1-8"><li class="nav-item"><a class="nav-link" href="../language/class-modifiers.html">Overview & usage</a></li><li class="nav-item"><a class="nav-link" href="../language/class-modifiers-for-apis.html">Class modifiers for API maintainers</a></li><li class="nav-item"><a class="nav-link" href="../language/modifier-reference.html">Reference</a></li></ul></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-1-9" href="#sidenav-1-9" role="button" aria-expanded="false" aria-controls="sidenav-1-9">Concurrency</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-1-9"><li class="nav-item"><a class="nav-link" href="../language/concurrency.html">Overview</a></li><li class="nav-item"><a class="nav-link" href="../language/async.html">Asynchronous support</a></li><li class="nav-item"><a class="nav-link" href="../language/isolates.html">Isolates</a></li></ul></li><li class="nav-item"><a class="nav-link active collapsible" data-toggle="collapse" data-target="#sidenav-1-10" href="#sidenav-1-10" role="button" aria-expanded="true" aria-controls="sidenav-1-10">Null safety</a><ul class="nav flex-column flex-nowrap collapse show" id="sidenav-1-10"><li class="nav-item"><a class="nav-link" href="../null-safety.html">Sound null safety</a></li><li class="nav-item"><a class="nav-link active" href="migration-guide.html">Migrating to null safety</a></li><li class="nav-item"><a class="nav-link" href="understanding-null-safety.html">Understanding null safety</a></li><li class="nav-item"><a class="nav-link" href="unsound-null-safety.html">Unsound null safety</a></li><li class="nav-item"><a class="nav-link" href="faq.html">FAQ</a></li></ul></li></ul></li><li class="nav-item"><a class="nav-link collapsed collapsible" data-toggle="collapse" href="#sidenav-2" role="button" aria-expanded="false" aria-controls="sidenav-2">Core libraries</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-2"><li class="nav-item"><a class="nav-link" href="../libraries.html">Overview</a></li><li class="nav-item"><a class="nav-link" href="../libraries/dart-core.html">dart:core</a></li><li class="nav-item"><a class="nav-link" href="../libraries/dart-async.html">dart:async</a></li><li class="nav-item"><a class="nav-link" href="../libraries/dart-math.html">dart:math</a></li><li class="nav-item"><a class="nav-link" href="../libraries/dart-convert.html">dart:convert</a></li><li class="nav-item"><a class="nav-link" href="../libraries/dart-io.html">dart:io</a></li><li class="nav-item"><a class="nav-link" href="../libraries/dart-html.html">dart:html</a></li><div class="dropdown-divider"></div><li class="nav-item"><a class="nav-link" href="../libraries/collections/iterables.html">Iterable collections</a></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-2-10" href="#sidenav-2-10" role="button" aria-expanded="false" aria-controls="sidenav-2-10">Asynchronous programming</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-2-10"><li class="nav-item"><a class="nav-link" href="../libraries/async/async-await.html">Tutorial</a></li><li class="nav-item"><a class="nav-link" href="../libraries/async/futures-error-handling.html">Futures and error handling</a></li><li class="nav-item"><a class="nav-link" href="../libraries/async/using-streams.html">Using streams</a></li><li class="nav-item"><a class="nav-link" href="../libraries/async/creating-streams.html">Creating streams</a></li></ul></li></ul></li><li class="nav-item"><a class="nav-link collapsed collapsible" data-toggle="collapse" href="#sidenav-3" role="button" aria-expanded="false" aria-controls="sidenav-3">Effective Dart</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-3"><li class="nav-item"><a class="nav-link" href="../effective-dart.html">Overview</a></li><li class="nav-item"><a class="nav-link" href="../effective-dart/style.html">Style</a></li><li class="nav-item"><a class="nav-link" href="../effective-dart/documentation.html">Documentation</a></li><li class="nav-item"><a class="nav-link" href="../effective-dart/usage.html">Usage</a></li><li class="nav-item"><a class="nav-link" href="../effective-dart/design.html">Design</a></li></ul></li><li class="nav-item"><a class="nav-link collapsed collapsible" data-toggle="collapse" href="#sidenav-4" role="button" aria-expanded="false" aria-controls="sidenav-4">Packages</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-4"><li class="nav-item"><a class="nav-link" href="../tools/pub/packages.html">How to use packages</a></li><li class="nav-item"><a class="nav-link" href="../resources/useful-packages.html">Commonly used packages</a></li><li class="nav-item"><a class="nav-link" href="../tools/pub/create-packages.html">Creating packages</a></li><li class="nav-item"><a class="nav-link" href="../tools/pub/publishing.html">Publishing packages</a></li><li class="nav-item"><a class="nav-link" href="../tools/pub/writing-package-pages.html">Writing package pages</a></li><li class="nav-item"><a class="nav-link" href="../tools/pub/workspaces.html">Workspaces (monorepo support)</a></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-4-7" href="#sidenav-4-7" role="button" aria-expanded="false" aria-controls="sidenav-4-7">Package reference</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-4-7"><li class="nav-item"><a class="nav-link" href="../tools/pub/dependencies.html">Dependencies</a></li><li class="nav-item"><a class="nav-link" href="../tools/pub/glossary.html">Glossary</a></li><li class="nav-item"><a class="nav-link" href="../tools/pub/package-layout.html">Package layout conventions</a></li><li class="nav-item"><a class="nav-link" href="../tools/pub/environment-variables.html">Pub environment variables</a></li><li class="nav-item"><a class="nav-link" href="../tools/pub/pubspec.html">Pubspec file</a></li><li class="nav-item"><a class="nav-link" href="../tools/pub/troubleshoot.html">Troubleshooting pub</a></li><li class="nav-item"><a class="nav-link" href="../tools/pub/verified-publishers.html">Verified publishers</a></li><li class="nav-item"><a class="nav-link" href="../tools/pub/security-advisories.html">Security advisories</a></li><li class="nav-item"><a class="nav-link" href="../tools/pub/versioning.html">Versioning</a></li><li class="nav-item"><a class="nav-link" href="../tools/pub/custom-package-repositories.html">Custom package repositories</a></li></ul></li><li class="nav-item"><a class="nav-link" href="../tools/pub/private-files.html">What not to commit</a></li></ul></li><li class="nav-item"><a class="nav-link collapsed collapsible" data-toggle="collapse" href="#sidenav-5" role="button" aria-expanded="false" aria-controls="sidenav-5">Development</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-5"><li class="nav-item"><a class="nav-link" href="../guides/json.html">JSON</a></li><li class="nav-item"><a class="nav-link" href="../resources/language/number-representation.html">Number representation</a></li><li class="nav-item"><a class="nav-link" href="../resources/google-apis.html">Google APIs</a></li><li class="nav-item"><a class="nav-link" href="../multiplatform-apps.html">Multi-platform apps</a></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-5-5" href="#sidenav-5-5" role="button" aria-expanded="false" aria-controls="sidenav-5-5">Command-line & server apps</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-5-5"><li class="nav-item"><a class="nav-link" href="../server.html">Overview</a></li><li class="nav-item"><a class="nav-link" href="../tutorials/server/get-started.html">Get started</a></li><li class="nav-item"><a class="nav-link" href="../tutorials/server/cmdline.html">Write command-line apps</a></li><li class="nav-item"><a class="nav-link" href="../tutorials/server/fetch-data.html">Fetch data from the internet</a></li><li class="nav-item"><a class="nav-link" href="../tutorials/server/httpserver.html">Write HTTP servers</a></li><li class="nav-item"><a class="nav-link" href="../server/libraries.html">Libraries & packages</a></li><li class="nav-item"><a class="nav-link" href="../server/google-cloud.html">Google Cloud</a></li></ul></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-5-6" href="#sidenav-5-6" role="button" aria-expanded="false" aria-controls="sidenav-5-6">Web apps</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-5-6"><li class="nav-item"><a class="nav-link" href="../web.html">Overview</a></li><li class="nav-item"><a class="nav-link" href="../web/get-started.html">Get started</a></li><li class="nav-item"><a class="nav-link" href="../web/deployment.html">Deployment</a></li><li class="nav-item"><a class="nav-link" href="../web/libraries.html">Libraries & packages</a></li><li class="nav-item"><a class="nav-link" href="../web/wasm.html">Wasm compilation</a></li></ul></li><li class="nav-item"><a class="nav-link" href="../guides/environment-declarations.html">Environment declarations</a></li></ul></li><li class="nav-item"><a class="nav-link collapsed collapsible" data-toggle="collapse" href="#sidenav-6" role="button" aria-expanded="false" aria-controls="sidenav-6">Interoperability</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-6"><li class="nav-item"><a class="nav-link" href="../interop/c-interop.html">C interop</a></li><li class="nav-item"><a class="nav-link" href="../interop/objective-c-interop.html">Objective-C & Swift interop</a></li><li class="nav-item"><a class="nav-link" href="../interop/java-interop.html">Java & Kotlin interop</a></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-6-4" href="#sidenav-6-4" role="button" aria-expanded="false" aria-controls="sidenav-6-4">JavaScript interop</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-6-4"><li class="nav-item"><a class="nav-link" href="../interop/js-interop.html">Overview</a></li><li class="nav-item"><a class="nav-link" href="../interop/js-interop/usage.html">Usage</a></li><li class="nav-item"><a class="nav-link" href="../interop/js-interop/js-types.html">JS types</a></li><li class="nav-item"><a class="nav-link" href="../interop/js-interop/tutorials.html">Tutorials</a></li><li class="nav-item"><a class="nav-link" href="../interop/js-interop/past-js-interop.html">Past JS interop</a></li><div class="dropdown-divider"></div><li class="nav-item"><a class="nav-link" href="../interop/js-interop/package-web.html">Web interop</a></li></ul></li></ul></li><li class="nav-item"><a class="nav-link collapsed collapsible" data-toggle="collapse" href="#sidenav-7" role="button" aria-expanded="false" aria-controls="sidenav-7">Tools & techniques</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-7"><li class="nav-item"><a class="nav-link" href="../tools.html">Overview</a></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-7-2" href="#sidenav-7-2" role="button" aria-expanded="false" aria-controls="sidenav-7-2">Editors & debuggers</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-7-2"><li class="nav-item"><a class="nav-link" href="../tools/jetbrains-plugin.html">IntelliJ & Android Studio</a></li><li class="nav-item"><a class="nav-link" href="../tools/vs-code.html">VS Code</a></li><li class="nav-item"><a class="nav-link" href="../tools/dart-devtools.html">Dart DevTools</a></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-7-2-4" href="#sidenav-7-2-4" role="button" aria-expanded="false" aria-controls="sidenav-7-2-4">DartPad</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-7-2-4"><li class="nav-item"><a class="nav-link" href="../tools/dartpad.html">Overview</a></li><li class="nav-item"><a class="nav-link" href="../tools/dartpad/troubleshoot.html">Troubleshooting DartPad</a></li></ul></li></ul></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-7-3" href="#sidenav-7-3" role="button" aria-expanded="false" aria-controls="sidenav-7-3">Command-line tools</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-7-3"><li class="nav-item"><a class="nav-link collapsible" data-toggle="collapse" data-target="#sidenav-7-3-1" href="#sidenav-7-3-1" role="button" aria-expanded="true" aria-controls="sidenav-7-3-1">Dart SDK</a><ul class="nav flex-column flex-nowrap collapse show" id="sidenav-7-3-1"><li class="nav-item"><a class="nav-link" href="../tools/sdk.html">Overview</a></li><li class="nav-item"><a class="nav-link" href="../tools/dart-tool.html">dart</a></li><li class="nav-item"><a class="nav-link" href="../tools/dart-analyze.html">dart analyze</a></li><li class="nav-item"><a class="nav-link" href="../tools/dart-compile.html">dart compile</a></li><li class="nav-item"><a class="nav-link" href="../tools/dart-create.html">dart create</a></li><li class="nav-item"><a class="nav-link" href="../tools/dart-doc.html">dart doc</a></li><li class="nav-item"><a class="nav-link" href="../tools/dart-fix.html">dart fix</a></li><li class="nav-item"><a class="nav-link" href="../tools/dart-format.html">dart format</a></li><li class="nav-item"><a class="nav-link" href="../tools/dart-info.html">dart info</a></li><li class="nav-item"><a class="nav-link" href="../tools/pub/cmd.html">dart pub</a></li><li class="nav-item"><a class="nav-link" href="../tools/dart-run.html">dart run</a></li><li class="nav-item"><a class="nav-link" href="../tools/dart-test.html">dart test</a></li><li class="nav-item"><a class="nav-link" href="../tools/dartaotruntime.html">dartaotruntime</a></li><li class="nav-item"><a class="nav-link" href="../tools/experiment-flags.html">Experiment flags</a></li></ul></li><li class="nav-item"><a class="nav-link collapsible" data-toggle="collapse" data-target="#sidenav-7-3-2" href="#sidenav-7-3-2" role="button" aria-expanded="true" aria-controls="sidenav-7-3-2">Other command-line tools</a><ul class="nav flex-column flex-nowrap collapse show" id="sidenav-7-3-2"><li class="nav-item"><a class="nav-link" href="../tools/build_runner.html">build_runner</a></li><li class="nav-item"><a class="nav-link" href="../tools/webdev.html">webdev</a></li></ul></li></ul></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-7-4" href="#sidenav-7-4" role="button" aria-expanded="false" aria-controls="sidenav-7-4">Static analysis</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-7-4"><li class="nav-item"><a class="nav-link" href="../tools/analysis.html">Customizing static analysis</a></li><li class="nav-item"><a class="nav-link" href="../deprecated/sound-problems.html">Fixing common type problems</a></li><li class="nav-item"><a class="nav-link" href="../tools/non-promotion-reasons.html">Fixing type promotion failures</a></li><li class="nav-item"><a class="nav-link" href="../tools/linter-rules.html">Linter rules</a></li><li class="nav-item"><a class="nav-link" href="../tools/diagnostic-messages.html">Diagnostic messages</a></li></ul></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-7-5" href="#sidenav-7-5" role="button" aria-expanded="false" aria-controls="sidenav-7-5">Testing & optimization</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-7-5"><li class="nav-item"><a class="nav-link" href="../guides/testing.html">Testing</a></li><li class="nav-item"><a class="nav-link" href="../web/debugging.html">Debugging web apps</a></li></ul></li></ul></li><li aria-hidden="true"><div class="sidebar-primary-divider"></div></li><li class="nav-item"><a class="nav-link collapsed collapsible" data-toggle="collapse" href="#sidenav-9" role="button" aria-expanded="false" aria-controls="sidenav-9">Resources</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-9"><li class="nav-item"><a class="nav-link" href="../resources/dart-cheatsheet.html">Language cheatsheet</a></li><li class="nav-item"><a class="nav-link" href="../resources/breaking-changes.html">Breaking changes</a></li><li class="nav-item"><a class="nav-link" href="../resources/language/evolution.html">Language evolution</a></li><li class="nav-item"><a class="nav-link" href="../resources/language/spec.html">Language specification</a></li><li class="nav-item"><a class="nav-link" href="../resources/dart-3-migration.html">Dart 3 migration guide</a></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-9-6" href="#sidenav-9-6" role="button" aria-expanded="false" aria-controls="sidenav-9-6">Coming from ...</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-9-6"><li class="nav-item"><a class="nav-link" href="../resources/coming-from/js-to-dart.html">JavaScript to Dart</a></li><li class="nav-item"><a class="nav-link" href="../resources/coming-from/swift-to-dart.html">Swift to Dart</a></li></ul></li><div class="dropdown-divider"></div><li class="nav-item"><a class="nav-link" href="../resources/faq.html">FAQ</a></li><li class="nav-item"><a class="nav-link" href="../resources/glossary.html">Glossary</a></li><li class="nav-item"><a class="nav-link" href="../resources/books.html">Books</a></li><li class="nav-item"><a class="nav-link" href="../resources/videos.html">Videos</a></li><li class="nav-item"><a class="nav-link" href="../tutorials.html">Tutorials</a></li></ul></li><li class="nav-item"><a class="nav-link collapsible" data-toggle="collapse" href="#sidenav-10" role="button" aria-expanded="true" aria-controls="sidenav-10">Related sites</a><ul class="nav flex-column flex-nowrap collapse show" id="sidenav-10"><li class="nav-item"><a class="nav-link" href="https://api.dart.dev/" target="_blank" rel="noopener">API reference</a></li><li class="nav-item"><a class="nav-link" href="https://medium.com/dartlang" target="_blank" rel="noopener">Blog</a></li><li class="nav-item"><a class="nav-link" href="https://dartpad.dev/" target="_blank" rel="noopener">DartPad (online editor)</a></li><li class="nav-item"><a class="nav-link" href="https://flutter.dev/" target="_blank" rel="noopener">Flutter</a></li><li class="nav-item"><a class="nav-link" href="https://pub.dev/" target="_blank" rel="noopener">Package site</a></li></ul></li></ul></div></div><main id="page-content"><div id="site-toc--side" class="site-toc"><header class="site-toc__title">Contents</header><ul class="section-nav"><li class="toc-entry nav-item"><a class="nav-link" href="#step1-wait">1. Wait to migrate</a><ul class="nav"><li class="toc-entry nav-item"><a class="nav-link" href="#switch-to-the-dart-2-19-6-release">Switch to the Dart 2.19.6 release</a></li><li class="toc-entry nav-item"><a class="nav-link" href="#check-dependency-status">Check dependency status</a></li><li class="toc-entry nav-item"><a class="nav-link" href="#update-dependencies">Update dependencies</a></li></ul></li><li class="toc-entry nav-item"><a class="nav-link" href="#step2-migrate">2. Migrate</a><ul class="nav"><li class="toc-entry nav-item"><a class="nav-link" href="#migration-tool">Using the migration tool</a></li><li class="toc-entry nav-item"><a class="nav-link" href="#migrating-by-hand">Migrating by hand</a></li></ul></li><li class="toc-entry nav-item"><a class="nav-link" href="#step3-analyze">3. Analyze</a></li><li class="toc-entry nav-item"><a class="nav-link" href="#step4-test">4. Test</a></li><li class="toc-entry nav-item"><a class="nav-link" href="#step5-publish">5. Publish</a><ul class="nav"><li class="toc-entry nav-item"><a class="nav-link" href="#package-version">Update the package version</a></li><li class="toc-entry nav-item"><a class="nav-link" href="#check-your-pubspec">Check your pubspec</a></li></ul></li><li class="toc-entry nav-item"><a class="nav-link" href="#welcome-to-null-safety">Welcome to null safety</a></li></ul></div><article><div class="content"><div id="site-content-title"><h1>Migrating to null safety</h1></div><div id="site-toc--inline" class="site-toc toc-collapsible toc-collapsed"><header class="site-toc__title">Contents <span class="site-toc--inline__toggle toc-toggle-down"><i class="material-symbols">keyboard_arrow_down</i></span> <span class="site-toc--inline__toggle toc-toggle-up"><i class="material-symbols">keyboard_arrow_up</i></span></header><ul class="section-nav"><li class="toc-entry"><a href="#step1-wait">1. Wait to migrate</a><ul><li class="toc-entry"><a href="#switch-to-the-dart-2-19-6-release">Switch to the Dart 2.19.6 release</a></li><li class="toc-entry"><a href="#check-dependency-status">Check dependency status</a></li><li class="toc-entry"><a href="#update-dependencies">Update dependencies</a></li></ul></li><li class="toc-entry"><a href="#step2-migrate">2. Migrate</a><ul><li class="toc-entry"><a href="#migration-tool">Using the migration tool</a></li><li class="toc-entry"><a href="#migrating-by-hand">Migrating by hand</a></li></ul></li><li class="toc-entry"><a href="#step3-analyze">3. Analyze</a></li><li class="toc-entry"><a href="#step4-test">4. Test</a></li><li class="toc-entry"><a href="#step5-publish">5. Publish</a><ul><li class="toc-entry"><a href="#package-version">Update the package version</a></li><li class="toc-entry"><a href="#check-your-pubspec">Check your pubspec</a></li></ul></li><li class="toc-entry"><a href="#welcome-to-null-safety">Welcome to null safety</a></li></ul><span class="site-toc--inline__toggle toc-toggle-more-items"><i class="material-symbols">more_horiz</i></span></div><aside class="alert alert-info"><div class="alert-header"><i class="material-symbols" aria-hidden="true">merge_type</i> <span>Version note</span></div><div class="alert-content"><p>Dart 2.19 is the final release that supports null-safety migration, including the <code>dart migrate</code> tool. To migrate your package to null safety, use the Dart 2.19.6 SDK. To learn more, see <a href="../null-safety.html#dart-3-and-null-safety">Dart 3 and null safety</a>.</p></div></aside><p>This page describes how and when to migrate your code to <a href="../null-safety.html">null safety</a>. Here are the basic steps for migrating each package that you own:</p><ol><li><a href="#step1-wait"><strong>Wait</strong></a> for the packages that you depend on to migrate.</li><li><a href="#step2-migrate"><strong>Migrate</strong></a> your package's code, preferably using the interactive migration tool.</li><li><a href="#step3-analyze"><strong>Statically analyze</strong></a> your package's code.</li><li><a href="#step4-test"><strong>Test</strong></a> to make sure your changes work.</li><li>If the package is already on pub.dev, <a href="#step5-publish"><strong>publish</strong></a> the null-safe version as a <strong>prerelease</strong> version.</li></ol><aside class="alert alert-success"><div class="alert-header"><i class="material-symbols" aria-hidden="true">lightbulb</i> <span>Tip</span></div><div class="alert-content"><p>If your application or library is large, check out <a href="https://medium.com/dartlang/gradual-null-safety-migration-for-large-dart-projects-85acb10b64a9">Gradual null safety migration for large Dart projects</a>.</p></div></aside><aside class="alert alert-info"><div class="alert-header"><i class="material-symbols" aria-hidden="true">info</i> <span>Note</span></div><div class="alert-content"><p><strong>Migrating an app is technically the same as migrating a package.</strong> Before migrating an app, make sure that all of your dependencies are ready.</p></div></aside><p>To get an informal look at the experience of using the migration tool, watch this video:</p><iframe width="560" height="315" src="https://www.youtube.com/embed/eBr5tlumwlg" title="How to migrate Dart packages to null safety" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen loading="lazy"></iframe><br><p><a href="https://www.youtube.com/watch/eBr5tlumwlg" target="_blank" rel="noopener" title="Open 'How to migrate Dart packages to null safety' video in new tab">How to migrate Dart packages to null safety</a></p><div class="header-wrapper"><h2 id="step1-wait">1. Wait to migrate</h2><a class="heading-link" href="#step1-wait" aria-label="Link to '1. Wait to migrate' section">#</a></div><p>We strongly recommend migrating code in order, with the leaves of the dependency graph being migrated first. For example, if package C depends on package B, which depends on package A, then A should be migrated to null safety first, then B, then C.</p><p><img src="../assets/img/null-safety/null-safety-migration-order.png" alt="Illustration of C/B/A sentence"><br></p><p>Although you <a href="unsound-null-safety.html"><em>can</em> migrate</a> before your dependencies support null safety, you might have to change your code when your dependencies migrate. For example, if you predict that a function will take a nullable parameter but the package migrates it to be non-nullable, then passing a nullable argument becomes a compile error.</p><aside class="alert alert-info"><div class="alert-header"><i class="material-symbols" aria-hidden="true">info</i> <span>Note</span></div><div class="alert-content"><p><strong>You can—and should—migrate your package before packages that depend on it are migrated.</strong> Your null-safe package is usable by packages and apps that don't use null safety yet, as long as they use Dart 2.12 or later. For example, the Dart and Flutter core libraries are null safe, and they're still usable by apps that haven't migrated to null safety.</p></div></aside><p>This section tells you how to check and update your package's dependencies, with the help of the <code>dart pub outdated</code> command in null-safety mode. The instructions assume your code is under <strong>source control</strong>, so that you can easily undo any changes.</p><p><a id="switch-to-the-latest-stable-dart-release"></a></p><div class="header-wrapper"><h3 id="switch-to-the-dart-2-19-6-release">Switch to the Dart 2.19.6 release</h3><a class="heading-link" href="#switch-to-the-dart-2-19-6-release" aria-label="Link to 'Switch to the Dart 2.19.6 release' section">#</a></div><p>Switch to the <strong>2.19.6 release</strong> of the Dart SDK. This is included in the Flutter 3.7.12 SDK.</p><p>Check that you have Dart 2.19.6:</p><div class="code-block-wrapper language-console"><div class="code-block-body"><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#222222">$ dart --version</span></span>
<span class="line"><span style="color:#222222">Dart SDK version: 2.19.6</span></span></code></pre></div></div><div class="header-wrapper"><h3 id="check-dependency-status">Check dependency status</h3><a class="heading-link" href="#check-dependency-status" aria-label="Link to 'Check dependency status' section">#</a></div><p>Get the migration state of your package's dependencies, using the following command:</p><div class="code-block-wrapper language-console"><div class="code-block-body"><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#222222">$ dart pub outdated --mode=</span><span style="color:#11796D">null-safety</span></span></code></pre></div></div><p>If the output says that all the packages support null safety, then you can start migrating. Otherwise, use the <strong>Resolvable</strong> column to find null-safe releases, if they exist.</p><aside class="alert alert-info"><div class="alert-header"><i class="material-symbols" aria-hidden="true">info</i> <span>Why do all dependencies need to support null safety?</span></div><div class="alert-content"><p>When all of an app's direct dependencies support null safety, you can <em>run the app</em> with sound null safety. When all the dev dependencies support null safety, you can <em>run tests</em> with sound null safety. You might also need null-safe dev dependencies for other reasons, such as code generation.</p></div></aside><p>Here's an example of the output for a simple package. The green checkmarked version for each package supports null safety:</p><p><img src="../assets/img/null-safety/pub-outdated-output.png" alt="Output of dart pub outdated"></p><p>The output shows that all of the package's dependencies have resolvable prereleases that support null safety.</p><p>If any of your package's dependencies <em>don't</em> yet support null safety, we encourage you to reach out to the package owner. You can find contact details on the package page on <a href="https://pub.dev/">pub.dev</a>.</p><div class="header-wrapper"><h3 id="update-dependencies">Update dependencies</h3><a class="heading-link" href="#update-dependencies" aria-label="Link to 'Update dependencies' section">#</a></div><p>Before migrating your package's code, update its dependencies to null-safe versions:</p><ol><li><p>Run <code>dart pub upgrade --null-safety</code> to upgrade to the latest versions supporting null safety. <strong>Note:</strong> This command changes your <code>pubspec.yaml</code> file.</p></li><li><p>Run <code>dart pub get</code>.</p></li></ol><div class="header-wrapper"><h2 id="step2-migrate">2. Migrate</h2><a class="heading-link" href="#step2-migrate" aria-label="Link to '2. Migrate' section">#</a></div><p>Most of the changes that your code needs to be null safe are easily predictable. For example, if a variable can be <code>null</code>, <a href="../null-safety.html#creating-variables">its type needs a <code>?</code> suffix</a>. If a named parameter shouldn't be nullable, mark it <a href="understanding-null-safety.html#required-named-parameters"><code>required</code></a> or give it a <a href="../language/functions.html#default-parameters">default value</a>.</p><p>You have two options for migrating:</p><ul><li><a href="#migration-tool">Use the migration tool</a>, which can make most of the easily predictable changes for you.</li><li><a href="#migrating-by-hand">Migrate your code by hand.</a></li></ul><aside class="alert alert-success"><div class="alert-header"><i class="material-symbols" aria-hidden="true">lightbulb</i> <span>Tip</span></div><div class="alert-content"><p>For additional help while migrating code, check the <a href="faq.html">null safety FAQ</a>.</p></div></aside><div class="header-wrapper"><h3 id="migration-tool">Using the migration tool</h3><a class="heading-link" href="#migration-tool" aria-label="Link to 'Using the migration tool' section">#</a></div><p>The migration tool takes a package of null-unsafe Dart code and converts it to null safety. You can guide the tool's conversion by adding <a href="#hint-markers">hint markers</a> to your Dart code.</p><p>Before starting the tool, make sure you're ready:</p><ul><li>Use the 2.19.6 release of the Dart SDK.</li><li>Use <code>dart pub outdated --mode=null-safety</code> to make sure that all dependencies are null safe and up-to-date.</li></ul><p>Start the migration tool by running the <code>dart migrate</code> command in the directory that contains the package's <code>pubspec.yaml</code> file:</p><div class="code-block-wrapper language-console"><div class="code-block-body"><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#222222">$ dart migrate</span></span></code></pre></div></div><p>If your package is ready to migrate, then the tool produces a line like the following:</p><div class="code-block-wrapper language-console"><div class="code-block-body"><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#222222">View the migration suggestions by visiting:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#222222">  http://127.0.0.1:60278/Users/you/project/mypkg.console-simple?authToken=Xfz0jvpyeMI%3D</span></span></code></pre></div></div><p>Visit that URL in a Chrome browser to see an interactive UI where you can guide the migration process:</p><p><img src="../assets/img/null-safety/migration-tool.png" alt="Screenshot of migration tool"></p><p>For every variable and type annotation, you can see what nullability the tool infers. For example, in the preceding screenshot, the tool infers that the <code>ints</code> list (previously a list of <code>int</code>) in line 1 is nullable, and thus should be a list of <code>int?</code>.</p><div class="header-wrapper"><h4 id="understanding-migration-results">Understanding migration results</h4><a class="heading-link" href="#understanding-migration-results" aria-label="Link to 'Understanding migration results' section">#</a></div><p>To see the reasons for each change (or non-change), click its line number in the <strong>Proposed Edits</strong> pane. The reasons appear in the <strong>Edit Details</strong> pane.</p><p>For example, consider the following code, from before null safety:</p><div class="code-block-wrapper language-dart"><div class="code-block-body"><span class="code-block-language" title="Language dart">dart</span><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#D43324">var</span><span style="color:#222222"> ints = </span><span style="color:#D43324">const</span><span style="color:#222222"> &#x3C;</span><span style="color:#0468D7">int</span><span style="color:#222222">>[</span><span style="color:#11796D">0</span><span style="color:#222222">, </span><span style="color:#11796D">null</span><span style="color:#222222">];</span></span>
<span class="line"><span style="color:#D43324">var</span><span style="color:#222222"> zero = ints[</span><span style="color:#11796D">0</span><span style="color:#222222">];</span></span>
<span class="line"><span style="color:#D43324">var</span><span style="color:#222222"> one = zero + </span><span style="color:#11796D">1</span><span style="color:#222222">;</span></span>
<span class="line"><span style="color:#D43324">var</span><span style="color:#222222"> zeroOne = &#x3C;</span><span style="color:#0468D7">int</span><span style="color:#222222">>[zero, one];</span></span></code></pre></div></div><p>The default migration when this code is outside a function (it's different within a function) is backward compatible but not ideal:</p><div class="code-block-wrapper language-dart"><div class="code-block-body"><span class="code-block-language" title="Language dart">dart</span><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#D43324">var</span><span style="color:#222222"> ints = </span><span style="color:#D43324">const</span><span style="color:#222222"> &#x3C;</span><span style="color:#0468D7">int</span><span style="color:#222222">?>[</span><span style="color:#11796D">0</span><span style="color:#222222">, </span><span style="color:#11796D">null</span><span style="color:#222222">];</span></span>
<span class="line"><span style="color:#D43324">var</span><span style="color:#222222"> zero = ints[</span><span style="color:#11796D">0</span><span style="color:#222222">];</span></span>
<span class="line"><span style="color:#D43324">var</span><span style="color:#222222"> one = zero! + </span><span style="color:#11796D">1</span><span style="color:#222222">;</span></span>
<span class="line"><span style="color:#D43324">var</span><span style="color:#222222"> zeroOne = &#x3C;</span><span style="color:#0468D7">int</span><span style="color:#222222">?>[zero, one];</span></span></code></pre></div></div><p>By clicking the <strong>line 3</strong> link, you can see the migration tool's reasons for adding the <code>!</code>. Because you know that <code>zero</code> can't be null, you can improve the migration result.</p><div class="header-wrapper"><h4 id="hint-markers">Improving migration results</h4><a class="heading-link" href="#hint-markers" aria-label="Link to 'Improving migration results' section">#</a></div><p>When analysis infers the wrong nullability, you can override its proposed edits by inserting temporary hint markers:</p><ul><li><p>In the <strong>Edit Details</strong> pane of the migration tool, you can insert hint markers using the <strong>Add <code>/*?*/</code> hint</strong> and <strong>Add <code>/*!*/</code> hint</strong> buttons.</p><p>These buttons add comments to your file immediately, and there's <strong>no Undo</strong>. If you don't want a hint that the tool inserted, you can use your usual code editor to remove it.</p></li><li><p>You can use an editor to add hint markers, even while the tool is still running. Because your code hasn't opted into null safety yet, you can't use new null-safety features. You can, however, make changes like refactoring that don't depend on null-safety features.</p><p>When you've finished editing your code, click <strong>Rerun from sources</strong> to pick up your changes.</p></li></ul><p>The following table shows the hint markers that you can use to change the migration tool's proposed edits.</p><div class="table-wrapper"><table class="table table-striped"><thead><tr><th>Hint marker</th><th>Effect on the migration tool</th></tr></thead><tbody><tr><td><code><em>expression</em> /<em>!</em>/</code></td><td>Adds a <code>!</code> to the migrated code, casting <em>expression</em> to its underlying non-nullable type.</td></tr><tr><td><code><em>type</em> /<em>!</em>/</code></td><td>Marks <em>type</em> as non-nullable.</td></tr><tr><td><code>/*?*/</code></td><td>Marks the preceding type as nullable.</td></tr><tr><td><code>/*late*/</code></td><td>Marks the variable declaration as <code>late</code>, indicating that it has late initialization.</td></tr><tr><td><code>/*late final*/</code></td><td>Marks the variable declaration as <code>late final</code>, indicating that it has late, one-time initialization.</td></tr><tr><td><code>/*required*/</code></td><td>Marks the parameter as <code>required</code>.</td></tr></tbody></table></div><p>A single hint can have ripple effects elsewhere in the code. In the example from before, manually adding a <code>/*!*/</code> marker where <code>zero</code> is assigned its value (on line 2) makes the migration tool infer the type of <code>zero</code> as <code>int</code> instead of <code>int?</code>. This type change can affect code that directly or indirectly uses <code>zero</code>.</p><div class="code-block-wrapper language-dart"><div class="code-block-body"><span class="code-block-language" title="Language dart">dart</span><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#D43324">var</span><span style="color:#222222"> zero = ints[</span><span style="color:#11796D">0</span><span style="color:#222222">]</span><span style="color:#6E6E70">/*!*/</span><span style="color:#222222">;</span></span></code></pre></div></div><p>With the above hint, the migration tool changes its proposed edits, as the following code snippets show. Line 3 no longer has a <code>!</code> after <code>zero</code>, and in line 4 <code>zeroOne</code> is inferred to be a list of <code>int</code>, not <code>int?</code>.</p><table><tr><th>First migration</th><th>Migration with hint</th></tr><tr><td><div class="code-block-wrapper language-dart"><div class="code-block-body"><span class="code-block-language" title="Language dart">dart</span><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#D43324">var</span><span style="color:#222222"> ints = </span><span style="color:#D43324">const</span><span style="color:#222222"> &#x3C;</span><span style="color:#0468D7">int</span><span style="color:#222222">?>[</span><span style="color:#11796D">0</span><span style="color:#222222">, </span><span style="color:#11796D">null</span><span style="color:#222222">];</span></span>
<span class="line"><span style="color:#D43324">var</span><span style="color:#222222"> zero = ints[</span><span style="color:#11796D">0</span><span style="color:#222222">];</span></span>
<span class="line"><span style="color:#D43324">var</span><span style="color:#222222"> one = zero! + </span><span style="color:#11796D">1</span><span style="color:#222222">;</span></span>
<span class="line"><span style="color:#D43324">var</span><span style="color:#222222"> zeroOne = &#x3C;</span><span style="color:#0468D7">int</span><span style="color:#222222">?>[zero, one];</span></span></code></pre></div></div></td><td><div class="code-block-wrapper language-dart"><div class="code-block-body"><span class="code-block-language" title="Language dart">dart</span><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#D43324">var</span><span style="color:#222222"> ints = </span><span style="color:#D43324">const</span><span style="color:#222222"> &#x3C;</span><span style="color:#0468D7">int</span><span style="color:#222222">?>[</span><span style="color:#11796D">0</span><span style="color:#222222">, </span><span style="color:#11796D">null</span><span style="color:#222222">];</span></span>
<span class="line"><span style="color:#D43324">var</span><span style="color:#222222"> zero = ints[</span><span style="color:#11796D">0</span><span style="color:#222222">]</span><span style="color:#6E6E70">/*!*/</span><span style="color:#222222">;</span></span>
<span class="line"><span style="color:#D43324">var</span><span style="color:#222222"> one = zero + </span><span style="color:#11796D">1</span><span style="color:#222222">;</span></span>
<span class="line"><span style="color:#D43324">var</span><span style="color:#222222"> zeroOne = &#x3C;</span><span style="color:#0468D7">int</span><span style="color:#222222">>[zero, one];</span></span></code></pre></div></div></td></tr></table><div class="header-wrapper"><h4 id="opting-out-files">Opting out files</h4><a class="heading-link" href="#opting-out-files" aria-label="Link to 'Opting out files' section">#</a></div><p>Although we recommend migrating all at once, sometimes that isn't practical, especially in a large app or package. To opt out a file or directory, click its green checkbox. Later, when you apply changes, each opted out file will be unchanged except for a 2.9 <a href="../resources/language/evolution.html#per-library-language-version-selection">version comment</a>.</p><p>For more information about incremental migration, see <a href="unsound-null-safety.html">Unsound null safety</a>.</p><p>Note that only fully migrated apps and packages are compatible with Dart 3.</p><div class="header-wrapper"><h4 id="applying-changes">Applying changes</h4><a class="heading-link" href="#applying-changes" aria-label="Link to 'Applying changes' section">#</a></div><p>When you like all of the changes that the migration tool proposes, click <strong>Apply migration</strong>. The migration tool deletes the hint markers and saves the migrated code. The tool also updates the minimum SDK constraint in the pubspec, which opts the package into null safety.</p><p>The next step is to <a href="#step3-analyze">statically analyze your code</a>. If it's valid, then <a href="#step4-test">test your code</a>. Then, if you've published your code on pub.dev, <a href="#step5-publish">publish a null-safe prerelease</a>.</p><div class="header-wrapper"><h3 id="migrating-by-hand">Migrating by hand</h3><a class="heading-link" href="#migrating-by-hand" aria-label="Link to 'Migrating by hand' section">#</a></div><p>If you prefer not to use the migration tool, you can migrate manually.</p><p>We recommend that you <strong>first migrate leaf libraries</strong>—libraries that don't import other files from the package. Then migrate libraries that directly depend on the leaf libraries. End by migrating the libraries that have the most intra-package dependencies.</p><p>For example, say you have a <code>lib/src/util.dart</code> file that imports other (null-safe) packages and core libraries, but that doesn't have any <code>import '&lt;local_path&gt;'</code> directives. Consider migrating <code>util.dart</code> first, and then migrating simple files that depend only on <code>util.dart</code>. If any libraries have cyclic imports (for example, A imports B which imports C, and C imports A), consider migrating those libraries together.</p><p>To migrate a package by hand, follow these steps:</p><ol><li><p>Edit the package's <code>pubspec.yaml</code> file, setting the minimum SDK constraint to at least <code>2.12.0</code>:</p><div class="code-block-wrapper language-yaml"><div class="code-block-body"><span class="code-block-language" title="Language yaml">yaml</span><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#0468D7">environment</span><span style="color:#222222">:</span></span>
<span class="line"><span style="color:#0468D7">  sdk</span><span style="color:#222222">: </span><span style="color:#11796D">'>=2.12.0 &#x3C;3.0.0'</span></span></code></pre></div></div></li><li><p>Regenerate the <a href="https://github.com/dart-lang/language/blob/main/accepted/2.8/language-versioning/package-config-file-v2.md">package configuration file</a>:</p><div class="code-block-wrapper language-console"><div class="code-block-body"><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#222222">$ dart pub get</span></span></code></pre></div></div><p>Running <code>dart pub get</code> with a lower SDK constraint of at least <code>2.12.0</code> sets the default language version of every library in the package to a minimum of 2.12, opting them all in to null safety.</p></li><li><p>Open the package in your IDE.<br>You're likely to see a lot of analysis errors. That's OK.</p></li><li><p>Migrate the code of each Dart file, using the analyzer to identify static errors.<br>Eliminate static errors by adding <code>?</code>, <code>!</code>, <code>required</code>, and <code>late</code>, as needed.</p></li></ol><p>See <a href="unsound-null-safety.html">Unsound null safety</a> for more help on migrating code by hand.</p><div class="header-wrapper"><h2 id="step3-analyze">3. Analyze</h2><a class="heading-link" href="#step3-analyze" aria-label="Link to '3. Analyze' section">#</a></div><p>Update your packages (using <code>dart pub get</code> in your IDE or on the command line). Then use your IDE or the command line to perform <a href="../tools/analysis.html">static analysis</a> on your code:</p><div class="code-block-wrapper language-console"><div class="code-block-body"><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#222222">$ dart pub get</span></span>
<span class="line"><span style="color:#222222">$ dart analyze     </span><span style="color:#6E6E70"># or `flutter analyze`</span></span></code></pre></div></div><div class="header-wrapper"><h2 id="step4-test">4. Test</h2><a class="heading-link" href="#step4-test" aria-label="Link to '4. Test' section">#</a></div><p>If your code passes analysis, run tests:</p><div class="code-block-wrapper language-console"><div class="code-block-body"><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#222222">$ dart test       </span><span style="color:#6E6E70"># or `flutter test`</span></span></code></pre></div></div><p>You might need to update tests that expect null values.</p><p>If you need to make large changes to your code, then you might need to remigrate it. If so, revert your code changes before using the migration tool again.</p><div class="header-wrapper"><h2 id="step5-publish">5. Publish</h2><a class="heading-link" href="#step5-publish" aria-label="Link to '5. Publish' section">#</a></div><p>We encourage you to publish packages—possibly as prereleases—as soon as you migrate:</p><ul><li><a href="#package-version">Set the package version to indicate a breaking change.</a></li><li><a href="#check-your-pubspec">Update the SDK constraints and package dependencies.</a></li><li><a href="../tools/pub/publishing.html">Publish the package</a>. If you don't consider this version to be a stable release, then <a href="../tools/pub/publishing.html#publishing-prereleases">publish the package as a prerelease</a>.</li></ul><div class="header-wrapper"><h3 id="package-version">Update the package version</h3><a class="heading-link" href="#package-version" aria-label="Link to 'Update the package version' section">#</a></div><p>Update the version of the package to indicate a breaking change:</p><ul><li><p>If your package is already at <code>1.0.0</code> or greater, increase the major version. For example, if the previous version is <code>2.3.2</code>, the new version is <code>3.0.0</code>.</p></li><li><p>If your package hasn't reached <code>1.0.0</code> yet, <em>either</em> increase the minor version <em>or</em> update the version to <code>1.0.0</code>. For example, if the previous version is <code>0.3.2</code>, the new version is either <code>0.4.0</code> or <code>1.0.0</code>.</p></li></ul><div class="header-wrapper"><h3 id="check-your-pubspec">Check your pubspec</h3><a class="heading-link" href="#check-your-pubspec" aria-label="Link to 'Check your pubspec' section">#</a></div><p>Before you publish a stable null safety version of a package, we strongly recommend following these pubspec rules:</p><ul><li>Set the Dart lower SDK constraint to the lowest stable version that you've tested against (at least <code>2.12.0</code>).</li><li>Use stable versions of all direct dependencies.</li></ul><div class="header-wrapper"><h2 id="welcome-to-null-safety">Welcome to null safety</h2><a class="heading-link" href="#welcome-to-null-safety" aria-label="Link to 'Welcome to null safety' section">#</a></div><p>If you made it this far, you should have a fully migrated, null-safe Dart package.</p><p>If all of the packages you depend on are migrated too, then your program is sound with respect to null-reference errors. You should see output like this when running or compiling your code:</p><div class="code-block-wrapper language-console"><div class="code-block-body"><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#222222">Compiling with sound null safety</span></span></code></pre></div></div><p>From all of the Dart team, <em>thank you</em> for migrating your code.</p><p id="page-github-links"><span>Unless stated otherwise, the documentation on this site reflects Dart 3.6.0. Page last updated on 2024-12-10.</span> <a href="https://github.com/dart-lang/site-www/tree/main/src/content/null-safety/migration-guide.md" target="_blank" rel="noopener">View source</a> <span>or </span><a href="https://github.com/dart-lang/site-www/issues/new?template=1_page_issue.yml&amp;page-url=https://dart.dev/null-safety/migration-guide/&amp;page-source=https://github.com/dart-lang/site-www/tree/main/src/content/null-safety/migration-guide.md" title="Report an issue with this page" target="_blank" rel="noopener">report an issue</a>.</p></div></article></main><footer id="page-footer"><div class="footer-section footer-main"><a href="../index.html" class="brand" title="Dart"><img src="../assets/img/logo/logo-white-text.svg" alt="Dart" width="164"></a><div class="footer-social-links"><a href="https://medium.com/dartlang" target="_blank" rel="noopener" title="Medium blog"><svg><use href="../assets/img/social/medium.svg#medium"></use></svg> </a><a href="https://github.com/dart-lang" target="_blank" rel="noopener" title="GitHub"><svg><use href="../assets/img/social/github.svg#github"></use></svg> </a><a href="https://twitter.com/dart_lang" target="_blank" rel="noopener" title="X (Twitter)"><svg><use href="../assets/img/social/x.svg#x"></use></svg></a></div></div><div class="footer-section footer-tray"><div class="footer-licenses">Except as otherwise noted, this site is licensed under a <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>, and code samples are licensed under the <a href="https://opensource.org/licenses/BSD-3-Clause">3-Clause BSD License</a>.</div><div class="footer-utility-links"><ul><li><a href="../terms.html" title="Terms of use">Terms</a></li><li><a href="https://policies.google.com/privacy" target="_blank" rel="noopener" title="Privacy policy">Privacy</a></li><li><a href="../security.html" title="Security philosophy and practices">Security</a></li></ul></div></div></footer></body>
<!-- Mirrored from dart.dev/null-safety/migration-guide by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Dec 2024 22:14:20 GMT -->
</html>