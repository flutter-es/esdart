<!doctype html><html lang="en">
<!-- Mirrored from dart.dev/tools/pub/automated-publishing by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Dec 2024 22:17:46 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><script>!function(e,t,a,n){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var g=t.getElementsByTagName(a)[0],m=t.createElement(a);m.async=!0,m.src="../../../www.googletagmanager.com/gtm4a44.js?id=GTM-5VSZM5J",g.parentNode.insertBefore(m,g)}(window,document,"script","dataLayer")</script><meta name="description" content="Publish Dart packages to pub.dev directly from GitHub Actions."><title>Automated publishing of packages to pub.dev | Dart</title><link rel="icon" sizes="64x64" href="../../assets/img/logo/dart-64.png" eleventy:ignore><link href="../../assets/img/touch-icon-iphone.png" rel="apple-touch-icon" eleventy:ignore><link href="../../assets/img/touch-icon-ipad.png" rel="apple-touch-icon" sizes="152x152" eleventy:ignore><link href="../../assets/img/touch-icon-iphone-retina.png" rel="apple-touch-icon" sizes="180x180" eleventy:ignore><link href="../../assets/img/touch-icon-ipad-retina.png" rel="apple-touch-icon" sizes="167x167" eleventy:ignore><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@dart_lang"><meta name="twitter:title" content="Automated publishing of packages to pub.dev"><meta name="twitter:description" content="Publish Dart packages to pub.dev directly from GitHub Actions."><meta property="og:title" content="Automated publishing of packages to pub.dev"><meta property="og:description" content="Publish Dart packages to pub.dev directly from GitHub Actions."><meta property="og:url" content="/tools/pub/automated-publishing/"><meta property="og:image" content="/assets/img/logo/dart-logo-for-shares.png?2" eleventy:ignore><link rel="preconnect" href="https://fonts.googleapis.com/"><link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin><link href="https://fonts.googleapis.com/css2?family=Google+Sans:wght@400;500;700&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Google+Sans+Display:wght@400&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Google+Sans+Mono:wght@400;500;700&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Google+Sans+Text:wght@400;500;700&amp;display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" rel="stylesheet"><link rel="stylesheet" href="../../assets/css/main.css"><script src="../../../cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js" integrity="sha512-3gJwYpMe3QewGELv8k/BX9vcqhryRdzRMxVfq6ngyWXwo03GFEzjsUm8Q7RZcHPHksttq7/GFoxjCVUjkjvPdw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="../../../cdnjs.cloudflare.com/ajax/libs/bootstrap/4.6.2/js/bootstrap.min.js" integrity="sha384-+sLIOodYLS7CIrQpBjl+C7nPvqq+FbNUBDunl/OZv93DB7Ln/533i8e/mZXLi/P+" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="../../../cdnjs.cloudflare.com/ajax/libs/js-cookie/3.0.5/js.cookie.min.js" integrity="sha512-nlp9/l96/EpjYBx7EP7pGASVXNe80hGhYAUrjeXnu/fyF5Py0/RXav4BBNs7n5Hx1WFhOEOWSAVjGeC3oKxDVQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="../../assets/js/os-tabs.js"></script><script src="../../assets/js/utilities.js"></script><script src="../../assets/js/main.js"></script><script>!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src="../../../www.google-analytics.com/analytics.js",s.parentNode.insertBefore(o,s)}(window,document,"script",0,"ga"),ga("create","UA-26406144-4","auto"),ga("send","pageview")</script></head><body class="default.html show_banner"><a id="skip" href="#site-content-title">Skip to main content</a><section id="cookie-notice"><div class="container"><p>dart.dev uses cookies from Google to deliver and enhance the quality of its services and to analyze traffic. <a href="https://policies.google.com/technologies/cookies" target="_blank" rel="noopener">Learn more</a>.</p><button id="cookie-consent" class="btn btn-primary">OK, got it</button></div></section><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5VSZM5J" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><header id="page-header" class="site-header"><nav id="mainnav" class="site-header"><div id="menu-toggle"><i class="material-symbols">menu</i></div><a href="../../index.html" class="brand" title="Dart"><img src="../../assets/img/logo/logo-white-text.svg" alt="Dart"></a><ul class="navbar"><li><a href="../../overview.html" class="nav-link">Overview</a></li><li class="mainnav__get-started"><a href="../../guides.html" class="nav-link active"><span>Docs</span></a></li><li><a href="../../community.html" class="nav-link">Community</a></li><li><a href="../../index.html#try-dart" class="nav-link">Try Dart</a></li><li><a href="../../get-dart.html" class="nav-link">Get Dart</a></li><li class="searchfield"><form action="https://dart.dev/search" class="site-header__search form-inline" id="cse-search-box"><input type="hidden" name="cx" value="011220921317074318178:_yy-tmb5t_i"> <input type="hidden" name="ie" value="UTF-8"> <input type="hidden" name="hl" value="en"> <input class="site-header__searchfield form-control search-field" type="search" name="q" id="search-main" autocomplete="off" placeholder="Search" aria-label="Search"></form></li></ul></nav></header><div class="banner"><p class="banner__text">Dart 3.6 is here! Read the <a href="https://medium.com/dartlang/announcing-dart-3-6-778dd7a80983" target="_blank">blog post</a> to learn about new features in pub and the language.</p></div><div id="sidenav"><form action="https://dart.dev/search/" class="site-header__search form-inline"><input class="site-header__searchfield form-control search-field" type="search" name="q" id="search-side" autocomplete="off" placeholder="Search" aria-label="Search"></form><div class="site-sidebar"><ul class="navbar-nav"><li class="nav-item"><a href="../../overview.html" class="nav-link">Overview</a></li><li class="nav-item"><a href="../../community.html" class="nav-link">Community</a></li><li class="nav-item"><a href="https://dartpad.dev/" class="nav-link">Try Dart</a></li><li class="nav-item"><a href="../../get-dart.html" class="nav-link">Get Dart</a></li><li class="nav-item"><a href="../../guides.html" class="nav-link">Docs</a></li><li aria-hidden="true"><div class="sidebar-primary-divider"></div></li></ul><ul class="nav flex-column"><li class="nav-item"><a class="nav-link collapsed collapsible" data-toggle="collapse" href="#sidenav-1" role="button" aria-expanded="false" aria-controls="sidenav-1">Language</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-1"><li class="nav-item"><a class="nav-link" href="../../language.html">Introduction</a></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-1-2" href="#sidenav-1-2" role="button" aria-expanded="false" aria-controls="sidenav-1-2">Syntax basics</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-1-2"><li class="nav-item"><a class="nav-link" href="../../language/variables.html">Variables</a></li><li class="nav-item"><a class="nav-link" href="../../language/operators.html">Operators</a></li><li class="nav-item"><a class="nav-link" href="../../language/comments.html">Comments</a></li><li class="nav-item"><a class="nav-link" href="../../language/metadata.html">Metadata</a></li><li class="nav-item"><a class="nav-link" href="../../language/libraries.html">Libraries & imports</a></li><li class="nav-item"><a class="nav-link" href="../../language/keywords.html">Keywords</a></li></ul></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-1-3" href="#sidenav-1-3" role="button" aria-expanded="false" aria-controls="sidenav-1-3">Types</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-1-3"><li class="nav-item"><a class="nav-link" href="../../language/built-in-types.html">Built-in types</a></li><li class="nav-item"><a class="nav-link" href="../../language/records.html">Records</a></li><li class="nav-item"><a class="nav-link" href="../../language/collections.html">Collections</a></li><li class="nav-item"><a class="nav-link" href="../../language/generics.html">Generics</a></li><li class="nav-item"><a class="nav-link" href="../../language/typedefs.html">Typedefs</a></li><li class="nav-item"><a class="nav-link" href="../../language/type-system.html">Type system</a></li></ul></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-1-4" href="#sidenav-1-4" role="button" aria-expanded="false" aria-controls="sidenav-1-4">Patterns</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-1-4"><li class="nav-item"><a class="nav-link" href="../../language/patterns.html">Overview & usage</a></li><li class="nav-item"><a class="nav-link" href="../../language/pattern-types.html">Pattern types</a></li><li class="nav-item"><a class="nav-link" href="https://codelabs.developers.google.com/codelabs/dart-patterns-records" target="_blank" rel="noopener">Applied tutorial</a></li></ul></li><li class="nav-item"><a class="nav-link" href="../../language/functions.html">Functions</a></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-1-6" href="#sidenav-1-6" role="button" aria-expanded="false" aria-controls="sidenav-1-6">Control flow</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-1-6"><li class="nav-item"><a class="nav-link" href="../../language/loops.html">Loops</a></li><li class="nav-item"><a class="nav-link" href="../../language/branches.html">Branches</a></li><li class="nav-item"><a class="nav-link" href="../../language/error-handling.html">Error handling</a></li></ul></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-1-7" href="#sidenav-1-7" role="button" aria-expanded="false" aria-controls="sidenav-1-7">Classes & objects</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-1-7"><li class="nav-item"><a class="nav-link" href="../../language/classes.html">Classes</a></li><li class="nav-item"><a class="nav-link" href="../../language/constructors.html">Constructors</a></li><li class="nav-item"><a class="nav-link" href="../../language/methods.html">Methods</a></li><li class="nav-item"><a class="nav-link" href="../../language/extend.html">Extend a class</a></li><li class="nav-item"><a class="nav-link" href="../../language/mixins.html">Mixins</a></li><li class="nav-item"><a class="nav-link" href="../../language/enums.html">Enums</a></li><li class="nav-item"><a class="nav-link" href="../../language/extension-methods.html">Extension methods</a></li><li class="nav-item"><a class="nav-link" href="../../language/extension-types.html">Extension types</a></li><li class="nav-item"><a class="nav-link" href="../../language/callable-objects.html">Callable objects</a></li></ul></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-1-8" href="#sidenav-1-8" role="button" aria-expanded="false" aria-controls="sidenav-1-8">Class modifiers</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-1-8"><li class="nav-item"><a class="nav-link" href="../../language/class-modifiers.html">Overview & usage</a></li><li class="nav-item"><a class="nav-link" href="../../language/class-modifiers-for-apis.html">Class modifiers for API maintainers</a></li><li class="nav-item"><a class="nav-link" href="../../language/modifier-reference.html">Reference</a></li></ul></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-1-9" href="#sidenav-1-9" role="button" aria-expanded="false" aria-controls="sidenav-1-9">Concurrency</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-1-9"><li class="nav-item"><a class="nav-link" href="../../language/concurrency.html">Overview</a></li><li class="nav-item"><a class="nav-link" href="../../language/async.html">Asynchronous support</a></li><li class="nav-item"><a class="nav-link" href="../../language/isolates.html">Isolates</a></li></ul></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-1-10" href="#sidenav-1-10" role="button" aria-expanded="false" aria-controls="sidenav-1-10">Null safety</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-1-10"><li class="nav-item"><a class="nav-link" href="../../null-safety.html">Sound null safety</a></li><li class="nav-item"><a class="nav-link" href="../../null-safety/migration-guide.html">Migrating to null safety</a></li><li class="nav-item"><a class="nav-link" href="../../null-safety/understanding-null-safety.html">Understanding null safety</a></li><li class="nav-item"><a class="nav-link" href="../../null-safety/unsound-null-safety.html">Unsound null safety</a></li><li class="nav-item"><a class="nav-link" href="../../null-safety/faq.html">FAQ</a></li></ul></li></ul></li><li class="nav-item"><a class="nav-link collapsed collapsible" data-toggle="collapse" href="#sidenav-2" role="button" aria-expanded="false" aria-controls="sidenav-2">Core libraries</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-2"><li class="nav-item"><a class="nav-link" href="../../libraries.html">Overview</a></li><li class="nav-item"><a class="nav-link" href="../../libraries/dart-core.html">dart:core</a></li><li class="nav-item"><a class="nav-link" href="../../libraries/dart-async.html">dart:async</a></li><li class="nav-item"><a class="nav-link" href="../../libraries/dart-math.html">dart:math</a></li><li class="nav-item"><a class="nav-link" href="../../libraries/dart-convert.html">dart:convert</a></li><li class="nav-item"><a class="nav-link" href="../../libraries/dart-io.html">dart:io</a></li><li class="nav-item"><a class="nav-link" href="../../libraries/dart-html.html">dart:html</a></li><div class="dropdown-divider"></div><li class="nav-item"><a class="nav-link" href="../../libraries/collections/iterables.html">Iterable collections</a></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-2-10" href="#sidenav-2-10" role="button" aria-expanded="false" aria-controls="sidenav-2-10">Asynchronous programming</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-2-10"><li class="nav-item"><a class="nav-link" href="../../libraries/async/async-await.html">Tutorial</a></li><li class="nav-item"><a class="nav-link" href="../../libraries/async/futures-error-handling.html">Futures and error handling</a></li><li class="nav-item"><a class="nav-link" href="../../libraries/async/using-streams.html">Using streams</a></li><li class="nav-item"><a class="nav-link" href="../../libraries/async/creating-streams.html">Creating streams</a></li></ul></li></ul></li><li class="nav-item"><a class="nav-link collapsed collapsible" data-toggle="collapse" href="#sidenav-3" role="button" aria-expanded="false" aria-controls="sidenav-3">Effective Dart</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-3"><li class="nav-item"><a class="nav-link" href="../../effective-dart.html">Overview</a></li><li class="nav-item"><a class="nav-link" href="../../effective-dart/style.html">Style</a></li><li class="nav-item"><a class="nav-link" href="../../effective-dart/documentation.html">Documentation</a></li><li class="nav-item"><a class="nav-link" href="../../effective-dart/usage.html">Usage</a></li><li class="nav-item"><a class="nav-link" href="../../effective-dart/design.html">Design</a></li></ul></li><li class="nav-item"><a class="nav-link collapsed collapsible" data-toggle="collapse" href="#sidenav-4" role="button" aria-expanded="false" aria-controls="sidenav-4">Packages</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-4"><li class="nav-item"><a class="nav-link" href="packages.html">How to use packages</a></li><li class="nav-item"><a class="nav-link" href="../../resources/useful-packages.html">Commonly used packages</a></li><li class="nav-item"><a class="nav-link" href="create-packages.html">Creating packages</a></li><li class="nav-item"><a class="nav-link" href="publishing.html">Publishing packages</a></li><li class="nav-item"><a class="nav-link" href="writing-package-pages.html">Writing package pages</a></li><li class="nav-item"><a class="nav-link" href="workspaces.html">Workspaces (monorepo support)</a></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-4-7" href="#sidenav-4-7" role="button" aria-expanded="false" aria-controls="sidenav-4-7">Package reference</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-4-7"><li class="nav-item"><a class="nav-link" href="dependencies.html">Dependencies</a></li><li class="nav-item"><a class="nav-link" href="glossary.html">Glossary</a></li><li class="nav-item"><a class="nav-link" href="package-layout.html">Package layout conventions</a></li><li class="nav-item"><a class="nav-link" href="environment-variables.html">Pub environment variables</a></li><li class="nav-item"><a class="nav-link" href="pubspec.html">Pubspec file</a></li><li class="nav-item"><a class="nav-link" href="troubleshoot.html">Troubleshooting pub</a></li><li class="nav-item"><a class="nav-link" href="verified-publishers.html">Verified publishers</a></li><li class="nav-item"><a class="nav-link" href="security-advisories.html">Security advisories</a></li><li class="nav-item"><a class="nav-link" href="versioning.html">Versioning</a></li><li class="nav-item"><a class="nav-link" href="custom-package-repositories.html">Custom package repositories</a></li></ul></li><li class="nav-item"><a class="nav-link" href="private-files.html">What not to commit</a></li></ul></li><li class="nav-item"><a class="nav-link collapsed collapsible" data-toggle="collapse" href="#sidenav-5" role="button" aria-expanded="false" aria-controls="sidenav-5">Development</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-5"><li class="nav-item"><a class="nav-link" href="../../guides/json.html">JSON</a></li><li class="nav-item"><a class="nav-link" href="../../resources/language/number-representation.html">Number representation</a></li><li class="nav-item"><a class="nav-link" href="../../resources/google-apis.html">Google APIs</a></li><li class="nav-item"><a class="nav-link" href="../../multiplatform-apps.html">Multi-platform apps</a></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-5-5" href="#sidenav-5-5" role="button" aria-expanded="false" aria-controls="sidenav-5-5">Command-line & server apps</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-5-5"><li class="nav-item"><a class="nav-link" href="../../server.html">Overview</a></li><li class="nav-item"><a class="nav-link" href="../../tutorials/server/get-started.html">Get started</a></li><li class="nav-item"><a class="nav-link" href="../../tutorials/server/cmdline.html">Write command-line apps</a></li><li class="nav-item"><a class="nav-link" href="../../tutorials/server/fetch-data.html">Fetch data from the internet</a></li><li class="nav-item"><a class="nav-link" href="../../tutorials/server/httpserver.html">Write HTTP servers</a></li><li class="nav-item"><a class="nav-link" href="../../server/libraries.html">Libraries & packages</a></li><li class="nav-item"><a class="nav-link" href="../../server/google-cloud.html">Google Cloud</a></li></ul></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-5-6" href="#sidenav-5-6" role="button" aria-expanded="false" aria-controls="sidenav-5-6">Web apps</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-5-6"><li class="nav-item"><a class="nav-link" href="../../web.html">Overview</a></li><li class="nav-item"><a class="nav-link" href="../../web/get-started.html">Get started</a></li><li class="nav-item"><a class="nav-link" href="../../web/deployment.html">Deployment</a></li><li class="nav-item"><a class="nav-link" href="../../web/libraries.html">Libraries & packages</a></li><li class="nav-item"><a class="nav-link" href="../../web/wasm.html">Wasm compilation</a></li></ul></li><li class="nav-item"><a class="nav-link" href="../../guides/environment-declarations.html">Environment declarations</a></li></ul></li><li class="nav-item"><a class="nav-link collapsed collapsible" data-toggle="collapse" href="#sidenav-6" role="button" aria-expanded="false" aria-controls="sidenav-6">Interoperability</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-6"><li class="nav-item"><a class="nav-link" href="../../interop/c-interop.html">C interop</a></li><li class="nav-item"><a class="nav-link" href="../../interop/objective-c-interop.html">Objective-C & Swift interop</a></li><li class="nav-item"><a class="nav-link" href="../../interop/java-interop.html">Java & Kotlin interop</a></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-6-4" href="#sidenav-6-4" role="button" aria-expanded="false" aria-controls="sidenav-6-4">JavaScript interop</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-6-4"><li class="nav-item"><a class="nav-link" href="../../interop/js-interop.html">Overview</a></li><li class="nav-item"><a class="nav-link" href="../../interop/js-interop/usage.html">Usage</a></li><li class="nav-item"><a class="nav-link" href="../../interop/js-interop/js-types.html">JS types</a></li><li class="nav-item"><a class="nav-link" href="../../interop/js-interop/tutorials.html">Tutorials</a></li><li class="nav-item"><a class="nav-link" href="../../interop/js-interop/past-js-interop.html">Past JS interop</a></li><div class="dropdown-divider"></div><li class="nav-item"><a class="nav-link" href="../../interop/js-interop/package-web.html">Web interop</a></li></ul></li></ul></li><li class="nav-item"><a class="nav-link collapsed collapsible" data-toggle="collapse" href="#sidenav-7" role="button" aria-expanded="false" aria-controls="sidenav-7">Tools & techniques</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-7"><li class="nav-item"><a class="nav-link" href="../../tools.html">Overview</a></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-7-2" href="#sidenav-7-2" role="button" aria-expanded="false" aria-controls="sidenav-7-2">Editors & debuggers</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-7-2"><li class="nav-item"><a class="nav-link" href="../jetbrains-plugin.html">IntelliJ & Android Studio</a></li><li class="nav-item"><a class="nav-link" href="../vs-code.html">VS Code</a></li><li class="nav-item"><a class="nav-link" href="../dart-devtools.html">Dart DevTools</a></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-7-2-4" href="#sidenav-7-2-4" role="button" aria-expanded="false" aria-controls="sidenav-7-2-4">DartPad</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-7-2-4"><li class="nav-item"><a class="nav-link" href="../dartpad.html">Overview</a></li><li class="nav-item"><a class="nav-link" href="../dartpad/troubleshoot.html">Troubleshooting DartPad</a></li></ul></li></ul></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-7-3" href="#sidenav-7-3" role="button" aria-expanded="false" aria-controls="sidenav-7-3">Command-line tools</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-7-3"><li class="nav-item"><a class="nav-link collapsible" data-toggle="collapse" data-target="#sidenav-7-3-1" href="#sidenav-7-3-1" role="button" aria-expanded="true" aria-controls="sidenav-7-3-1">Dart SDK</a><ul class="nav flex-column flex-nowrap collapse show" id="sidenav-7-3-1"><li class="nav-item"><a class="nav-link" href="../sdk.html">Overview</a></li><li class="nav-item"><a class="nav-link" href="../dart-tool.html">dart</a></li><li class="nav-item"><a class="nav-link" href="../dart-analyze.html">dart analyze</a></li><li class="nav-item"><a class="nav-link" href="../dart-compile.html">dart compile</a></li><li class="nav-item"><a class="nav-link" href="../dart-create.html">dart create</a></li><li class="nav-item"><a class="nav-link" href="../dart-doc.html">dart doc</a></li><li class="nav-item"><a class="nav-link" href="../dart-fix.html">dart fix</a></li><li class="nav-item"><a class="nav-link" href="../dart-format.html">dart format</a></li><li class="nav-item"><a class="nav-link" href="../dart-info.html">dart info</a></li><li class="nav-item"><a class="nav-link" href="cmd.html">dart pub</a></li><li class="nav-item"><a class="nav-link" href="../dart-run.html">dart run</a></li><li class="nav-item"><a class="nav-link" href="../dart-test.html">dart test</a></li><li class="nav-item"><a class="nav-link" href="../dartaotruntime.html">dartaotruntime</a></li><li class="nav-item"><a class="nav-link" href="../experiment-flags.html">Experiment flags</a></li></ul></li><li class="nav-item"><a class="nav-link collapsible" data-toggle="collapse" data-target="#sidenav-7-3-2" href="#sidenav-7-3-2" role="button" aria-expanded="true" aria-controls="sidenav-7-3-2">Other command-line tools</a><ul class="nav flex-column flex-nowrap collapse show" id="sidenav-7-3-2"><li class="nav-item"><a class="nav-link" href="../build_runner.html">build_runner</a></li><li class="nav-item"><a class="nav-link" href="../webdev.html">webdev</a></li></ul></li></ul></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-7-4" href="#sidenav-7-4" role="button" aria-expanded="false" aria-controls="sidenav-7-4">Static analysis</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-7-4"><li class="nav-item"><a class="nav-link" href="../analysis.html">Customizing static analysis</a></li><li class="nav-item"><a class="nav-link" href="../../deprecated/sound-problems.html">Fixing common type problems</a></li><li class="nav-item"><a class="nav-link" href="../non-promotion-reasons.html">Fixing type promotion failures</a></li><li class="nav-item"><a class="nav-link" href="../linter-rules.html">Linter rules</a></li><li class="nav-item"><a class="nav-link" href="../diagnostic-messages.html">Diagnostic messages</a></li></ul></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-7-5" href="#sidenav-7-5" role="button" aria-expanded="false" aria-controls="sidenav-7-5">Testing & optimization</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-7-5"><li class="nav-item"><a class="nav-link" href="../../guides/testing.html">Testing</a></li><li class="nav-item"><a class="nav-link" href="../../web/debugging.html">Debugging web apps</a></li></ul></li></ul></li><li aria-hidden="true"><div class="sidebar-primary-divider"></div></li><li class="nav-item"><a class="nav-link collapsed collapsible" data-toggle="collapse" href="#sidenav-9" role="button" aria-expanded="false" aria-controls="sidenav-9">Resources</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-9"><li class="nav-item"><a class="nav-link" href="../../resources/dart-cheatsheet.html">Language cheatsheet</a></li><li class="nav-item"><a class="nav-link" href="../../resources/breaking-changes.html">Breaking changes</a></li><li class="nav-item"><a class="nav-link" href="../../resources/language/evolution.html">Language evolution</a></li><li class="nav-item"><a class="nav-link" href="../../resources/language/spec.html">Language specification</a></li><li class="nav-item"><a class="nav-link" href="../../resources/dart-3-migration.html">Dart 3 migration guide</a></li><li class="nav-item"><a class="nav-link collapsible collapsed" data-toggle="collapse" data-target="#sidenav-9-6" href="#sidenav-9-6" role="button" aria-expanded="false" aria-controls="sidenav-9-6">Coming from ...</a><ul class="nav flex-column flex-nowrap collapse" id="sidenav-9-6"><li class="nav-item"><a class="nav-link" href="../../resources/coming-from/js-to-dart.html">JavaScript to Dart</a></li><li class="nav-item"><a class="nav-link" href="../../resources/coming-from/swift-to-dart.html">Swift to Dart</a></li></ul></li><div class="dropdown-divider"></div><li class="nav-item"><a class="nav-link" href="../../resources/faq.html">FAQ</a></li><li class="nav-item"><a class="nav-link" href="../../resources/glossary.html">Glossary</a></li><li class="nav-item"><a class="nav-link" href="../../resources/books.html">Books</a></li><li class="nav-item"><a class="nav-link" href="../../resources/videos.html">Videos</a></li><li class="nav-item"><a class="nav-link" href="../../tutorials.html">Tutorials</a></li></ul></li><li class="nav-item"><a class="nav-link collapsible" data-toggle="collapse" href="#sidenav-10" role="button" aria-expanded="true" aria-controls="sidenav-10">Related sites</a><ul class="nav flex-column flex-nowrap collapse show" id="sidenav-10"><li class="nav-item"><a class="nav-link" href="https://api.dart.dev/" target="_blank" rel="noopener">API reference</a></li><li class="nav-item"><a class="nav-link" href="https://medium.com/dartlang" target="_blank" rel="noopener">Blog</a></li><li class="nav-item"><a class="nav-link" href="https://dartpad.dev/" target="_blank" rel="noopener">DartPad (online editor)</a></li><li class="nav-item"><a class="nav-link" href="https://flutter.dev/" target="_blank" rel="noopener">Flutter</a></li><li class="nav-item"><a class="nav-link" href="https://pub.dev/" target="_blank" rel="noopener">Package site</a></li></ul></li></ul></div></div><main id="page-content"><div id="site-toc--side" class="site-toc"><header class="site-toc__title">Contents</header><ul class="section-nav"><li class="toc-entry nav-item"><a class="nav-link" href="#publishing-packages-using-github-actions">Publishing packages using GitHub Actions</a><ul class="nav"><li class="toc-entry nav-item"><a class="nav-link" href="#configuring-automated-publishing-from-github-actions-on-pub-dev">Configuring automated publishing from GitHub Actions on pub.dev</a></li><li class="toc-entry nav-item"><a class="nav-link" href="#configuring-a-github-action-workflow-for-publishing-to-pub-dev">Configuring a GitHub Action workflow for publishing to pub.dev</a></li><li class="toc-entry nav-item"><a class="nav-link" href="#triggering-automated-publishing-from-github-actions">Triggering automated publishing from GitHub Actions</a></li><li class="toc-entry nav-item"><a class="nav-link" href="#hardening-security-with-tag-protection-rules-on-github">Hardening security with tag protection rules on GitHub</a></li><li class="toc-entry nav-item"><a class="nav-link" href="#hardening-security-with-github-deployment-environments">Hardening security with GitHub Deployment Environments</a></li></ul></li><li class="toc-entry nav-item"><a class="nav-link" href="#publishing-from-google-cloud-build">Publishing from Google Cloud Build</a><ul class="nav"><li class="toc-entry nav-item"><a class="nav-link" href="#creating-a-service-account-for-publishing">Creating a service account for publishing</a></li><li class="toc-entry nav-item"><a class="nav-link" href="#granting-cloud-build-permission-to-publish">Granting Cloud Build permission to publish</a></li><li class="toc-entry nav-item"><a class="nav-link" href="#writing-a-cloud-build-configuration-file">Writing a Cloud Build configuration file</a></li><li class="toc-entry nav-item"><a class="nav-link" href="#creating-a-cloud-build-trigger">Creating a Cloud Build trigger</a></li><li class="toc-entry nav-item"><a class="nav-link" href="#hardening-security-with-cloud-build-approvals">Hardening security with Cloud Build Approvals</a></li></ul></li><li class="toc-entry nav-item"><a class="nav-link" href="#publish-from-anywhere-using-a-service-account">Publish from anywhere using a Service Account</a><ul class="nav"><li class="toc-entry nav-item"><a class="nav-link" href="#publish-using-workload-identity-federation">Publish using Workload Identity Federation</a></li><li class="toc-entry nav-item"><a class="nav-link" href="#publish-using-exported-service-account-keys">Publish using Exported Service Account Keys</a></li></ul></li></ul></div><article><div class="content"><div id="site-content-title"><h1>Automated publishing of packages to pub.dev</h1></div><div id="site-toc--inline" class="site-toc toc-collapsible toc-collapsed"><header class="site-toc__title">Contents <span class="site-toc--inline__toggle toc-toggle-down"><i class="material-symbols">keyboard_arrow_down</i></span> <span class="site-toc--inline__toggle toc-toggle-up"><i class="material-symbols">keyboard_arrow_up</i></span></header><ul class="section-nav"><li class="toc-entry"><a href="#publishing-packages-using-github-actions">Publishing packages using GitHub Actions</a><ul><li class="toc-entry"><a href="#configuring-automated-publishing-from-github-actions-on-pub-dev">Configuring automated publishing from GitHub Actions on pub.dev</a></li><li class="toc-entry"><a href="#configuring-a-github-action-workflow-for-publishing-to-pub-dev">Configuring a GitHub Action workflow for publishing to pub.dev</a></li><li class="toc-entry"><a href="#triggering-automated-publishing-from-github-actions">Triggering automated publishing from GitHub Actions</a></li><li class="toc-entry"><a href="#hardening-security-with-tag-protection-rules-on-github">Hardening security with tag protection rules on GitHub</a></li><li class="toc-entry"><a href="#hardening-security-with-github-deployment-environments">Hardening security with GitHub Deployment Environments</a></li></ul></li><li class="toc-entry"><a href="#publishing-from-google-cloud-build">Publishing from Google Cloud Build</a><ul><li class="toc-entry"><a href="#creating-a-service-account-for-publishing">Creating a service account for publishing</a></li><li class="toc-entry"><a href="#granting-cloud-build-permission-to-publish">Granting Cloud Build permission to publish</a></li><li class="toc-entry"><a href="#writing-a-cloud-build-configuration-file">Writing a Cloud Build configuration file</a></li><li class="toc-entry"><a href="#creating-a-cloud-build-trigger">Creating a Cloud Build trigger</a></li><li class="toc-entry"><a href="#hardening-security-with-cloud-build-approvals">Hardening security with Cloud Build Approvals</a></li></ul></li><li class="toc-entry"><a href="#publish-from-anywhere-using-a-service-account">Publish from anywhere using a Service Account</a><ul><li class="toc-entry"><a href="#publish-using-workload-identity-federation">Publish using Workload Identity Federation</a></li><li class="toc-entry"><a href="#publish-using-exported-service-account-keys">Publish using Exported Service Account Keys</a></li></ul></li></ul><span class="site-toc--inline__toggle toc-toggle-more-items"><i class="material-symbols">more_horiz</i></span></div><p>You can automate publishing from:</p><ul><li><a href="https://github.com/features/actions">GitHub Actions</a>,</li><li><a href="https://cloud.google.com/build">Google Cloud Build</a> or,</li><li>Anywhere else using a <a href="https://cloud.google.com/iam/docs/service-accounts">GCP service account</a>.</li></ul><p>The following sections explain how automated publishing is configured, and how you can customize publishing flows in line with your preferences.</p><p>When configuring automated publishing you don't need to create a long-lived secret that is copied into your automated deployment environment. Instead, authentication relies on temporary OpenID-Connect tokens signed by either GitHub Actions (See <a href="https://docs.github.com/en/actions/deployment/security-hardening-your-deployments/about-security-hardening-with-openid-connect">OIDC for GitHub Actions</a>) or Google Cloud IAM.</p><p>You can use <em>exported service account keys</em> for deployment environments where an identity service isn't present. Such exported service account keys are long-lived secrets, they might be easier to use in some environments, but also pose a larger risk if accidentally leaked.</p><aside class="alert alert-info"><div class="alert-header"><i class="material-symbols" aria-hidden="true">info</i> <span>Note</span></div><div class="alert-content"><p>Today, you can only automate publishing of existing packages. To create a new package, you must publish the first version using <code>dart pub publish</code>.</p></div></aside><div class="header-wrapper"><h2 id="publishing-packages-using-github-actions">Publishing packages using GitHub Actions</h2><a class="heading-link" href="#publishing-packages-using-github-actions" aria-label="Link to 'Publishing packages using GitHub Actions' section">#</a></div><p>You can configure automated publishing using GitHub Actions. This involves:</p><ul><li><p>Enabling automated publishing on pub.dev, specifying:</p><ul><li>The GitHub repository and,</li><li>A <em>tag-pattern</em> that must match to allow publishing.</li></ul></li><li><p>Creating a GitHub Actions <em>workflow</em> for publishing to pub.dev.</p></li><li><p>Pushing a <em>git tag</em> for the version to be published.</p></li></ul><p>The following sections outline how to complete these steps.</p><aside class="alert alert-info"><div class="alert-header"><i class="material-symbols" aria-hidden="true">info</i> <span>Note</span></div><div class="alert-content"><p>Pub.dev only allows automated publishing from GitHub Actions when the <em>workflow</em> is triggered by pushing a git tag to GitHub. Pub.dev rejects publishing from GitHub Actions triggered without a tag. This ensures that new versions cannot be published by events that should never trigger publishing.</p></div></aside><div class="header-wrapper"><h3 id="configuring-automated-publishing-from-github-actions-on-pub-dev">Configuring automated publishing from GitHub Actions on pub.dev</h3><a class="heading-link" href="#configuring-automated-publishing-from-github-actions-on-pub-dev" aria-label="Link to 'Configuring automated publishing from GitHub Actions on pub.dev' section">#</a></div><p>To enable automated publication from GitHub Actions to <code>pub.dev</code>, you must be:</p><ul><li>An <em>uploader</em> on the package, or,</li><li>An <em>admin</em> of the publisher (if the package is owned by a publisher).</li></ul><p>If you have sufficient permission, you can enable automated publishing by:</p><ol><li><p>Navigating to the <strong>Admin</strong> tab (<code>pub.dev/packages/&lt;package&gt;/admin</code>).</p></li><li><p>Find the <strong>Automated publishing</strong> section.</p></li><li><p>Click <strong>Enable publishing from GitHub Actions</strong>, this prompts you to specify:</p><ul><li>A repository (<code>&lt;organization&gt;/&lt;repository&gt;</code>, example: <code>dart-lang/pana</code>),</li><li>A <em>tag-pattern</em> (a string containing <code>{{version}}</code>).</li></ul></li></ol><p>The <em>repository</em> is the <code>&lt;organization&gt;/&lt;repository&gt;</code> on GitHub. For example, if your repository is <code>https://github.com/dart-lang/pana</code> you must specify <code>dart-lang/pana</code> in the repository field.</p><p>The <em>tag pattern</em> is a string that must contain <code>{{version}}</code>. Only GitHub Actions triggered by a push of a tag that matches this <em>tag pattern</em> will be allowed to publish your package.</p><p><img src="../../assets/img/tools/pub/pub-dev-gh-setup.png" alt="Configuration of publishing from GitHub Actions on pub.dev"></p><p><strong>Example:</strong> a <em>tag pattern</em> like <code>v{{version}}</code> allows GitHub Actions (triggered by <code>git tag v1.2.3 &amp;&amp; git push v1.2.3</code>) to publish version <code>1.2.3</code> of your package. Thus, it's also important that the <code>version</code> key in <code>pubspec.yaml</code> matches this version number.</p><p>If your repository contains multiple packages, give each a separate <em>tag-pattern</em>. Consider using a <em>tag-pattern</em> like <code>my_package_name-v{{version}}</code> for a package named <code>my_package_name</code>.</p><div class="header-wrapper"><h3 id="configuring-a-github-action-workflow-for-publishing-to-pub-dev">Configuring a GitHub Action workflow for publishing to pub.dev</h3><a class="heading-link" href="#configuring-a-github-action-workflow-for-publishing-to-pub-dev" aria-label="Link to 'Configuring a GitHub Action workflow for publishing to pub.dev' section">#</a></div><p>When automated publishing from GitHub Actions is enabled on pub.dev, you can create a GitHub Actions workflow for publishing. This is done by creating a <code>.github/workflows/publish.yml</code> file as follows:</p><div class="code-block-wrapper language-yaml"><div class="code-block-body"><span class="code-block-language" title="Language yaml">yaml</span><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#6E6E70"># .github/workflows/publish.yml</span></span>
<span class="line"><span style="color:#0468D7">name</span><span style="color:#222222">: </span><span style="color:#11796D">Publish to pub.dev</span></span>
<span class="line"></span>
<span class="line"><span style="color:#11796D">on</span><span style="color:#222222">:</span></span>
<span class="line"><span style="color:#0468D7">  push</span><span style="color:#222222">:</span></span>
<span class="line"><span style="color:#0468D7">    tags</span><span style="color:#222222">:</span></span>
<span class="line"><span style="color:#6E6E70">    # must align with the tag-pattern configured on pub.dev, often just replace</span></span>
<span class="line"><span style="color:#6E6E70">      # {{version}} with [0-9]+.[0-9]+.[0-9]+</span></span>
<span class="line"><span style="color:#222222">    - </span><span style="color:#11796D">'v[0-9]+.[0-9]+.[0-9]+'</span><span style="color:#6E6E70"> # tag-pattern on pub.dev: 'v{{version}}'</span></span>
<span class="line"><span style="color:#6E6E70">    # If you prefer tags like '1.2.3', without the 'v' prefix, then use:</span></span>
<span class="line"><span style="color:#6E6E70">    # - '[0-9]+.[0-9]+.[0-9]+' # tag-pattern on pub.dev: '{{version}}'</span></span>
<span class="line"><span style="color:#6E6E70">    # If your repository contains multiple packages consider a pattern like:</span></span>
<span class="line"><span style="color:#6E6E70">    # - 'my_package_name-v[0-9]+.[0-9]+.[0-9]+'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6E6E70"># Publish using the reusable workflow from dart-lang.</span></span>
<span class="line"><span style="color:#0468D7">jobs</span><span style="color:#222222">:</span></span>
<span class="line"><span style="color:#0468D7">  publish</span><span style="color:#222222">:</span></span>
<span class="line"><span style="color:#0468D7">    permissions</span><span style="color:#222222">:</span></span>
<span class="line"><span style="color:#0468D7">      id-token</span><span style="color:#222222">: </span><span style="color:#11796D">write</span><span style="color:#6E6E70"> # Required for authentication using OIDC</span></span>
<span class="line"><span style="color:#0468D7">    uses</span><span style="color:#222222">: </span><span style="color:#11796D">dart-lang/setup-dart/.github/workflows/publish.yml@v1</span></span>
<span class="line"><span style="color:#6E6E70">    # with:</span></span>
<span class="line"><span style="color:#6E6E70">    #   working-directory: path/to/package/within/repository</span></span></code></pre></div></div><p>Make sure to match the pattern in <code>on.push.tags</code> with the <em>tag pattern</em> specified on pub.dev. Otherwise, the GitHub Action workflow won't work. If publishing multiple packages from the same repository, use a per-package <em>tag pattern</em> like <code>my_package_name-v{{version}}</code> and create a separate workflow file for each package.</p><p>The workflow file above uses <code>dart-lang/setup-dart/.github/workflows/publish.yml</code> to publish the package. This is a <a href="https://docs.github.com/en/actions/using-workflows/reusing-workflows#calling-a-reusable-workflow">reusable workflow</a> that allows the Dart team to maintain the publishing logic and enables pub.dev to know how the package was published. Using this <em>reusable workflow</em> is strongly encouraged.</p><p>If you need generated code in your package, then it is preferable to check this generated code into your repository. This simplifies verifying that the files published on pub.dev match the files from your repository. If checking generated or built artifact into your repository is not reasonable, you can create a custom workflow along the lines of:</p><div class="code-block-wrapper language-yaml"><div class="code-block-body"><span class="code-block-language" title="Language yaml">yaml</span><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#6E6E70"># .github/workflows/publish.yml</span></span>
<span class="line"><span style="color:#0468D7">name</span><span style="color:#222222">: </span><span style="color:#11796D">Publish to pub.dev</span></span>
<span class="line"></span>
<span class="line"><span style="color:#11796D">on</span><span style="color:#222222">:</span></span>
<span class="line"><span style="color:#0468D7">  push</span><span style="color:#222222">:</span></span>
<span class="line"><span style="color:#0468D7">    tags</span><span style="color:#222222">:</span></span>
<span class="line"><span style="color:#222222">    - </span><span style="color:#11796D">'v[0-9]+.[0-9]+.[0-9]+'</span><span style="color:#6E6E70"> # tag pattern on pub.dev: 'v{{version}'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6E6E70"># Publish using custom workflow</span></span>
<span class="line"><span style="color:#0468D7">jobs</span><span style="color:#222222">:</span></span>
<span class="line"><span style="color:#0468D7">  publish</span><span style="color:#222222">:</span></span>
<span class="line"><span style="color:#0468D7">    permissions</span><span style="color:#222222">:</span></span>
<span class="line"><span style="color:#0468D7">      id-token</span><span style="color:#222222">: </span><span style="color:#11796D">write</span><span style="color:#6E6E70"> # Required for authentication using OIDC</span></span>
<span class="line"><span style="color:#0468D7">    runs-on</span><span style="color:#222222">: </span><span style="color:#11796D">ubuntu-latest</span></span>
<span class="line"><span style="color:#0468D7">    steps</span><span style="color:#222222">:</span></span>
<span class="line"><span style="color:#222222">      - </span><span style="color:#0468D7">uses</span><span style="color:#222222">: </span><span style="color:#11796D">actions/checkout@v3</span></span>
<span class="line"><span style="color:#222222">      - </span><span style="color:#0468D7">uses</span><span style="color:#222222">: </span><span style="color:#11796D">dart-lang/setup-dart@v1</span></span>
<span class="line"><span style="color:#222222">      - </span><span style="color:#0468D7">name</span><span style="color:#222222">: </span><span style="color:#11796D">Install dependencies</span></span>
<span class="line"><span style="color:#0468D7">        run</span><span style="color:#222222">: </span><span style="color:#11796D">dart pub get</span></span>
<span class="line"><span style="color:#6E6E70">      # Here you can insert custom steps you need</span></span>
<span class="line"><span style="color:#6E6E70">      # - run: dart tool/generate-code.dart</span></span>
<span class="line"><span style="color:#222222">      - </span><span style="color:#0468D7">name</span><span style="color:#222222">: </span><span style="color:#11796D">Publish</span></span>
<span class="line"><span style="color:#0468D7">        run</span><span style="color:#222222">: </span><span style="color:#11796D">dart pub publish --force</span></span></code></pre></div></div><p>The workflow authenticates to <code>pub.dev</code> using a temporary <a href="https://docs.github.com/en/actions/deployment/security-hardening-your-deployments/about-security-hardening-with-openid-connect">GitHub-signed OIDC token</a>, the token is created and configured in the <code>dart-lang/setup-dart</code> step. To publish to pub.dev, subsequent steps can run <code>dart pub publish --force</code>.</p><aside class="alert alert-info"><div class="alert-header"><i class="material-symbols" aria-hidden="true">info</i> <span>Note</span></div><div class="alert-content"><p>At this point, anyone with push access to your repository can publish new versions of the package. Consider using <a href="#hardening-security-with-tag-protection-rules-on-github">tag protection rules</a> or <a href="#hardening-security-with-github-deployment-environments">GitHub deployment Environments</a> to limit who can publish.</p></div></aside><div class="header-wrapper"><h3 id="triggering-automated-publishing-from-github-actions">Triggering automated publishing from GitHub Actions</h3><a class="heading-link" href="#triggering-automated-publishing-from-github-actions" aria-label="Link to 'Triggering automated publishing from GitHub Actions' section">#</a></div><p>After you've configured automated publishing on <code>pub.dev</code> and created a GitHub Actions workflow, you can publish a new version of your package. To publish, push a <em>git tag</em> matching the configured <em>tag pattern</em>.</p><div class="code-block-wrapper language-console"><div class="code-block-body"><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#222222">$ cat pubspec.yaml</span></span></code></pre></div></div><div class="code-block-wrapper language-yaml"><div class="code-block-body"><span class="code-block-language" title="Language yaml">yaml</span><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#0468D7">package</span><span style="color:#222222">: </span><span style="color:#11796D">my_package_name</span></span>
<span class="line"><span style="color:#0468D7">version</span><span style="color:#222222">: </span><span style="color:#11796D">1.2.3</span><span style="color:#6E6E70">            # must match the version number used in the git tag</span></span>
<span class="line"><span style="color:#0468D7">environment</span><span style="color:#222222">:</span></span>
<span class="line"><span style="color:#0468D7">  sdk</span><span style="color:#222222">: </span><span style="color:#11796D">^2.19.0</span></span></code></pre></div></div><div class="code-block-wrapper language-console"><div class="code-block-body"><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#222222">$ git tag v1.2.3          </span><span style="color:#6E6E70"># assuming my tag pattern is: 'v{{version}}'</span></span>
<span class="line"><span style="color:#222222">$ git push origin v1.2.3  </span><span style="color:#6E6E70"># triggers the action that publishes my package.</span></span></code></pre></div></div><p>Once pushed, review the workflow logs at <code>https://github.com/&lt;organization&gt;/&lt;repository&gt;/actions</code>.</p><p>If the Action didn't trigger, check that the pattern configured in <code>.github/workflows/publish.yml</code> matches the pushed <em>git tag</em>. If the Action failed, the logs might contain clues as to why it failed.</p><p>Once published, you can see the publication event in the <code>audit-log</code> on <code>pub.dev</code>. The <code>audit-log</code> entry should contain a link to the GitHub Action run that published the package version.</p><p><img src="../../assets/img/tools/pub/audit-log-pub-gh.png" alt="Audit log after publishing from GitHub Actions"></p><p>If you don't like using the <code>git</code> CLI to create tags, you can create <em>releases</em> on GitHub from <code>https://github.com/&lt;organization&gt;/&lt;repository&gt;/releases/new</code>. To learn more, check out <a href="https://docs.github.com/en/repositories/releasing-projects-on-github/managing-releases-in-a-repository">managing releases in a repository</a> from GitHub.</p><div class="header-wrapper"><h3 id="hardening-security-with-tag-protection-rules-on-github">Hardening security with tag protection rules on GitHub</h3><a class="heading-link" href="#hardening-security-with-tag-protection-rules-on-github" aria-label="Link to 'Hardening security with tag protection rules on GitHub' section">#</a></div><p>Configuring automated publishing from GitHub Actions allows anyone who can push a tag to your repository to trigger publishing to pub.dev. You can restrict who can push tags to your repository using <a href="https://docs.github.com/en/repositories/managing-your-repositorys-settings-and-features/managing-repository-settings/configuring-tag-protection-rules">tag protection rules</a> on GitHub.</p><p>By limiting who can create tags matching your <em>tag pattern</em>, you can limit who can publish the package.</p><p>At this time, the <a href="https://docs.github.com/en/repositories/managing-your-repositorys-settings-and-features/managing-repository-settings/configuring-tag-protection-rules">tag protection rules</a> lack flexibility. You might want to restrict who can trigger publishing using GitHub Deployment Environments, as outlined in the next section.</p><div class="header-wrapper"><h3 id="hardening-security-with-github-deployment-environments">Hardening security with GitHub Deployment Environments</h3><a class="heading-link" href="#hardening-security-with-github-deployment-environments" aria-label="Link to 'Hardening security with GitHub Deployment Environments' section">#</a></div><p>When configuring automated publishing from GitHub Actions on pub.dev, you can require a <a href="https://docs.github.com/en/actions/deployment/targeting-different-environments/using-environments-for-deployment">GitHub Actions environment</a>. To require a <em>GitHub Actions environment</em> for publishing you must:</p><ol><li>Navigate to the <strong>Admin</strong> tab (<code>pub.dev/packages/&lt;package&gt;/admin</code>).</li><li>Find the <strong>Automated publishing</strong> section.</li><li>Click <strong>Require GitHub Actions environment</strong>.</li><li>Specify an <strong>Environment</strong> name, (<code>pub.dev</code> is typically a good name)</li></ol><p><img src="../../assets/img/tools/pub/pub-dev-gh-env-setup.png" alt="Configure pub.dev to require a GitHub deployment environment"></p><p>When an environment is required on pub.dev, GitHub Actions won't be able to publish unless they have <code>environment: pub.dev</code>. Thus, you must:</p><ol><li><a href="https://docs.github.com/en/actions/deployment/targeting-different-environments/using-environments-for-deployment#creating-an-environment">Create an <em>environment</em></a> with the same name on GitHub (typically <code>pub.dev</code>)</li><li>Alter your <code>.github/workflows/publish.yml</code> workflow file to specify <code>environment: pub.dev</code>, as follows:</li></ol><div class="code-block-wrapper language-yaml"><div class="code-block-body"><span class="code-block-language" title="Language yaml">yaml</span><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#6E6E70"># .github/workflows/publish.yml</span></span>
<span class="line"><span style="color:#0468D7">name</span><span style="color:#222222">: </span><span style="color:#11796D">Publish to pub.dev</span></span>
<span class="line"></span>
<span class="line"><span style="color:#11796D">on</span><span style="color:#222222">:</span></span>
<span class="line"><span style="color:#0468D7">  push</span><span style="color:#222222">:</span></span>
<span class="line"><span style="color:#0468D7">    tags</span><span style="color:#222222">:</span></span>
<span class="line"><span style="color:#222222">    - </span><span style="color:#11796D">'v[0-9]+.[0-9]+.[0-9]+'</span><span style="color:#6E6E70"> # for tags like: 'v1.2.3'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#0468D7">jobs</span><span style="color:#222222">:</span></span>
<span class="line"><span style="color:#0468D7">  publish</span><span style="color:#222222">:</span></span>
<span class="line"><span style="color:#0468D7">    permissions</span><span style="color:#222222">:</span></span>
<span class="line"><span style="color:#0468D7">      id-token</span><span style="color:#222222">: </span><span style="color:#11796D">write</span><span style="color:#6E6E70"> # Required for authentication using OIDC</span></span>
<span class="line"><span style="color:#0468D7">    uses</span><span style="color:#222222">: </span><span style="color:#11796D">dart-lang/setup-dart/.github/workflows/publish.yml@v1</span></span>
<span class="line"><span style="color:#0468D7">    with</span><span style="color:#222222">:</span></span>
<span class="line"><span style="color:#6E6E70">      # Specify the github actions deployment environment</span></span>
<span class="line"><span style="color:#0468D7">      environment</span><span style="color:#222222">: </span><span style="color:#11796D">pub.dev</span></span>
<span class="line"><span style="color:#6E6E70">      # working-directory: path/to/package/within/repository</span></span></code></pre></div></div><p>The <em>environment</em> is reflected in the temporary <a href="https://docs.github.com/en/actions/deployment/security-hardening-your-deployments/about-security-hardening-with-openid-connect">GitHub-signed OIDC token</a> used for authentication with pub.dev. Thus, a user with permission to push to your repository cannot circumvent <a href="https://docs.github.com/en/actions/deployment/targeting-different-environments/using-environments-for-deployment#environment-protection-rules">environment protection rules</a> by modifying the workflow file.</p><p>In GitHub repository settings, you can use <a href="https://docs.github.com/en/actions/deployment/targeting-different-environments/using-environments-for-deployment#environment-protection-rules">environment protection rules</a> to configure <em>required reviewers</em>. If you configure this option, GitHub prevents actions with the environment from running until one of the <em>required reviewers</em> have approved the run.</p><p><img src="../../assets/img/tools/pub/gh-pending-review.png" alt="GitHub Action waiting for deployment review"></p><div class="header-wrapper"><h2 id="publishing-from-google-cloud-build">Publishing from Google Cloud Build</h2><a class="heading-link" href="#publishing-from-google-cloud-build" aria-label="Link to 'Publishing from Google Cloud Build' section">#</a></div><p>You can configure automated publishing from <a href="https://cloud.google.com/build">Google Cloud Build</a>. This involves:</p><ul><li>Register a Google Cloud Project (or using an existing project),</li><li>Create a <a href="https://cloud.google.com/iam/docs/service-accounts">service account</a> for publishing to pub.dev,</li><li>Enable automated publishing in the admin tab for the package on pub.dev, specifying the email of the service account created for publishing.</li><li>Grant the default Cloud Build service account permission to impersonate the service account created for publishing.</li><li>Create a <code>cloudbuild.yaml</code> file that obtains a temporary OIDC <code>id_token</code> and uses it for publishing to pub.dev</li><li>Configure a Cloud Build trigger, for running the steps in <code>cloudbuild.yaml</code> in your project on Google Cloud Build.</li></ul><p>The following sections outline how to complete these steps.</p><aside class="alert alert-info"><div class="alert-header"><i class="material-symbols" aria-hidden="true">info</i> <span>Note</span></div><div class="alert-content"><p>When you enable automated publishing from a <em>service account</em> you must carefully review who has the ability to impersonate this service account, either by calling through APIs, exporting service account keys, or through changing IAM permission in the cloud project. To learn more, check out <a href="https://cloud.google.com/iam/docs/impersonating-service-accounts">managing service account impersonation</a>.</p></div></aside><div class="header-wrapper"><h3 id="creating-a-service-account-for-publishing">Creating a service account for publishing</h3><a class="heading-link" href="#creating-a-service-account-for-publishing" aria-label="Link to 'Creating a service account for publishing' section">#</a></div><p>For publishing to pub.dev you are going to create a <em>service account</em> that is granted permission to publish your package on pub.dev. You are then going to grant Cloud Build permission to impersonate this service account.</p><ol><li><p><a href="https://cloud.google.com/resource-manager/docs/creating-managing-projects">Create a cloud project</a>, if you don't have an existing project.</p></li><li><p>Create a <em>service account</em> as follows:</p><div class="code-block-wrapper language-console"><div class="code-block-body"><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#222222">$ gcloud iam service-accounts create pub-dev \</span></span>
<span class="line"><span style="color:#222222">  --description='Service account to be impersonated when publishing to pub.dev' \</span></span>
<span class="line"><span style="color:#222222">  --display-name='pub-dev'</span></span></code></pre></div></div><p>This creates a service account named <code>pub-dev@$PROJECT_ID.iam.gserviceaccount.com</code>.</p></li><li><p>Grant the service account permission to publish your package.</p><p>To complete this step, you must have <em>uploader</em> permission on the package or be an <em>admin</em> of the publisher that owns the package.</p><p>a. Navigate to the <strong>Admin</strong> tab (<code>pub.dev/packages/&lt;package&gt;/admin</code>). a. Click <strong>Enable publishing with Google Cloud Service account</strong>. a. Type the email of the service account into the <strong>Service account email</strong> field. You created this account in the previous step: <code>pub-dev@$PROJECT_ID.iam.gserviceaccount.com</code></p></li></ol><p><img src="../../assets/img/tools/pub/pub-dev-gcb-config.png" alt="Configuration that allows service account to publish on pub.dev"></p><p>With this procedure complete, anyone who can impersonate the service account can publish new versions of the package. Make sure to review who has permissions to impersonate the service account and change permissions in the cloud project as needed.</p><aside class="alert alert-info"><div class="alert-header"><i class="material-symbols" aria-hidden="true">info</i> <span>Note</span></div><div class="alert-content"><p>The <em>service account</em> must be created in the same cloud project where you intend to run Cloud Build. If you need to impersonate across cloud projects, refer to <a href="https://cloud.google.com/iam/docs/impersonating-service-accounts#enabling-cross-project">enabling service account impersonation across projects</a>.</p></div></aside><div class="header-wrapper"><h3 id="granting-cloud-build-permission-to-publish">Granting Cloud Build permission to publish</h3><a class="heading-link" href="#granting-cloud-build-permission-to-publish" aria-label="Link to 'Granting Cloud Build permission to publish' section">#</a></div><p>To publish from Cloud Build you must give the <a href="https://cloud.google.com/build/docs/cloud-build-service-account">default Cloud Build service account</a> permission to impersonate the service account created for publishing in the previous section.</p><ol><li><p>Enable the <a href="https://console.cloud.google.com/apis/api/iamcredentials.googleapis.com">IAM Service Account Credentials API</a> in the cloud project. Attempts to impersonate a service account will fail without this API.</p><div class="code-block-wrapper language-console"><div class="code-block-body"><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#222222"># Enable IAM Service Account Credentials API</span></span>
<span class="line"><span style="color:#222222">$ gcloud services enable iamcredentials.googleapis.com</span></span></code></pre></div></div></li><li><p>Find the project number.</p><div class="code-block-wrapper language-console"><div class="code-block-body"><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#222222"># The PROJECT_NUMBER can be obtained as follows:</span></span>
<span class="line"><span style="color:#222222">$ gcloud projects describe $PROJECT_ID --format=</span><span style="color:#11796D">'value(projectNumber)'</span></span></code></pre></div></div></li><li><p>Grant the permission to impersonate the publishing service account.</p><div class="code-block-wrapper language-console"><div class="code-block-body"><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#222222"># Grant default cloud</span></span>
<span class="line"><span style="color:#222222">$ gcloud iam service-accounts add-iam-policy-binding \</span></span>
<span class="line"><span style="color:#222222">  pub-dev@$PROJECT_ID.iam.gserviceaccount.com \</span></span>
<span class="line"><span style="color:#222222">  --member=serviceAccount:$PROJECT_NUMBER@cloudbuild.gserviceaccount.com \</span></span>
<span class="line"><span style="color:#222222">  --role=roles/iam.serviceAccountTokenCreator</span></span></code></pre></div></div></li></ol><div class="header-wrapper"><h3 id="writing-a-cloud-build-configuration-file">Writing a Cloud Build configuration file</h3><a class="heading-link" href="#writing-a-cloud-build-configuration-file" aria-label="Link to 'Writing a Cloud Build configuration file' section">#</a></div><p>To publish from Cloud Build, you must specify steps for Cloud Build to:</p><ul><li>Impersonate the service account to obtain a temporary OIDC token.</li><li>Provide the temporary OIDC token to <code>dart pub</code> for use when publishing.</li><li>Calling <code>dart pub publish</code> to publish the package.</li></ul><p>Steps for Google Cloud Build are provided in a <code>cloudbuild.yaml</code> file, see <a href="https://cloud.google.com/build/docs/build-config-file-schema">build configuration file schema</a> for full documentation of the format.</p><p>For publishing to pub.dev from Google Cloud Build, a <code>cloudbuild.yaml</code> file as follows will do:</p><div class="code-block-wrapper language-yaml"><div class="code-block-body"><span class="code-block-language" title="Language yaml">yaml</span><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#6E6E70"># cloudbuild.yaml</span></span>
<span class="line"><span style="color:#0468D7">steps</span><span style="color:#222222">:</span></span>
<span class="line"><span style="color:#222222">- </span><span style="color:#0468D7">id</span><span style="color:#222222">: </span><span style="color:#11796D">Create temporary token</span></span>
<span class="line"><span style="color:#0468D7">  name</span><span style="color:#222222">: </span><span style="color:#11796D">gcr.io/cloud-builders/gcloud</span></span>
<span class="line"><span style="color:#0468D7">  volumes</span><span style="color:#222222">:</span></span>
<span class="line"><span style="color:#222222">  - </span><span style="color:#0468D7">name</span><span style="color:#222222">: </span><span style="color:#11796D">temporary-secrets</span></span>
<span class="line"><span style="color:#0468D7">    path</span><span style="color:#222222">: </span><span style="color:#11796D">/secrets</span></span>
<span class="line"><span style="color:#0468D7">  script</span><span style="color:#222222">: </span><span style="color:#D43324">|</span></span>
<span class="line"><span style="color:#11796D">    gcloud auth print-identity-token \</span></span>
<span class="line"><span style="color:#11796D">      --impersonate-service-account=pub-dev@$PROJECT_ID.iam.gserviceaccount.com \</span></span>
<span class="line"><span style="color:#11796D">      --audiences=https://pub.dev \</span></span>
<span class="line"><span style="color:#11796D">      --include-email > /secrets/temporary-pub-token.txt</span></span>
<span class="line"><span style="color:#0468D7">  env</span><span style="color:#222222">:</span></span>
<span class="line"><span style="color:#222222">  - </span><span style="color:#11796D">PROJECT_ID=$PROJECT_ID</span></span>
<span class="line"><span style="color:#222222">- </span><span style="color:#0468D7">id</span><span style="color:#222222">: </span><span style="color:#11796D">Publish to pub.dev</span></span>
<span class="line"><span style="color:#0468D7">  name</span><span style="color:#222222">: </span><span style="color:#11796D">dart</span></span>
<span class="line"><span style="color:#0468D7">  volumes</span><span style="color:#222222">:</span></span>
<span class="line"><span style="color:#222222">  - </span><span style="color:#0468D7">name</span><span style="color:#222222">: </span><span style="color:#11796D">temporary-secrets</span></span>
<span class="line"><span style="color:#0468D7">    path</span><span style="color:#222222">: </span><span style="color:#11796D">/secrets</span></span>
<span class="line"><span style="color:#0468D7">  script</span><span style="color:#222222">: </span><span style="color:#D43324">|</span><span style="color:#222222"> </span></span>
<span class="line"><span style="color:#11796D">    cat /secrets/temporary-pub-token.txt | dart pub token add https://pub.dev</span></span>
<span class="line"><span style="color:#11796D">    dart pub publish --force</span></span></code></pre></div></div><p>The <code>gcloud auth print-identity-token</code> creates an OIDC <code>id_token</code> impersonating the specified service account. This <code>id_token</code> is signed by Google, with a signature that expires within 1 hour. The <em>audiences</em> parameter lets pub.dev know that it is the intended recipient of the token. The <code>--include-email</code> option is necessary for pub.dev to recognize the service account.</p><p>Once the <code>id_token</code> is created, it's written to a file that resides in a <em>volume</em>; this mechanism is used to <a href="https://cloud.google.com/build/docs/configuring-builds/pass-data-between-steps">pass data between steps</a>. Don't store the token in <code>/workspace</code>. Since <code>/workspace</code> is where the repository from which you wish to publish is checked out. Not using <code>/workspace</code> for storing the token reduces the risk that you accidentally include it in your package when publishing.</p><div class="header-wrapper"><h3 id="creating-a-cloud-build-trigger">Creating a Cloud Build trigger</h3><a class="heading-link" href="#creating-a-cloud-build-trigger" aria-label="Link to 'Creating a Cloud Build trigger' section">#</a></div><p>With service accounts configured and a <code>cloudbuild.yaml</code> file in the repository you can create a <em>Cloud Build Trigger</em> using the <a href="https://console.cloud.google.com/cloud-build/triggers">console.cloud.google.com</a> dashboard. To create a build trigger, you need to connect to a <em>source repository</em> and specify which events should trigger a build. You can use <a href="https://cloud.google.com/build/docs/automating-builds/github/connect-repo-github">GitHub</a>, <a href="https://cloud.google.com/source-repositories/docs/create-code-repository">Cloud Source Repository</a>, or one of the <a href="https://cloud.google.com/build/docs/triggers">other options</a>. To learn how to configure a <em>Cloud Build Trigger</em>, check out <a href="https://cloud.google.com/build/docs/automating-builds/create-manage-triggers">creating and managing build triggers</a>.</p><p>To use the <code>cloudbuild.yaml</code> from the previous step, configure the <em>Cloud Build Trigger</em> type as &quot;Cloud Build Configuration&quot; located in the repository in the <code>/cloudbuild.yaml</code> file. Do <strong>not</strong> specify a <em>service account</em> for the build to be triggered with. Instead you'll want to use the default service account for Cloud Build.</p><p><img src="../../assets/img/tools/pub/gcb-trigger-configuration.png" alt="Configuration for trigger"></p><aside class="alert alert-info"><div class="alert-header"><i class="material-symbols" aria-hidden="true">info</i> <span>Note</span></div><div class="alert-content"><p>You can configure the Cloud Build trigger to run under a custom <em>service account</em>. If you want to do this, create a new service account for this purpose. Allow this service account to impersonate the <code>pub-dev@$PROJECT_ID.iam.gserviceaccount.com</code> account, which can publish to pub.dev.</p><p>The configuration of the <code>pub-dev@$PROJECT_ID.iam.gserviceaccount.com</code> <em>service account</em> allowed the default Cloud Build service account, <code>$PROJECT_NUMBER@cloudbuild.gserviceaccount.com</code>, to impersonate the <code>pub-dev@$PROJECT_ID.iam.gserviceaccount.com</code> service account. If using a custom service account for the Cloud Build, you'll need to change this.</p><p>To learn more about custom service accounts for running Cloud Builds, check out <a href="https://cloud.google.com/build/docs/securing-builds/configure-user-specified-service-accounts">Configuring user-specified service accounts</a>.</p></div></aside><p>When configuring your Cloud Build trigger, consider who can trigger the build. <em>Because triggering a build might publish a new version of your package</em>. Consider only allowing manual builds or use <a href="https://cloud.google.com/build/docs/securing-builds/gate-builds-on-approval">Cloud Build approvals</a> to gate builds as outlined in next section.</p><div class="header-wrapper"><h3 id="hardening-security-with-cloud-build-approvals">Hardening security with Cloud Build Approvals</h3><a class="heading-link" href="#hardening-security-with-cloud-build-approvals" aria-label="Link to 'Hardening security with Cloud Build Approvals' section">#</a></div><p>When configuring a Cloud Build trigger, you can select <strong>require approval before build executes</strong>. If a Cloud Build trigger requires approval, it won't run when triggered. Instead, it'll wait for approval. This can be used to limit who can publish new versions of your package.</p><p><img src="../../assets/img/tools/pub/gcb-approval-checkbox.png" alt="Enabling approvals in configuration of the Cloud Build trigger"></p><p>Only a user with the <strong>Cloud Build Approver</strong> role can give approval. When giving a approval, the approver can specify a URL and comment.</p><p><img src="../../assets/img/tools/pub/gcp-waiting-for-approval.png" alt="Cloud Build run waiting for approval to run"></p><p>You can also configure notifications for pending approvals. To learn more, check out <a href="https://cloud.google.com/build/docs/securing-builds/gate-builds-on-approval">gate build on approval</a>.</p><div class="header-wrapper"><h2 id="publish-from-anywhere-using-a-service-account">Publish from anywhere using a Service Account</h2><a class="heading-link" href="#publish-from-anywhere-using-a-service-account" aria-label="Link to 'Publish from anywhere using a Service Account' section">#</a></div><p>To allow automated publishing outside of GitHub Actions, you might authenticate using service accounts in way similar to <em>Cloud Build</em>.</p><p>This usually involves:</p><ul><li><a href="#creating-a-service-account-for-publishing">Create a service account for publishing</a>,</li><li>Impersonate the publishing service account in one of two ways:<ul><li>Workload Identity Federation</li><li>Exported Service Account Keys</li></ul></li></ul><p>The section for <em>Cloud Build</em> outlined how to <a href="#creating-a-service-account-for-publishing">create a service account for publishing</a>. This should provide a service account, such as <code>pub-dev@$PROJECT_ID.iam.gserviceaccount.com</code>.</p><div class="header-wrapper"><h3 id="publish-using-workload-identity-federation">Publish using Workload Identity Federation</h3><a class="heading-link" href="#publish-using-workload-identity-federation" aria-label="Link to 'Publish using Workload Identity Federation' section">#</a></div><p>When running on a cloud service that supports OIDC or SAML, you can impersonate a GCP service account using <a href="https://cloud.google.com/iam/docs/workload-identity-federation">Workload Identity Federation</a>. This enables you to leverage your cloud provider's identity services.</p><p>For example, if deploying on EC2, you can <a href="https://cloud.google.com/iam/docs/workload-identity-federation-with-other-clouds">configure workload identity federation with AWS</a>, allowing temporary AWS tokens from the EC2 metadata service to impersonate a service account. To learn how to configure these flows, check out <a href="https://cloud.google.com/iam/docs/how-to#workload-identity-federation">workload identity federation</a>.</p><div class="header-wrapper"><h3 id="publish-using-exported-service-account-keys">Publish using Exported Service Account Keys</h3><a class="heading-link" href="#publish-using-exported-service-account-keys" aria-label="Link to 'Publish using Exported Service Account Keys' section">#</a></div><p>When running on a custom system without identity services, you can export service account keys. Exported service account keys allows you to authenticate as said <em>service account</em>. To learn more, check out how to <a href="https://cloud.google.com/iam/docs/creating-managing-service-account-keys">create and manage service account keys</a>.</p><div class="header-wrapper"><h4 id="export-service-account-keys">Export service account keys</h4><a class="heading-link" href="#export-service-account-keys" aria-label="Link to 'Export service account keys' section">#</a></div><ol><li><p>Create exported service account keys for an existing service account.</p><div class="code-block-wrapper language-console"><div class="code-block-body"><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#222222">$ gcloud iam service-accounts keys create key-file.json \</span></span>
<span class="line"><span style="color:#222222">  --iam-account=pub-dev@$PROJECT_ID.iam.gserviceaccount.com</span></span></code></pre></div></div></li><li><p>Save the <code>key-file.json</code> file for later use.</p></li></ol><aside class="alert alert-warning"><div class="alert-header"><i class="material-symbols" aria-hidden="true">warning</i> <span>Warning</span></div><div class="alert-content"><p>Treat the <code>key-file.json</code> like a password. Anyone who gains access to it can authenticate as the service account and publish your package.</p></div></aside><div class="header-wrapper"><h4 id="publish-packages-using-exported-service-account-keys">Publish packages using exported service account keys</h4><a class="heading-link" href="#publish-packages-using-exported-service-account-keys" aria-label="Link to 'Publish packages using exported service account keys' section">#</a></div><p>To publish a package using exported service account keys:</p><ol><li><p>Setup gcloud to authenticate using <code>key-file.json</code> (created in the previous step)</p><div class="code-block-wrapper language-console"><div class="code-block-body"><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#222222">$ gcloud auth activate-service-account --key-file=</span><span style="color:#11796D">key-file.json</span></span></code></pre></div></div></li><li><p>Create a temporary token for pub.dev and pass it to <code>dart pub token add https://pub.dev</code>. To impersonate service account, include the <code>--include-email</code> option.</p><div class="code-block-wrapper language-console"><div class="code-block-body"><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#222222">$ gcloud auth print-identity-token \</span></span>
<span class="line"><span style="color:#222222">  --audiences=https://pub.dev \</span></span>
<span class="line"><span style="color:#222222">  | dart pub token add https://pub.dev</span></span></code></pre></div></div></li><li><p>Publish using the temporary token. Add the <code>--force</code> option to skip the <code>yes/no</code> prompt.</p><div class="code-block-wrapper language-console"><div class="code-block-body"><pre class="shiki dash-light" tabindex="0"><code><span class="line"><span style="color:#222222">$ dart pub publish --force</span></span></code></pre></div></div></li></ol><aside class="alert alert-info"><div class="alert-header"><i class="material-symbols" aria-hidden="true">info</i> <span>Note</span></div><div class="alert-content"><p>Consider using <a href="https://cloud.google.com/iam/docs/workload-identity-federation">Workload Identity Federation</a>, if possible. This avoids long-lived secrets. Relying on Workload Identity Federation allows you to use short-lived secrets that your cloud provider signs. Short-lived secrets greatly reduces the security risks if accidentally leaked in logs or similar ways.</p></div></aside><p id="page-github-links"><span>Unless stated otherwise, the documentation on this site reflects Dart 3.6.0. Page last updated on 2024-08-30.</span> <a href="https://github.com/dart-lang/site-www/tree/main/src/content/tools/pub/automated-publishing.md" target="_blank" rel="noopener">View source</a> <span>or </span><a href="https://github.com/dart-lang/site-www/issues/new?template=1_page_issue.yml&amp;page-url=https://dart.dev/tools/pub/automated-publishing/&amp;page-source=https://github.com/dart-lang/site-www/tree/main/src/content/tools/pub/automated-publishing.md" title="Report an issue with this page" target="_blank" rel="noopener">report an issue</a>.</p></div></article></main><footer id="page-footer"><div class="footer-section footer-main"><a href="../../index.html" class="brand" title="Dart"><img src="../../assets/img/logo/logo-white-text.svg" alt="Dart" width="164"></a><div class="footer-social-links"><a href="https://medium.com/dartlang" target="_blank" rel="noopener" title="Medium blog"><svg><use href="../../assets/img/social/medium.svg#medium"></use></svg> </a><a href="https://github.com/dart-lang" target="_blank" rel="noopener" title="GitHub"><svg><use href="../../assets/img/social/github.svg#github"></use></svg> </a><a href="https://twitter.com/dart_lang" target="_blank" rel="noopener" title="X (Twitter)"><svg><use href="../../assets/img/social/x.svg#x"></use></svg></a></div></div><div class="footer-section footer-tray"><div class="footer-licenses">Except as otherwise noted, this site is licensed under a <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>, and code samples are licensed under the <a href="https://opensource.org/licenses/BSD-3-Clause">3-Clause BSD License</a>.</div><div class="footer-utility-links"><ul><li><a href="../../terms.html" title="Terms of use">Terms</a></li><li><a href="https://policies.google.com/privacy" target="_blank" rel="noopener" title="Privacy policy">Privacy</a></li><li><a href="../../security.html" title="Security philosophy and practices">Security</a></li></ul></div></div></footer></body>
<!-- Mirrored from dart.dev/tools/pub/automated-publishing by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 30 Dec 2024 22:17:49 GMT -->
</html>